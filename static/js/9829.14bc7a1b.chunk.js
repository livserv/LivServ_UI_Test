"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[9829],{46278(e,t,a){a.d(t,{A:()=>d});a(9950);var r=a(63464),s=a(40033),o=a(28170),l=a(79739),i=a(10226),n=a(44414);const d=e=>{const{title:t,children:a,open:d,setOpen:c,onConfirm:m}=e;return(0,n.jsxs)(r.A,{open:d,onClose:()=>c(!1),style:{zIndex:1e4},children:[(0,n.jsx)(s.A,{sx:{m:0,p:2},id:"confirm-dialog",children:t}),(0,n.jsx)(o.A,{dividers:!0,children:a}),(0,n.jsxs)(l.A,{children:[(0,n.jsx)(i.A,{size:"large",type:"submit",variant:"contained",color:"secondary",onClick:()=>c(!1),children:"No"}),(0,n.jsx)(i.A,{size:"large",type:"submit",variant:"contained",color:"success",onClick:()=>{c(!1),m()},children:"Yes"})]})]})}},22942(e,t,a){a.r(t),a.d(t,{default:()=>H});var r=a(89379),s=a(9950),o=a(60899),l=a(82053),i=a(78317),n=a(81616),d=a(24516),c=a(53065),m=a(50704),u=a(10226),p=a(25713),h=a(52472),x=a(99532),g=a(57988),y=a(62375),b=a(69935),w=a(4983),v=a(93153),j=a(94540),f=a(29714),k=a(61467),N=a(44364),A=a(51637),C=a(32829),T=a(97601),E=a(33340),M=a(70855);const L=a.p+"static/media/media-image.16ef5ffabad85fb7ba76.png";var F=a(26092),S=a(93383),I=a(8478),D=a(98415);var O=a(46278),B=a(74248),P=a(44414);const H=function(e){var t;const{mimeType:a,selectedFiles:s,handleSelection:o}=(0,r.A)({},e),l=(0,E.nc)(e=>e.botsList),[i]=(0,M.G)(),n=null===(t=l.find(e=>e._id===i))||void 0===t?void 0:t.conversationMedia,d=(0,E.nc)(e=>e.organizationId);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(z,{organizationId:d,botId:i,mimeType:a}),(0,P.jsx)(U,{botId:i,organizationId:d,conversationMediaList:n,mimeType:a,handleSelection:o,selectedFiles:s})]})};function z(e){var t;let{organizationId:a,botId:p,mimeType:g=".png,.jpeg,.jpg,.mpeg,.mp4,.pdf"}=e;const[y,b]=s.useState(!1),w=(0,s.useRef)(null),v=(0,E.nc)(e=>e.conversationMediaUpdate),j=null===(t=(0,E.nc)(e=>e.botsList).find(e=>e._id===p))||void 0===t?void 0:t.conversationMedia,A=N.pA?N.pA:5242880,T=f.Ik().shape({file:f.gl().required("File is not selected").test("is-valid-size","Maximum allowed file size is ".concat(A/1048576," MB"),e=>e&&e.size<=A)});return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(B.y,{ref:w}),(0,P.jsxs)(o.Ay,{container:!0,spacing:3,children:[(0,P.jsx)(o.Ay,{item:!0,xs:8,children:(0,P.jsx)(l.A,{variant:"h5",children:"Conversation Media"})}),(0,P.jsx)(o.Ay,{item:!0,xs:3,sx:{position:"relative",display:"flex",justifyContent:"flex-end"},children:v&&(0,P.jsx)("div",{style:{position:"fixed"},children:(0,P.jsx)(C.A,{children:(0,P.jsx)(S.A,{isLoading:isKeyWordSubmitting,disabled:isKeyWordSubmitting,variant:"contained",color:"success",size:"large",onClick:updateConversationMediaKeywords,children:"Save Changes"})})})}),(0,P.jsx)(o.Ay,{item:!0,xs:1,sx:{position:"relative"},style:{paddingTop:25,display:"flex",justifyContent:"right"},children:(0,P.jsx)(c.A,{title:"Upload Conversation Media",children:(0,P.jsx)(h.A,{color:"primary",size:"small",style:{position:"fixed"},onClick:()=>{b(!0)},children:(0,P.jsx)(x.A,{})})})})]}),(0,P.jsx)(F.A,{openPopUpDialog:y,setPopUpDialog:b,title:"Upload Conversation Media",children:(0,P.jsx)(i.A,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:(0,P.jsxs)(o.Ay,{container:!0,spacing:3,justify:"center",children:[(0,P.jsx)(o.Ay,{item:!0,xs:12,style:{padding:0,display:"flex",alignItems:"baseline",justifyContent:"center"},children:"Upload Media (*.png,*.jpeg,*.jpg,*.mpeg,*.mp4,*.pdf)"}),(0,P.jsx)(o.Ay,{item:!0,xs:12,justify:"center",children:(0,P.jsx)(m.A,{style:{padding:0,display:"flex",alignItems:"flex-start",justifyContent:"center"},children:(0,P.jsx)(n.A,{spacing:1,children:(0,P.jsx)(k.l1,{initialValues:{file:null},validationSchema:T,onSubmit:async(e,t)=>{let{setErrors:r,setStatus:s,setSubmitting:o}=t;try{const{name:t}=e.file;j.some(e=>e.name===t)?w.current&&w.current.show({severity:"error",summary:"File Upload",detail:"The file already uploaded!. Please select another file",life:5e3}):(await async function(e,t,a){const r=new FormData;r.append("file",e);const s=await I.bE("/bot/".concat(a,"/").concat(t,"/upload-conversation-media"),r),{conversationMedia:o}=s;(0,D.rv)(t,{conversationMedia:o})}(e.file,p,a),s({success:!0}),o(!0),b(!1),w.current&&w.current.show({severity:"success",summary:"File Upload",detail:"The file uploaded successfully!",life:5e3}))}catch(l){s({success:!1}),r({submit:l.message}),o(!1),b(!1),w.current&&w.current.show({severity:"error",summary:"File Upload",detail:"Not able to upload the file. Try after sometime!",life:5e3})}},children:e=>{let{values:t,errors:a,isSubmitting:s,setFieldValue:i}=e;return(0,P.jsxs)(k.lV,{children:[(0,P.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,P.jsx)(o.Ay,{item:!0,xs:12,md:12,children:t.file&&(0,P.jsxs)(l.A,{variant:"body2",children:["Selected File: ",t.file.name]})}),(0,P.jsx)(o.Ay,{item:!0,xs:6,md:6,style:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end"},children:(0,P.jsx)(k.D0,{type:"file",name:"file",as:e=>{let{field:t}=e;return(0,P.jsx)(C.A,{children:(0,P.jsxs)(u.A,{variant:"contained",component:"label",htmlFor:"file-input",size:"large",children:["SelectFile",(0,P.jsx)("input",(0,r.A)((0,r.A)({},t),{},{type:"file",id:"file-input",style:{display:"none"},onChange:e=>{i("file",e.currentTarget.files[0])},accept:g}))]})})}})}),(0,P.jsx)(o.Ay,{item:!0,xs:6,md:6,children:(0,P.jsx)(C.A,{children:(0,P.jsx)(u.A,{variant:"contained",size:"large",type:"submit",disabled:s,children:s?"Uploading...":"Upload"})})})]}),(0,P.jsx)(o.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(d.A,{error:!0,id:"helper-text-file-input",children:a.file})})]})}})})})})]})})})]})}function U(e){let{conversationMediaList:t,botId:a,organizationId:n,handleSelection:d,selectedFiles:c,mimeType:m}=e;const[u,p]=(0,s.useState)([]);(0,s.useEffect)(()=>{const e=((e,t)=>e?e.filter(e=>{const{type:a}=e;return!t||("application/pdf"===t?a===t:"image/*"===t?a.startsWith("image/"):"video/*"===t&&a.startsWith("video/"))}):[])(t,m),a=e.map(e=>(0,r.A)((0,r.A)({},e),{},{isSelected:!!c&&c.some(t=>t.url===e.url)}));p(a)},[t,c,m]);const h=e=>{const t=u.map(t=>t.url===e.url?(0,r.A)((0,r.A)({},t),{},{isSelected:!t.isSelected}):t);p(t),d(t)};return(0,P.jsx)(i.A,{children:(0,P.jsxs)(o.Ay,{container:!0,spacing:3,justify:"center",children:[(0,P.jsx)(o.Ay,{item:!0,xs:12,children:u&&0===u.length&&(0,P.jsx)(l.A,{variant:"caption",color:"#FF0000",children:(0,P.jsxs)(o.Ay,{container:!0,spacing:1,children:[(0,P.jsx)(o.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(j.A,{style:{fontSize:40}})}),(0,P.jsx)(o.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:"Conversation Media and Keywords are not uploaded!"})]})})}),u&&u.map((e,t)=>(0,P.jsx)(o.Ay,{item:!0,xs:12,sm:4,lg:3,justify:"center",children:(0,P.jsx)(W,{media:e,botId:a,organizationId:n,onToggleSelection:h,handleSelection:d})},t))]})})}function W(e){let{media:t,botId:a,organizationId:r,onToggleSelection:l,handleSelection:i}=e;const[n,d]=s.useState(!1),c=(0,s.useRef)(null),h=async(e,t,a,r)=>{try{const s={fileName:t,fileUrl:e};await async function(e,t,a){const r=await I.bE("/bot/".concat(t,"/").concat(a,"/delete-conversation-media"),e),{conversationMedia:s}=r;(0,D.rv)(a,{conversationMedia:s})}(s,r,a),c.current&&c.current.show({severity:"success",summary:"File Delete",detail:"The file deleted successfully!",life:5e3})}catch(s){c.current&&c.current.show({severity:"error",summary:"Delete File",detail:"Not able to delete the file. Try after sometime!",life:5e3})}};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(B.y,{ref:c}),(0,P.jsxs)(A.A,{className:"main-card "+(t.isSelected?"card-selected":""),contentSX:{p:2,cursor:"pointer"},children:[(0,P.jsx)(m.A,{style:{padding:"24px 0 0 0",minHeight:"120px",maxHeight:"135px",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:(0,P.jsx)(o.Ay,{container:!0,spacing:3,justifyContent:"center",children:(0,P.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",textAlign:"center"},children:"image"===t.type.split("/")[0]?(0,P.jsxs)("a",{href:t.url,rel:"noreferrer",target:"_blank",title:t.name,children:[(0,P.jsx)("img",{src:t.url,alt:t.name,style:{maxHeight:"100px",margin:"0 auto"}}),(0,P.jsx)("strong",{className:"truncate overflow-hidden whitespace-nowrap py-2",style:{maxWidth:"100px",textOverflow:"ellipsis",display:"inline-block",overflow:"hidden"},children:t.name})]}):"application"===t.type.split("/")[0]?(0,P.jsxs)("a",{href:t.url,rel:"noreferrer",target:"_blank",title:t.name,children:[(0,P.jsx)("img",{src:L,alt:"LivServ",style:{maxHeight:"100px",margin:"0 auto"}}),(0,P.jsx)("strong",{className:"truncate overflow-hidden whitespace-nowrap py-2",style:{maxWidth:"100px",textOverflow:"ellipsis",display:"inline-block",overflow:"hidden"},children:t.name})]}):(0,P.jsxs)("video",{controls:!0,style:{maxWidth:"100%",margin:"0 auto"},children:[(0,P.jsx)("source",{src:t.url,type:"video/mp4"}),(0,P.jsx)("track",{kind:"captions",src:"",srcLang:"en",label:"English"}),"Your browser does not support the video tag."]})})})}),(0,P.jsx)(p.A,{style:{justifyContent:"flex-end",padding:"5px"},children:(0,P.jsxs)(o.Ay,{container:!0,children:[(0,P.jsxs)(o.Ay,{item:!0,xs:3,md:3,children:[(0,P.jsx)(u.A,{size:"small",component:"label",variant:"contained",onClick:()=>d(!0),color:"error",startIcon:(0,P.jsx)(g.A,{fontSize:"small"}),title:"Delete File"}),(0,P.jsxs)(O.A,{title:"Delete file?",open:n,setOpen:d,onConfirm:()=>h(t.url,t.name,a,r),children:["Confirm the deletion of ",t.name,"?"]})]}),(0,P.jsx)(o.Ay,{item:!0,xs:3,md:3,children:(0,P.jsx)(u.A,{size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{return e=t.url,void window.open(e);var e},startIcon:(0,P.jsx)(y.A,{}),title:"View File"})}),(0,P.jsx)(o.Ay,{item:!0,xs:3,md:3,children:(0,P.jsx)(u.A,{color:"primary",size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{navigator.clipboard.writeText(t.url).then(()=>{(0,T.i)(!0,"Image URL copied to clipboard!","success")})},startIcon:(0,P.jsx)(b.A,{}),title:"Copy Url"})}),(0,P.jsx)(o.Ay,{item:!0,xs:3,md:3,children:i&&(0,P.jsx)(u.A,{color:t.isSelected?"success":"primary",size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{l(t)},startIcon:t.isSelected?(0,P.jsx)(w.A,{}):(0,P.jsx)(v.A,{}),title:"Select File"})})]})})]})]})}},48136(e,t,a){a.r(t),a.d(t,{default:()=>ca});var r=a(9950),s=a(28564),o=a(89379),l=a(39320),i=a(37630),n=a(85668),d=(a(522),a(59051)),c=a.n(d),m=a(80609);const u={jpg:"image/*",jpeg:"image/*",png:"image/*",gif:"image/*",mp4:"video/*",avi:"video/*",mov:"video/*",wmv:"video/*",mp3:"audio/*",wav:"audio/*",pdf:"application/pdf"},p=[{id:h(),type:"start",data:{message:"Chat Window Opened"},position:{x:10,y:10}}];function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let a="";const r=Date.now().toString(36);for(let s=0;s<e;s++)a+=t.charAt(Math.floor(36*Math.random()));return r+a}const x=e=>{if(e&&e.flows.length>0){let t=g(e);const a=N(e);return t=[...p,...t],{flowNodes:t,flowEdges:a}}return{flowNodes:[...p],flowEdges:[]}},g=e=>e.flows.map((t,a)=>({id:t.flowId,type:t.type,data:y(t),position:k(t,a,e)})),y=e=>{var t,a,r,s,o,l,i,n,d,c;const u={};switch(["chatMedium","message","leadForm","gpt","leadFlow","stop","file","map","question","callConnect","otp","customForm","whatsappCarousel","options"].includes(e.type)&&(u.message="string"===typeof e.content?e.content:e.content[0]),e.type){case"options":u.delay=e.delay,u.fieldLabel=e.fieldLabel,u.fallback=e.fallback?e.fallback:null===(t=e.meta)||void 0===t?void 0:t.fallback,u.dataSource=e.dataSource?e.dataSource:null===(a=e.meta)||void 0===a?void 0:a.dataSource,u.property=e.property,u.subOptions=v(e.children);break;case"file":var p,x;if(u.delay=e.delay,u.fileType=null===(r=e.meta)||void 0===r?void 0:r.type,null===(s=e.meta)||void 0===s||!s.media||!b(e.meta.media,e)&&e.meta.media[0].name){if(u.urls=[],u.files=null!==(p=e.meta)&&void 0!==p&&p.media?e.meta.media:[],!u.fileType)u.fileType=null!==(x=e.meta)&&void 0!==x&&x.media?C(e.meta.media):""}else u.urls=e.meta.media.map(e=>e.url),u.files=[];break;case"map":u.delay=e.delay,u.url=null===(o=e.meta)||void 0===o||null===(l=o.url)||void 0===l?void 0:l.trim();break;case"message":u.delay=e.delay;break;case"question":u.delay=e.delay,u.fieldLabel=e.fieldLabel,u.property=e.property,u.dateFormat=(null===(i=e.meta)||void 0===i?void 0:i.dateFormat)||"",u.errorMessage=(null===(n=e.meta)||void 0===n?void 0:n.errorMessage)||"";const P=e.fieldType?e.fieldType:null===(d=e.meta)||void 0===d?void 0:d.type;var g,y,k,N,A,T,E,M,S;if(u.fieldType=P,P&&P===m.bh.DATE||P===m.bh.DATETIME)u.min=null!==(g=e.meta)&&void 0!==g&&g.min?L(e,"min"):u.min,u.max=null!==(y=e.meta)&&void 0!==y&&y.max?L(e,"max"):u.max;if(P&&P===m.bh.TIME)u.min=null!==(k=e.meta)&&void 0!==k&&k.min?F(null===(N=e.meta)||void 0===N?void 0:N.min):null===(A=e.meta)||void 0===A?void 0:A.min,u.max=null!==(T=e.meta)&&void 0!==T&&T.min?F(null===(E=e.meta)||void 0===E?void 0:E.max):null===(M=e.meta)||void 0===M?void 0:M.max;else if(P&&P===m.bh.STRING||P===m.bh.NUMBER){var I,D;u.min=e.min?e.min:null===(I=e.meta)||void 0===I?void 0:I.min,u.max=e.min?e.min:null===(D=e.meta)||void 0===D?void 0:D.max}if(P===m.bh.CUSTOM)u.custom=e.custom?e.custom:null===(S=e.meta)||void 0===S?void 0:S.custom;break;case"http":if(u.delay=e.delay,u.property=e.property||"",e.meta){var O,B;u.displayText=e.meta.displayText||"",u.requestType=e.meta.requestType||"",u.hideData=e.meta.hideData||!1,u.url=(null===(O=e.meta.url)||void 0===O?void 0:O.trim())||"",u.params=e.meta.params||[],u.headers=e.meta.headers||[],u.successFlowId=e.meta.successFlowId?e.meta.successFlowId:h(),u.failureFlowId=e.meta.failureFlowId?e.meta.failureFlowId:h();const t=null===(B=e.meta.statusWiseFlowId)||void 0===B?void 0:B.map(e=>({statusCode:e.statusCode||"",id:e.flowId||""}));u.statusWiseFlow=t||[]}break;case"callConnect":u.delay=e.delay,e.meta&&(u.callConnectId=e.meta.callConnectId,u.callAccepted=e.meta.callAccepted,u.callRejected=e.meta.callRejected,u.successMessage=e.meta.successMessage,u.failureMessage=e.meta.failureMessage);break;case"otp":u.delay=e.delay,e.meta&&(u.otpType=e.meta.otpType);break;case"customForm":u.delay=e.delay,u.property=e.property,e.meta&&(u.customFields=w(e.meta.customFields));break;case"url":u.delay=e.delay,u.fieldLabel=e.fieldLabel,u.property=e.property,u.subUrls=f(e.children);break;case"whatsappCarousel":u.delay=e.delay,u.type="whatsappCarousel",u.property=e.property?e.property:"",u.fieldLabel=e.fieldLabel?e.fieldLabel:"",e.meta&&(u.cardHeaderType=e.meta.cardHeaderType?e.meta.cardHeaderType:"",u.wbTemplateId=e.meta.wbTemplateId?e.meta.wbTemplateId:"",u.contentParams=e.meta.contentParams?[...e.meta.contentParams]:[]),u.cards=j(e.children);break;case"whatsAppFlow":u.delay=e.delay,u.fieldLabel=e.fieldLabel,u.property=e.property,e.meta&&(u.header=e.meta.header,u.body=e.meta.body,u.footer=e.meta.footer,u.flow_token=e.meta.flow_token,u.flow_id=e.meta.flow_id,u.flow_action=e.meta.flow_action,u.flow_cta=e.meta.flow_cta,u.screen=e.meta.screen,u.responsedata=e.meta.responsedata);break;case"chatMedium":u.delay=e.delay,u.chatMedium=(null===(c=e.meta)||void 0===c?void 0:c.chatMedium)||[{id:"web",value:"Web"},{id:"whatsapp",value:"Whatsapp"}]}return u},b=(e,t)=>!(null===e||void 0===e||!e.files)&&(t.meta.media=e.files,!0),w=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({id:e.id,title:e.title,property:e.property,whatsAppQuestion:e.whatsAppQuestion,fieldType:e.fieldType,dateFormat:null===e||void 0===e?void 0:e.dateFormat,min:null===e||void 0===e?void 0:e.min,max:null===e||void 0===e?void 0:e.max,custom:null===e||void 0===e?void 0:e.custom,isCollapsed:!1}))},v=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({id:e.flowId?e.flowId:e.id,title:e.title,subTitle:e.subTitle,value:e.value,imageUrl:e.imageUrl,category:e.category,isLink:e.isLink,description:e.description,googleTagManagerPayload:e.googleTagManagerPayload,selectedMOG:e.selectedMOG?e.selectedMOG:"",leadEmailTo:e.leadEmailTo?e.leadEmailTo:"",leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],isCollapsed:!1}))},j=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({id:e.id,link:e.link,value:e.value,category:e.category,leadEmailTo:e.leadEmailTo?e.leadEmailTo:"",leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],postbackTexts:e.postbackTexts?[...e.postbackTexts]:[],isCollapsed:!1}))},f=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({id:e.flowId?e.flowId:e.id,url:e.url,value:e.value,leadEmailTo:e.leadEmailTo?e.leadEmailTo:"",leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],isCollapsed:!1}))},k=(e,t,a)=>{let r={x:t+150,y:t+50};var s;e.flowId&&a.positions&&(r=(null===(s=a.positions.find(t=>t.nodeId===e.flowId))||void 0===s?void 0:s.position)||r);return r},N=e=>{let t={};null!==e&&void 0!==e&&e.startFlowId&&(t={id:p[0].id,source:p[0].id,target:null===e||void 0===e?void 0:e.startFlowId,type:"custom"});const a=e.flows;let r=a.filter(e=>e.nextFlowId).map(e=>(0,o.A)({id:"e-".concat(e.flowId,"-").concat(e.nextFlowId),source:e.flowId,target:e.nextFlowId,type:"custom"},"whatsappCarousel"===e.type&&e.children&&e.children.length>0&&(!e.children[0].postbackTexts||0===e.children[0].postbackTexts.length)&&{sourceHandle:"".concat(e.flowId,"-default")}));return a.forEach(e=>{var t;"chatMedium"===e.type&&null!==(t=e.meta)&&void 0!==t&&t.chatMedium&&e.meta.chatMedium.forEach(t=>{t.nextFlowId&&r.push({id:"e-".concat(t.id,"-").concat(t.nextFlowId),source:e.flowId,target:t.nextFlowId,type:"custom",sourceHandle:t.id})}),e.children&&e.children.length>0&&e.children.forEach(t=>{t.postbackTexts&&t.postbackTexts.length>0?t.postbackTexts.forEach(a=>{a.nextFlowId&&r.push({id:"e-".concat(t.id,"-btn-").concat(a.index,"-").concat(a.nextFlowId),source:e.flowId,target:a.nextFlowId,type:"custom",sourceHandle:"".concat(t.id,"-btn-").concat(a.index)})}):t.nextFlowId&&"whatsappCarousel"!==e.type&&r.push({id:"e-".concat(t.flowId?t.flowId:t.id,"-").concat(t.nextFlowId),source:e.flowId,target:t.nextFlowId,type:"custom",sourceHandle:t.flowId?t.flowId:t.id})})}),r=Object.keys(t).length>0?[t,...r]:[...r],r},A=e=>u[e.toLowerCase()]||"",C=e=>{const t=new Set;for(const a of e){const e=a.name.split(".").pop();if(e){const a=A(e);a&&t.add(a)}}return Array.from(t).join(", ")},T={pdf:"application/pdf",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",mp4:"video/mp4",mov:"video/mp4",avi:"video/mp4"},E=e=>{const t=M(e);return T[t]||""},M=e=>{const t=(e=>(new URL(e).pathname.split("/").pop()||"").split("?")[0])(e),a=t.lastIndexOf(".");return a>-1?t.substring(a+1).toLowerCase():""},L=(e,t)=>{var a;let r=new Date;const s="min"===t?"min":"max",o=e[s]||(null===(a=e.meta)||void 0===a?void 0:a[s]);if(o){const[e,t]=o.split("T");r=new Date(e);const[a,s,l]=t.split(":");r.setHours(a||0),r.setMinutes(s||0),r.setSeconds(l.split(".")[0]||0)}return r||""},F=e=>{const t=new Date;let a;if(/^([01]\d|2[0-3]):([0-5]\d)$/.test(e)){const[r,s]=e.split(":").map(Number);a=new Date(t),a.setHours(r,s,0,0)}else a=new Date(t),a.setHours(23,59,59,999);return a},S=(e,t,a)=>{const r=e=>e<10?"0"+e:e;t&&e&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),a&&(e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(99));const s=e.getFullYear(),o=r(e.getMonth()+1),l=r(e.getDate()),i=r(e.getHours()),n=r(e.getMinutes()),d=r(e.getSeconds()),c=(e.getMilliseconds()/1e3).toFixed(3).slice(2,5);return"".concat(s,"-").concat(o,"-").concat(l,"T").concat(i,":").concat(n,":").concat(d,".").concat(c,"Z")},I=e=>{if(e){const t=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0");return"".concat(t,":").concat(a)}return""},D=(e,t,a)=>{const r=[e],s=new Set,o=[];for(;r.length>0;){const e=r.pop();if(s.has(e))continue;s.add(e);const l=t.filter(t=>t.target===e).map(e=>e.source),i=a.filter(e=>l.includes(e.id));o.push(...i),r.push(...l)}return o},O=(e,t)=>e.filter(e=>t?e.type===t:["options","question","http"].includes(e.type)).map(e=>e.data.property).filter(e=>{if(!e||""===e.trim())return!1;return/^[a-zA-Z0-9-_]+$/.test(e.trim())}),B=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);const P=e=>{const t={};return e.errors={},e.message?(e.message.length<3||e.message.length>1500)&&(t.message="Error in Message Node",e.errors.message="Message must be between 3 and 1500 characters"):(t.message="Error in Message Node",e.errors.message="Message is required"),t},H=(e,t,a,r)=>{const s={};t.errors={};let o=[];const l=D(e.id,r,a);o=O(l,"http"),n(t.message||"","message",-1,s,t.errors),i("dataSource",t.dataSource||"",-1,o,t.dataSource,s,t.errors);function i(e,t,a,r,s,o,l,i){if(i){if(!i(t,e,a,o,l))return}if(s){const s=t.indexOf("."),i=-1!==s?t.slice(0,s):t;r.includes(i)||(o["".concat(e,"_").concat(a)]="Invalid property: ".concat(i," is not in the properties list"),l[e]="Invalid property: ".concat(i," is not in the properties list"))}}function n(e,t,a,r,s){if(!e||e.length<1||e.length>500){const e="".concat((o=t).charAt(0).toUpperCase()+o.slice(1)," must be between 1 and 500 characters");return r["".concat(t,"_").concat(a)]=e,s[t]=e,!1}var o;return!0}return(t.subOptions||[]).forEach((e,a)=>{const r={};i("title",e.title,a,o,null,s,r,(e,t,a,r,s)=>n(e,t,a,r,s)),t.dataSource&&!e.isLink&&i("value",e.value,a,o,null,s,r,(e,t,a,r,s)=>n(e,t,a,r,s));const l=new Set;if(e.leadEmailTo){const t=e.leadEmailTo.trim();B(t)?l.has(t)?(s["leadEmailTo_".concat(a)]="Duplicate Lead Email To",r.leadEmailTo="Duplicate Lead Email To"):l.add(t):(s["leadEmailTo_".concat(a)]="Lead Email To must be a valid email",r.leadEmailTo="Lead Email To must be a valid email")}e.leadEmailCc&&Array.isArray(e.leadEmailCc)&&e.leadEmailCc.forEach((e,t)=>{const o=e.trim();B(o)?l.has(o)?(s["subOptions[".concat(a,"].leadEmailCc[").concat(t,"]")]="Duplicate email in Lead Email Cc",r.leadEmailCc="Duplicate email in Lead Email Cc"):l.add(o):(s["subOptions[".concat(a,"].leadEmailCc[").concat(t,"]")]="Invalid email format",r.leadEmailCc="Invalid email format")}),t.subOption=r}),s},z=e=>{const t={};e.errors={};const a=e.subUrls||[];return a.forEach((r,s)=>{const o={};if(s!==a.length-1&&!R(r.url)){const e="Url must be a valid URL (starting with http, https, or ftp)";t["url_".concat(s)]=e,o.url=e}const l=new Set;if(r.leadEmailTo){const e=r.leadEmailTo.trim();B(e)?l.has(e)?(t["leadEmailTo_".concat(s)]="Duplicate Lead Email To",r.leadEmailTo="Duplicate Lead Email To"):l.add(e):(t["leadEmailTo_".concat(s)]="Lead Email To must be a valid email",o.leadEmailTo="Lead Email To must be a valid email")}r.leadEmailCc&&Array.isArray(r.leadEmailCc)&&r.leadEmailCc.forEach((e,a)=>{const r=e.trim();B(r)?l.has(r)?(t["subUrls[".concat(s,"].leadEmailCc[").concat(a,"]")]="Duplicate email in Lead Email Cc",o.leadEmailCc="Duplicate email in Lead Email Cc"):l.add(r):(t["subUrls[".concat(s,"].leadEmailCc[").concat(a,"]")]="Invalid email format",o.leadEmailCc="Invalid email format")}),e.subUrl=o}),t},U=e=>{var t;const a={};e.errors={},e.message?(e.message.length<3||e.message.length>1500)&&(a.message="Error in File Node",e.errors.message="Message must be between 3 and 1500 characters"):(a.message="Error in File Node",e.errors.message="Message is required");const r=Array.isArray(e.urls)&&e.urls.every(e=>R(e));r||(a.message="Error in File Node",e.errors.urls="Invalid image URL"),e.fileType||(a.message="Error in File Node",e.errors.fileType="File type is required");const s=e.files&&_(e.files,e.fileType);return(r&&0===(null===(t=e.urls)||void 0===t?void 0:t.length)&&!s||!r&&!s)&&(a.message="Error in File Node",e.errors.fileOrUrl="Either valid URLs or valid files must be provided"),a},W=e=>{const t={};return e.errors={},e.message?(e.message.length<3||e.message.length>500)&&(t.message="Error in Maps Node",e.errors.message="Message must be between 3 and 500 characters"):(t.message="Error in Maps Node",e.errors.message="Message is required"),e.url&&R(e.url)||(t.message="Error in Maps Node",e.errors.url="URL must be valid"),t},_=(e,t)=>{if(!e||0===e.length)return!1;const a={pdf:["pdf","application/pdf"],"application/pdf":["pdf","application/pdf"],images:["jpg","jpeg","png","gif"],"image/*":["jpg","jpeg","png","gif"],video:["mp4","avi","mov"],"video/*":["mp4","avi","mov"]}[t];return e.every(e=>{var t;const r=null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();return Array.isArray(a)?a.includes(r||""):r===a})},R=e=>/^(http|https|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(e),q=(e,t)=>{var a;switch(t=null===(a=t)||void 0===a?void 0:a.trim(),e){case"message":if(!t)return"Message is required";if(t.length<3)return"Message must be at least 3 characters";if(t.length>500)return"Message must be at most 500 characters";break;case"title":if(!t)return"Title is required";if(t.length<1)return"Title must be at least 1 characters";if(t.length>500)return"Title must be at most 500 characters";break;case"leadEmailTo":if(t&&!/\S+@\S+\.\S+/.test(t))return"Lead Email To is invalid";break;case"leadEmailCc":if(t&&!/\S+@\S+\.\S+/.test(t))return"Lead Email CC is invalid";break;case"googleTagManagerPayload":try{const e=new Function("return (".concat(t,")"))();if(!Array.isArray(e)||null===e)return"Must be a valid JSON object"}catch(r){return"Invalid JSON format"}}return""},V=e=>{const t={};if(e.errors={},e.message||(t.message="Error in Question Node",e.errors.message="A message is required"),e.fieldType||(t.message="Error in Question Node",e.errors.fieldType="Question Type is required"),e.property){/^[a-zA-Z0-9-_]+$/.test(e.property.trim())||(t.message="Error in Question Node",e.errors.property="Property can only contain alphanumeric characters, hyphens (-), and underscores (_), and should not have spaces.")}switch(e.fieldType){case m.bh.DATE:{const a=c()().startOf("day"),r=c()().add(3,"months").endOf("day"),s=e.min?c()(e.min).startOf("day"):a,o=e.max?c()(e.max).endOf("day"):r;s&&s.isBefore(a)&&(t.message="Error in Question Node",e.errors.min="Min date cannot be before today."),o&&o.isAfter(r)&&(t.message="Error in Question Node",e.errors.max="Max date cannot be more than 3 months from today."),s&&o&&s.isAfter(o)&&(t.message="Error in Question Node",e.errors.min="Min date cannot be after Max date.");break}case m.bh.DATETIME:{const a=e.min?c()(e.min):null,r=e.max?c()(e.max):null,s=c()().startOf("day"),o=c()().add(3,"months").endOf("day");a&&a.isBefore(s)&&(t.message="Error in Question Node",e.errors.min="Min datetime cannot be before today."),r&&r.isAfter(o)&&(t.message="Error in Question Node",e.errors.max="Max datetime cannot be more than 3 months from today."),a&&r&&a.isAfter(r)&&(t.message="Error in Question Node",e.errors.min="Min datetime cannot be after Max datetime.");break}case m.bh.TIME:{const a=e.min?c()(e.min):null,r=e.max?c()(e.max):null,s=c()().startOf("day"),o=c()().endOf("day");a&&a.isBefore(s)&&(t.message="Error in Question Node",e.errors.min="Min time cannot be before today."),r&&r.isAfter(o)&&(t.message="Error in Question Node",e.errors.max="Max time cannot be after today."),a&&r&&a.isAfter(r)&&(t.message="Error in Question Node",e.errors.min="Min time cannot be after Max time.");break}case"custom":e.custom||(t.message="Error in Question Node",e.errors.custom="A custom regex is required.");break;case"string":case"number":case"age":{const a=e.min?parseInt(e.min,10):void 0,r=e.max?parseInt(e.max,10):void 0,s=G(a,r,e.fieldType);s&&(t.message="Error in Question Node",e.errors.answer=s);break}}return t},X=e=>{var t,a,r,s,o;const l={};if(e.errors={},e.property){/^[a-zA-Z0-9-_]+$/.test(e.property.trim())||(l.message="Error in WhatsApp Flow Node",e.errors.property="Property can only contain alphanumeric characters, hyphens (-), and underscores (_), and should not have spaces.")}if(null!==(t=e.body)&&void 0!==t&&t.trim()||(l.message="Error in WhatsApp Flow Node",e.errors.body="Body is required"),null!==(a=e.flow_id)&&void 0!==a&&a.trim()||(l.message="Error in WhatsApp Flow Node",e.errors.flow_id="Flow ID is required"),null!==(r=e.flow_action)&&void 0!==r&&r.trim()||(l.message="Error in WhatsApp Flow Node",e.errors.flow_action="Flow Action is required"),null!==(s=e.screen)&&void 0!==s&&s.trim()||(l.message="Error in WhatsApp Flow Node",e.errors.screen="First Screen is required"),null!==(o=e.flow_cta)&&void 0!==o&&o.trim()?e.flow_cta.length>30&&(l.message="Error in WhatsApp Flow Node",e.errors.flow_cta="Submit Button text must be at most 30 characters"):(l.message="Error in WhatsApp Flow Node",e.errors.flow_cta="Submit Button text is required"),e.responsedata)try{const t="string"===typeof e.responsedata?JSON.parse(e.responsedata):e.responsedata;"object"===typeof t&&null!==t||(l.message="Error in WhatsApp Flow Node",e.errors.responsedata="Must be a valid JSON object")}catch(i){l.message="Error in WhatsApp Flow Node",e.errors.responsedata="Invalid JSON format"}else l.message="Error in WhatsApp Flow Node",e.errors.responsedata="Response Data is required";return l},G=(e,t,a)=>{if(e&&"number"!==typeof e||t&&"number"!==typeof t)return"Both min and max values must be valid numbers for ".concat(a,".");if(e&&t&&e>t)return"Min value cannot be greater than Max value for ".concat(a,".");if("string"===a){if(e&&e<3)return"Min length for string must be at least 3.";if(t&&t>2500)return"Max length for string must not exceed 500."}if("number"===a){const r=1,s=9999999999;if(e&&(e<r||e>s))return"Min value for ".concat(a," must be between ").concat(r," and ").concat(s,".");if(t&&(t<r||t>s))return"Max value for ".concat(a," must be between ").concat(r," and ").concat(s,".")}return""},Q=e=>{const t={};return e.errors={},["message","successMessage","failureMessage"].forEach(a=>Z(e[a],a,t,"Call Connect",e)),["callConnectId","callAccepted","callRejected"].forEach(a=>Z(e[a],a,t,"Call Connect",e,!1)),t},J=e=>{const t={};return e.errors={},Z(e.message,"message",t,"OTP",e),Z(e.otpType,"otpType",t,"OTP",e,!1),t},Y=(e,t,a,r,s)=>{let o="";switch(e){case"message":t?t.length<3?o="Message must be at least 3 characters":t.length>500&&(o="Message must be at most 500 characters"):o="Message is required";break;case"property":t?t.length<3?o="Property must be at least 3 characters":t.length>500?o="Property must be at most 500 characters":/^[A-Za-z][\w]*$/.test(t)?null!==s&&void 0!==s&&s.has(t)&&(o="Property name must be unique"):o="Property must start with a letter, cannot contain spaces, or special characters like '@', and should not start with a number":o="Property is required";break;case"title":t?t.length<3?o="Title must be at least 1 character":t.length>500&&(o="Title must be at most 500 characters"):o="Title is required";break;case"whatsAppQuestion":t?t.length<3?o="whatsAppQuestion must be at least 1 character":t.length>500&&(o="whatsAppQuestion must be at most 500 characters"):o="whatsAppQuestion is required";break;case"fieldType":t||(o="Field Type is required");break;case"custom":a===e&&(t||(o="A custom regex is required."));break;case"min":case"max":if(!m.bh.PHONE_NUMBER&&!m.bh.EMAIL)switch(t||(o="Field Type is required"),a){case"string":case"number":{const e=null!==r&&void 0!==r&&r.min?parseInt(r.min,10):void 0,t=null!==r&&void 0!==r&&r.max?parseInt(r.max,10):void 0,s=G(e,t,a);s&&(o=s);break}case m.bh.DATE:{const e=c()().startOf("day"),t=c()().add(3,"months").endOf("day"),a=null!==r&&void 0!==r&&r.min?c()(null===r||void 0===r?void 0:r.min).startOf("day"):e,s=null!==r&&void 0!==r&&r.max?c()(null===r||void 0===r?void 0:r.max).endOf("day"):t;a.isBefore(e)&&(o="Min date cannot be before today."),s.isAfter(t)&&(o="Max date cannot be more than 3 months from today."),a.isAfter(s)&&(o="Min date cannot be after Max date.");break}case m.bh.DATETIME:{const e=null!==r&&void 0!==r&&r.min?c()(r.min):null,t=null!==r&&void 0!==r&&r.max?c()(r.max):null,a=c()().startOf("day"),s=c()().add(3,"months").endOf("day");e&&e.isBefore(a)&&(o="Min datetime cannot be before today."),t&&t.isAfter(s)&&(o="Max datetime cannot be more than 3 months from today."),e&&t&&e.isAfter(t)&&(o="Min datetime cannot be after Max datetime.");break}case m.bh.TIME:{const e=null!==r&&void 0!==r&&r.min?c()(r.min):null,t=null!==r&&void 0!==r&&r.max?c()(r.max):null,a=c()().startOf("day"),s=c()().endOf("day");e&&e.isBefore(a)&&(o="Min time cannot be before today."),t&&t.isAfter(s)&&(o="Max time cannot be after today."),e&&t&&e.isAfter(t)&&(o="Min time cannot be after Max time.");break}}}return o};function Z(e,t,a,r,s){e?(!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&(e.length<3||e.length>500)&&(a.message="Error in ".concat(t," Node"),s.errors[t]="".concat(t," must be between 3 and 500 characters")):(a.message="Error in ".concat(r," Node"),s.errors[t]="".concat(t," is required"))}const $=(e,t,a)=>{const r=e.data,s={},o={};r.errors={};let l=[];const i=D(e.id,a,t);if(l=O(i),r.url&&0!==r.url.length){const e=r.url.match(/\{(.*?)\}/);if(e){var n;const t=null===(n=e[1])||void 0===n?void 0:n.trim();/^[a-zA-Z0-9-_]+$/.test(t)&&0!=l.length&&l.includes(t)||(o.url="HTTP Node - Property can only contain alphanumeric characters, hyphens (-), and underscores (_), and should not have spaces.")}}else s.message="Error in HTTP Node";return r.requestType&&0!==r.requestType.length||(s.message="Error in HTTP Node"),r.statusWiseFlow.length&&r.statusWiseFlow.forEach(e=>{e.statusCode||(s.message="Error in HTTP Node")}),r.params.length&&(r.errors.params=[],r.params.forEach((e,t)=>{const a=K(e,t,l,"Param",s);a&&Object.keys(a).length>0&&r.errors.params.push({index:t,errors:a.errors})})),r.headers.length&&(r.errors.headers=[],r.headers.forEach((e,t)=>{const a=K(e,t,l,"Header",s);a&&Object.keys(a).length>0&&r.errors.headers.push({index:t,errors:a.errors})})),r.successFlowId||(s.message="Error in HTTP Node",r.errors.successFlowStatusCode="HTTP Node - Success flow statusCode is mandatory"),r.failureFlowId||(s.message="Error in HTTP Node",r.errors.failureFlowStatusCode="HTTP Node - Failure flow statusCode is mandatory"),r.statusWiseFlow&&r.statusWiseFlow.length>0&&(r.errors.statusWiseFlow=[],r.statusWiseFlow.forEach((e,t)=>{e.statusCode||r.errors.statusWiseFlow.push({index:t,message:"HTTP Node - Status code is mandatory"})})),{newErrors:s,newWarnings:o}},K=(e,t,a,r,s)=>{var o;const l={},{key:i,valueType:n,value:d}=e;if(i||(l.key="".concat(r," - Key is mandatory"),s.message="Error in HTTP Node"),n||(l.valueType="".concat(r," - ValueType is mandatory"),s.message="Error in HTTP Node"),d?"number"===n&&isNaN(Number(d))?(l.value="".concat(r," - Value is not a valid Number"),s.message="Error in HTTP Node"):"date"!==n||d instanceof Date||(l.value="".concat(r," - Value is not a valid Date"),s.message="Error in HTTP Node"):(l.value="".concat(r," - Value is mandatory"),s.message="Error in HTTP Node"),("param"==n||"header"==n)&&0===(null===(o=Object.keys(l))||void 0===o?void 0:o.length)){const e=d.trim();if(e){/^[A-Za-z][\w]*$/.test(e)&&0!==a.length&&a.includes(e)||(l.property="".concat(r," - Property must contain only alphanumeric characters, hyphens (-), underscores (_), and no spaces."),s.message="Error in HTTP Node")}else l.property="".concat(r," - Property must contain only alphanumeric characters, hyphens (-), underscores (_), and no spaces."),s.message="Error in HTTP Node"}return Object.keys(l).length>0?{index:t,errors:l}:null},ee=e=>{var t,a;const r={};if(e.errors={},null!==(t=e.cardHeaderType)&&void 0!==t&&t.trim()?["IMAGE","VIDEO"].includes(e.cardHeaderType)||(r.message="Error in WhatsApp Carousel Node",e.errors.cardHeaderType="Card Header Type must be either IMAGE or VIDEO"):(r.message="Error in WhatsApp Carousel Node",e.errors.cardHeaderType="Card Header Type is required"),null!==(a=e.wbTemplateId)&&void 0!==a&&a.trim()?e.wbTemplateId.length>100&&(r.message="Error in WhatsApp Carousel Node",e.errors.wbTemplateId="WB Template ID must be at most 100 characters"):(r.message="Error in WhatsApp Carousel Node",e.errors.wbTemplateId="WB Template ID is required"),e.property){/^[a-zA-Z0-9-_]+$/.test(e.property.trim())?e.property.length>50&&(r.message="Error in WhatsApp Carousel Node",e.errors.property="Property must be at most 50 characters"):(r.message="Error in WhatsApp Carousel Node",e.errors.property="Property can only contain alphanumeric characters, hyphens (-), and underscores (_), and should not have spaces.")}if(e.fieldLabel&&(e.fieldLabel.length<1||e.fieldLabel.length>50)&&(r.message="Error in WhatsApp Carousel Node",e.errors.fieldLabel="Field Label must be between 1 and 50 characters"),e.cards&&Array.isArray(e.cards)&&0!==e.cards.length?e.cards.length>10?(r.message="Error in WhatsApp Carousel Node",e.errors.cards="Maximum 10 cards are allowed"):(e.errors.cardsErrors=[],e.cards.forEach((t,a)=>{var s;const o={};if(null!==(s=t.link)&&void 0!==s&&s.trim()||(o.link="Link is required",r.message="Error in WhatsApp Carousel Node"),t.leadEmailTo){const e=t.leadEmailTo.trim();B(e)||(o.leadEmailTo="Lead Email To must be a valid email",r.message="Error in WhatsApp Carousel Node")}if(t.leadEmailCc&&Array.isArray(t.leadEmailCc)){var l;const e=new Set;null!==(l=t.leadEmailTo)&&void 0!==l&&l.trim()&&e.add(t.leadEmailTo.trim()),t.leadEmailCc.forEach((t,a)=>{const s=t.trim();s&&(B(s)?e.has(s)?(o["leadEmailCc_".concat(a)]="Duplicate email in Lead Email Cc",r.message="Error in WhatsApp Carousel Node"):e.add(s):(o["leadEmailCc_".concat(a)]="Invalid email format in Lead Email Cc",r.message="Error in WhatsApp Carousel Node"))})}t.postbackTexts&&Array.isArray(t.postbackTexts)&&(t.postbackTexts.length>2&&(o.postbackTexts="Maximum 2 buttons are allowed per card",r.message="Error in WhatsApp Carousel Node"),t.postbackTexts.forEach((e,t)=>{e.text&&e.text.trim()&&e.text.length>20&&(o["postbackText_".concat(t)]="Button text must be at most 20 characters",r.message="Error in WhatsApp Carousel Node")})),Object.keys(o).length>0&&e.errors.cardsErrors.push({index:a,errors:o})})):(r.message="Error in WhatsApp Carousel Node",e.errors.cards="At least one card is required"),e.contentParams)if(Array.isArray(e.contentParams)){e.contentParams.some(e=>"string"===typeof e&&!e.trim())&&(r.message="Error in WhatsApp Carousel Node",e.errors.contentParams="Content Params cannot contain empty values")}else r.message="Error in WhatsApp Carousel Node",e.errors.contentParams="Content Params must be an array";return r},te=(e,t)=>{const a=null===t||void 0===t?void 0:t.trim();switch(e){case"fieldLabel":if(a&&(a.length<1||a.length>50))return"Field Label must be between 1 and 50 characters";break;case"property":if(a){if(!/^[a-zA-Z0-9-_]+$/.test(a))return"Property can only contain alphanumeric characters, hyphens (-), and underscores (_)";if(a.length>50)return"Property must be at most 50 characters"}break;case"cardHeaderType":if(!a)return"Card Header Type is required";if(!["IMAGE","VIDEO"].includes(a))return"Card Header Type must be either IMAGE or VIDEO";break;case"wbTemplateId":if(!a)return"WB Template ID is required";if(a.length>100)return"WB Template ID must be at most 100 characters"}return""};var ae=a(74248);const re={Smileys:[{emoji:"\ud83d\ude00",keywords:["grinning","happy","smile"]},{emoji:"\ud83d\ude01",keywords:["grin","smiley","cheerful"]},{emoji:"\ud83d\ude02",keywords:["joy","tears","laugh"]},{emoji:"\ud83e\udd23",keywords:["rofl","roll","laughing"]},{emoji:"\ud83d\ude03",keywords:["smile","happy","joy"]},{emoji:"\ud83d\ude04",keywords:["smiling","joy","happy"]},{emoji:"\ud83d\ude05",keywords:["sweat","relief","nervous"]},{emoji:"\ud83d\ude06",keywords:["laugh","happy","joy"]},{emoji:"\ud83d\ude09",keywords:["wink","flirt","playful"]},{emoji:"\ud83d\ude0a",keywords:["blush","happy","smile"]},{emoji:"\ud83d\ude0b",keywords:["yum","delicious","tasty"]},{emoji:"\ud83d\ude0e",keywords:["cool","sunglasses","chill"]},{emoji:"\ud83d\ude0d",keywords:["love","heart","eyes","romantic"]},{emoji:"\ud83d\ude18",keywords:["kiss","heart","love"]},{emoji:"\ud83d\ude17",keywords:["kiss","face","blowing"]},{emoji:"\ud83d\ude19",keywords:["kiss","smiling","love"]},{emoji:"\ud83d\ude1a",keywords:["kiss","closed","eyes"]},{emoji:"\ud83d\ude42",keywords:["smile","slight","happy"]},{emoji:"\ud83e\udd17",keywords:["hug","face","smile","embrace"]},{emoji:"\ud83e\udd29",keywords:["star","struck","amazed"]},{emoji:"\ud83e\udd14",keywords:["thinking","hmm","curious"]},{emoji:"\ud83e\udd28",keywords:["face","eyebrow","raised"]},{emoji:"\ud83d\ude10",keywords:["neutral","meh","blank"]},{emoji:"\ud83d\ude11",keywords:["expressionless","blank","deadpan"]},{emoji:"\ud83d\ude36",keywords:["silence","no","mouth"]},{emoji:"\ud83d\ude44",keywords:["eye","roll","annoyed"]},{emoji:"\ud83d\ude0f",keywords:["smirk","sly","looking"]},{emoji:"\ud83d\ude23",keywords:["persevere","struggling","face"]},{emoji:"\ud83d\ude25",keywords:["relieved","sweat","exhaled"]},{emoji:"\ud83d\ude2e",keywords:["face","surprise","wow"]},{emoji:"\ud83e\udd24",keywords:["drooling","yum","delicious"]},{emoji:"\ud83d\ude2a",keywords:["sleepy","tired","exhausted"]},{emoji:"\ud83d\ude2f",keywords:["hushed","quiet","speechless"]},{emoji:"\ud83d\ude2b",keywords:["tired","sleepy","exhausted"]},{emoji:"\ud83d\ude34",keywords:["sleeping","zzz","sleep"]},{emoji:"\ud83e\udd22",keywords:["nauseated","sick","face"]},{emoji:"\ud83e\udd75",keywords:["hot","sweating","face"]},{emoji:"\ud83e\udd76",keywords:["cold","freezing","face"]},{emoji:"\ud83d\ude13",keywords:["sweat","sad","disappointed"]},{emoji:"\ud83d\ude20",keywords:["angry","mad","annoyed"]},{emoji:"\ud83d\ude21",keywords:["rage","pout","angry"]},{emoji:"\ud83e\udd2c",keywords:["swearing","angry","censored"]},{emoji:"\ud83d\ude14",keywords:["sad","disappointed","down"]},{emoji:"\ud83d\ude15",keywords:["confused","meh","puzzled"]},{emoji:"\ud83d\ude41",keywords:["frowning","sad","unhappy"]},{emoji:"\ud83d\ude1f",keywords:["worried","anxious","concerned"]},{emoji:"\ud83d\ude16",keywords:["confounded","distressed","upset"]},{emoji:"\ud83d\ude22",keywords:["crying","sad","tears"]},{emoji:"\ud83d\ude2d",keywords:["sob","cry","tear"]},{emoji:"\ud83d\ude29",keywords:["weary","tired","exhausted"]},{emoji:"\ud83d\ude23",keywords:["persevere","struggle","sad"]},{emoji:"\ud83d\ude1e",keywords:["disappointed","sad","upset"]},{emoji:"\ud83d\ude24",keywords:["triumph","proud","smug"]},{emoji:"\ud83d\ude2b",keywords:["tired","exhausted","sad"]},{emoji:"\ud83d\ude30",keywords:["anxious","sad","worried"]},{emoji:"\ud83d\ude31",keywords:["screaming","shock","scared"]},{emoji:"\ud83d\ude33",keywords:["flushed","embarrassed","shocked"]},{emoji:"\ud83e\udd2f",keywords:["mind","blown","shock"]},{emoji:"\ud83e\udd20",keywords:["cowboy","hat","cheerful"]},{emoji:"\ud83e\udd73",keywords:["party","celebrating","fun"]},{emoji:"\ud83d\ude0e",keywords:["cool","shade","sunglasses"]},{emoji:"\ud83e\udd13",keywords:["nerd","smart","studious"]},{emoji:"\ud83e\uddd0",keywords:["monocle","curious","inspect"]},{emoji:"\ud83d\ude26",keywords:["frowning","sad","upset"]},{emoji:"\ud83d\ude27",keywords:["anguished","distressed","sad"]},{emoji:"\ud83d\ude32",keywords:["astonished","surprised","shocked"]},{emoji:"\ud83e\udd7a",keywords:["pleading","sad","cute"]},{emoji:"\ud83d\ude35",keywords:["dizzy","confused","woozy"]},{emoji:"\ud83e\udd10",keywords:["zipper","mouth","shutup"]},{emoji:"\ud83e\udd15",keywords:["head","injury","sick"]}],Animals:[{emoji:"\ud83d\udc31",keywords:["cat","pet","feline"]},{emoji:"\ud83d\udc36",keywords:["dog","pet","puppy"]},{emoji:"\ud83d\udc2d",keywords:["mouse","rodent","small"]},{emoji:"\ud83d\udc39",keywords:["hamster","pet","small"]},{emoji:"\ud83d\udc30",keywords:["rabbit","bunny","pet"]},{emoji:"\ud83e\udd8a",keywords:["fox","wild","animal"]},{emoji:"\ud83d\udc3b",keywords:["bear","wild","animal"]},{emoji:"\ud83d\udc3c",keywords:["panda","bear","animal"]},{emoji:"\ud83d\udc28",keywords:["koala","bear","animal"]},{emoji:"\ud83d\udc2f",keywords:["tiger","wild","bigcat"]},{emoji:"\ud83e\udd81",keywords:["lion","wild","king"]},{emoji:"\ud83d\udc2e",keywords:["cow","farm","animal"]},{emoji:"\ud83d\udc37",keywords:["pig","farm","animal"]},{emoji:"\ud83d\udc38",keywords:["frog","amphibian","animal"]},{emoji:"\ud83d\udc35",keywords:["monkey","animal","primate"]},{emoji:"\ud83e\udd84",keywords:["unicorn","mythical","animal"]},{emoji:"\ud83d\udc34",keywords:["horse","equine","animal"]},{emoji:"\ud83d\udc24",keywords:["chick","baby","bird"]},{emoji:"\ud83e\udd9c",keywords:["parrot","bird","talking"]},{emoji:"\ud83e\udda2",keywords:["swan","bird","majestic"]},{emoji:"\ud83e\udd89",keywords:["owl","bird","night"]},{emoji:"\ud83e\udd87",keywords:["bat","night","animal"]},{emoji:"\ud83d\udc3a",keywords:["wolf","animal","wild"]},{emoji:"\ud83d\udc17",keywords:["boar","wild","animal"]},{emoji:"\ud83d\udc39",keywords:["hamster","animal","pet"]},{emoji:"\ud83e\udd94",keywords:["hedgehog","animal","cute"]},{emoji:"\ud83d\udc26",keywords:["bird","animal","flying"]},{emoji:"\ud83d\udc27",keywords:["penguin","bird","cold"]},{emoji:"\ud83e\udd80",keywords:["crab","sea","animal"]},{emoji:"\ud83e\udd9e",keywords:["lobster","sea","animal"]},{emoji:"\ud83e\udd90",keywords:["shrimp","sea","animal"]},{emoji:"\ud83d\udc22",keywords:["turtle","reptile","animal"]},{emoji:"\ud83e\udd8e",keywords:["lizard","reptile","animal"]},{emoji:"\ud83d\udc0d",keywords:["snake","reptile","animal"]},{emoji:"\ud83e\udd95",keywords:["sauropod","dinosaur","extinct"]},{emoji:"\ud83e\udd96",keywords:["T-Rex","dinosaur","extinct"]},{emoji:"\ud83d\udc19",keywords:["octopus","sea","animal"]},{emoji:"\ud83d\udc2c",keywords:["dolphin","sea","animal"]},{emoji:"\ud83d\udc33",keywords:["whale","sea","animal"]},{emoji:"\ud83d\udc1f",keywords:["fish","sea","animal"]},{emoji:"\ud83d\udc20",keywords:["tropical","fish","sea"]},{emoji:"\ud83d\udc21",keywords:["blowfish","sea","animal"]},{emoji:"\ud83d\udc2c",keywords:["dolphin","sea","animal"]},{emoji:"\ud83e\udd88",keywords:["shark","sea","animal"]},{emoji:"\ud83d\udc0a",keywords:["crocodile","reptile","animal"]},{emoji:"\ud83d\udc05",keywords:["tiger","wild","animal"]},{emoji:"\ud83d\udc06",keywords:["leopard","wild","animal"]},{emoji:"\ud83e\udd93",keywords:["zebra","wild","animal"]},{emoji:"\ud83e\udd8d",keywords:["gorilla","wild","animal"]},{emoji:"\ud83e\udda7",keywords:["orangutan","wild","animal"]},{emoji:"\ud83e\udd8f",keywords:["rhinoceros","wild","animal"]},{emoji:"\ud83e\udd9b",keywords:["hippopotamus","wild","animal"]},{emoji:"\ud83d\udc03",keywords:["water buffalo","wild","animal"]},{emoji:"\ud83d\udc02",keywords:["ox","farm","animal"]},{emoji:"\ud83e\udd92",keywords:["giraffe","wild","animal"]},{emoji:"\ud83d\udc18",keywords:["elephant","wild","animal"]},{emoji:"\ud83e\udd8f",keywords:["rhinoceros","wild","animal"]},{emoji:"\ud83e\udd87",keywords:["bat","wild","animal"]},{emoji:"\ud83d\udc2b",keywords:["camel","desert","animal"]},{emoji:"\ud83e\udd99",keywords:["llama","animal","farm"]},{emoji:"\ud83e\udd98",keywords:["kangaroo","wild","animal"]},{emoji:"\ud83e\udda1",keywords:["badger","wild","animal"]},{emoji:"\ud83d\udc29",keywords:["poodle","dog","animal"]},{emoji:"\ud83d\udc15",keywords:["dog","animal","pet"]},{emoji:"\ud83d\udc08",keywords:["cat","animal","pet"]},{emoji:"\ud83d\udc13",keywords:["rooster","farm","bird"]},{emoji:"\ud83d\udc08\u200d\u2b1b",keywords:["black cat","animal","pet"]},{emoji:"\ud83d\udc16",keywords:["pig","farm","animal"]},{emoji:"\ud83d\udc09",keywords:["dragon","mythical","animal"]},{emoji:"\ud83d\udc07",keywords:["rabbit","animal","pet"]},{emoji:"\ud83e\udda2",keywords:["swan","bird","majestic"]},{emoji:"\ud83d\udc15\u200d\ud83e\uddba",keywords:["service dog","animal","service"]},{emoji:"\ud83e\udda1",keywords:["badger","wild","animal"]},{emoji:"\ud83d\udc16",keywords:["pig","animal","farm"]},{emoji:"\ud83e\udda8",keywords:["skunk","wild","animal"]},{emoji:"\ud83e\udda1",keywords:["badger","wild","animal"]},{emoji:"\ud83e\udda6",keywords:["otter","wild","animal"]},{emoji:"\ud83e\udda8",keywords:["skunk","wild","animal"]},{emoji:"\ud83e\udda6",keywords:["otter","wild","animal"]},{emoji:"\ud83e\udda5",keywords:["sloth","wild","animal"]},{emoji:"\ud83e\udda9",keywords:["flamingo","wild","bird"]},{emoji:"\ud83e\udda9",keywords:["flamingo","wild","bird"]},{emoji:"\ud83e\udd92",keywords:["giraffe","wild","animal"]}],Food:[{emoji:"\ud83c\udf4f",keywords:["apple","green apple","fruit"]},{emoji:"\ud83c\udf4e",keywords:["apple","red apple","fruit"]},{emoji:"\ud83c\udf50",keywords:["pear","fruit"]},{emoji:"\ud83c\udf4a",keywords:["tangerine","orange","fruit"]},{emoji:"\ud83c\udf4b",keywords:["lemon","fruit"]},{emoji:"\ud83c\udf4c",keywords:["banana","fruit"]},{emoji:"\ud83c\udf49",keywords:["watermelon","fruit"]},{emoji:"\ud83c\udf47",keywords:["grapes","fruit","vineyard"]},{emoji:"\ud83c\udf53",keywords:["strawberry","fruit"]},{emoji:"\ud83c\udf48",keywords:["melon","fruit"]},{emoji:"\ud83c\udf52",keywords:["cherries","fruit"]},{emoji:"\ud83c\udf51",keywords:["peach","fruit"]},{emoji:"\ud83c\udf4d",keywords:["pineapple","fruit"]},{emoji:"\ud83e\udd6d",keywords:["mango","fruit"]},{emoji:"\ud83e\udd65",keywords:["coconut","fruit"]},{emoji:"\ud83e\udd5d",keywords:["kiwi","fruit"]},{emoji:"\ud83c\udf45",keywords:["tomato","vegetable"]},{emoji:"\ud83c\udf46",keywords:["eggplant","vegetable"]},{emoji:"\ud83e\udd51",keywords:["avocado","fruit"]},{emoji:"\ud83e\udd52",keywords:["cucumber","vegetable"]},{emoji:"\ud83e\udd6c",keywords:["leafy greens","vegetable","lettuce"]},{emoji:"\ud83e\udd66",keywords:["broccoli","vegetable"]},{emoji:"\ud83c\udf3d",keywords:["corn","vegetable"]},{emoji:"\ud83c\udf36",keywords:["hot pepper","vegetable","spicy"]},{emoji:"\ud83e\udd55",keywords:["carrot","vegetable"]},{emoji:"\ud83e\uddc4",keywords:["garlic","vegetable"]},{emoji:"\ud83e\uddc5",keywords:["onion","vegetable"]},{emoji:"\ud83e\udd54",keywords:["potato","vegetable"]},{emoji:"\ud83c\udf60",keywords:["yam","vegetable","sweet potato"]},{emoji:"\ud83e\udd50",keywords:["croissant","bread"]},{emoji:"\ud83c\udf5e",keywords:["bread","loaf"]},{emoji:"\ud83e\udd56",keywords:["baguette","bread"]},{emoji:"\ud83e\udd68",keywords:["pretzel","bread","snack"]},{emoji:"\ud83e\udd6f",keywords:["bagel","bread"]},{emoji:"\ud83e\udd5e",keywords:["pancakes","breakfast"]},{emoji:"\ud83e\uddc7",keywords:["waffle","breakfast"]},{emoji:"\ud83e\uddc0",keywords:["cheese","dairy"]},{emoji:"\ud83c\udf56",keywords:["meat","bone","food"]},{emoji:"\ud83c\udf57",keywords:["poultry leg","chicken leg","food"]},{emoji:"\ud83e\udd69",keywords:["cut of meat","steak","food"]},{emoji:"\ud83c\udf64",keywords:["fried shrimp","seafood"]},{emoji:"\ud83e\udd5a",keywords:["egg","food","breakfast"]},{emoji:"\ud83c\udf73",keywords:["cooking","egg","fried egg"]},{emoji:"\ud83e\udd53",keywords:["bacon","meat","breakfast"]},{emoji:"\ud83e\udd57",keywords:["salad","food","healthy"]},{emoji:"\ud83c\udf72",keywords:["pot of food","soup","stew"]},{emoji:"\ud83c\udf7f",keywords:["popcorn","snack","movies"]},{emoji:"\ud83e\uddc8",keywords:["butter","food"]},{emoji:"\ud83c\udf71",keywords:["bento box","sushi","Japanese food"]},{emoji:"\ud83c\udf63",keywords:["sushi","Japanese food"]},{emoji:"\ud83c\udf5b",keywords:["curry","rice","food"]},{emoji:"\ud83c\udf5c",keywords:["noodles","ramen","bowl"]},{emoji:"\ud83c\udf5d",keywords:["spaghetti","pasta","food"]},{emoji:"\ud83e\udd5f",keywords:["dumpling","food"]},{emoji:"\ud83c\udf60",keywords:["sweet potato","food"," roasted"]},{emoji:"\ud83c\udf64",keywords:["shrimp","food","fried"]},{emoji:"\ud83c\udf62",keywords:["oden","food","skewer"]},{emoji:"\ud83c\udf75",keywords:["tea","cup"]},{emoji:"\ud83e\udd5b",keywords:["milk","glass"]},{emoji:"\u2615",keywords:["coffee","cup"]},{emoji:"\ud83c\udf70",keywords:["cake","dessert","birthday"]},{emoji:"\ud83c\udf82",keywords:["birthday cake","dessert"]},{emoji:"\ud83c\udf69",keywords:["doughnut","dessert"]},{emoji:"\ud83c\udf6a",keywords:["cookie","dessert"]},{emoji:"\ud83c\udf6d",keywords:["lollipop","candy"]},{emoji:"\ud83c\udf6b",keywords:["chocolate","bar","dessert"]},{emoji:"\ud83c\udf6c",keywords:["candy","sweet"]},{emoji:"\ud83c\udf6f",keywords:["honey","honey pot","sweet"]},{emoji:"\ud83e\uddc2",keywords:["salt","condiment"]}],Activity:[{emoji:"\u26bd",keywords:["soccer","football","goal"]},{emoji:"\ud83c\udfc0",keywords:["basketball","hoops","dunk"]},{emoji:"\ud83c\udfc8",keywords:["football","rugby","gridiron"]},{emoji:"\u26be",keywords:["baseball","pitch","bat"]},{emoji:"\ud83c\udfbe",keywords:["tennis","racket","serve"]},{emoji:"\ud83c\udfd0",keywords:["volleyball","spike","serve"]},{emoji:"\ud83c\udfc9",keywords:["rugby","ball","scrum"]},{emoji:"\ud83c\udfb1",keywords:["pool","billiards","eight ball"]},{emoji:"\ud83c\udfd3",keywords:["ping pong","table tennis","paddle"]},{emoji:"\ud83c\udff8",keywords:["badminton","shuttlecock","racket"]},{emoji:"\ud83e\udd45",keywords:["goal","net","hockey"]},{emoji:"\ud83c\udfd2",keywords:["hockey","ice hockey","puck"]},{emoji:"\ud83c\udfd1",keywords:["field hockey","stick","ball"]},{emoji:"\ud83e\udd4d",keywords:["lacrosse","stick","ball"]},{emoji:"\ud83c\udfcf",keywords:["cricket","bat","ball"]},{emoji:"\u26f3",keywords:["golf","flag","hole in one"]},{emoji:"\ud83c\udff9",keywords:["archery","bow","arrow"]},{emoji:"\ud83c\udfa3",keywords:["fishing","fish","rod"]},{emoji:"\ud83e\udd3f",keywords:["scuba","diving","snorkeling"]},{emoji:"\ud83d\udef7",keywords:["sled","sledge","toboggan"]},{emoji:"\ud83e\udd4c",keywords:["curling","stone","sweep"]},{emoji:"\ud83d\udef9",keywords:["skateboard","skating","skate"]},{emoji:"\ud83d\udefc",keywords:["roller skate","skating","rolling"]},{emoji:"\u26f8\ufe0f",keywords:["ice skate","skating","ice"]},{emoji:"\ud83d\udef6",keywords:["canoe","kayak","paddle"]},{emoji:"\u26bd",keywords:["soccer","football","goal"]},{emoji:"\ud83c\udfcb\ufe0f\u200d\u2642\ufe0f",keywords:["weight lifting","gym","workout"]},{emoji:"\ud83c\udfcb\ufe0f\u200d\u2640\ufe0f",keywords:["weight lifting","gym","workout"]},{emoji:"\ud83c\udfcb\ufe0f",keywords:["weight lifting","gym","workout"]},{emoji:"\ud83e\udd3a",keywords:["fencing","sword","duel"]},{emoji:"\ud83e\udd3c\u200d\u2642\ufe0f",keywords:["wrestling","grappling","fight"]},{emoji:"\ud83e\udd3c\u200d\u2640\ufe0f",keywords:["wrestling","grappling","fight"]},{emoji:"\ud83e\udd38\u200d\u2642\ufe0f",keywords:["gymnastics","flip","somersault"]},{emoji:"\ud83e\udd38\u200d\u2640\ufe0f",keywords:["gymnastics","flip","somersault"]},{emoji:"\ud83e\udd3e\u200d\u2642\ufe0f",keywords:["handball","goalie","ball"]},{emoji:"\ud83e\udd3e\u200d\u2640\ufe0f",keywords:["handball","goalie","ball"]},{emoji:"\ud83e\udd39\u200d\u2642\ufe0f",keywords:["juggle","performance","circus"]},{emoji:"\ud83e\udd39\u200d\u2640\ufe0f",keywords:["juggle","performance","circus"]},{emoji:"\ud83e\uddd8\u200d\u2642\ufe0f",keywords:["yoga","meditation","relax"]},{emoji:"\ud83e\uddd8\u200d\u2640\ufe0f",keywords:["yoga","meditation","relax"]},{emoji:"\ud83e\uddd8",keywords:["yoga","meditation","relax"]},{emoji:"\ud83c\udfc4\u200d\u2642\ufe0f",keywords:["surfing","waves","ocean"]},{emoji:"\ud83c\udfc4\u200d\u2640\ufe0f",keywords:["surfing","waves","ocean"]},{emoji:"\ud83c\udfc2",keywords:["snowboarding","snowboard","snow"]},{emoji:"\u26f7\ufe0f",keywords:["skiing","snow","slope"]},{emoji:"\ud83c\udfc7",keywords:["horse racing","jockey","race"]},{emoji:"\ud83d\udeb4\u200d\u2642\ufe0f",keywords:["biking","cycling","bicycle"]},{emoji:"\ud83d\udeb4\u200d\u2640\ufe0f",keywords:["biking","cycling","bicycle"]},{emoji:"\ud83d\udeb5\u200d\u2642\ufe0f",keywords:["mountain biking","cycling","bike"]},{emoji:"\ud83d\udeb5\u200d\u2640\ufe0f",keywords:["mountain biking","cycling","bike"]},{emoji:"\ud83c\udfc7",keywords:["horse racing","jockey","race"]},{emoji:"\ud83e\udd47",keywords:["gold medal","winner","first place"]},{emoji:"\ud83e\udd48",keywords:["silver medal","second place","runner-up"]},{emoji:"\ud83e\udd49",keywords:["bronze medal","third place","winner"]},{emoji:"\ud83c\udfc6",keywords:["trophy","winner","champion"]},{emoji:"\ud83c\udfc5",keywords:["medal","reward","achievement"]},{emoji:"\ud83c\udf96\ufe0f",keywords:["military","decoration","award"]},{emoji:"\ud83c\udff5\ufe0f",keywords:["rosette","badge","award"]},{emoji:"\ud83c\udf97\ufe0f",keywords:["ribbon","cause","support"]}],Travel:[{emoji:"\ud83d\ude97",keywords:["car","automobile","travel","vehicle"]},{emoji:"\ud83d\ude95",keywords:["taxi","cab","transport","vehicle"]},{emoji:"\ud83d\ude99",keywords:["suv","vehicle","travel","transportation"]},{emoji:"\ud83d\ude8c",keywords:["bus","transport","vehicle","travel"]},{emoji:"\ud83d\ude8e",keywords:["trolleybus","public transport","vehicle"]},{emoji:"\ud83c\udfce\ufe0f",keywords:["racecar","racing","vehicle","sport"]},{emoji:"\ud83d\ude93",keywords:["police car","law enforcement","vehicle"]},{emoji:"\ud83d\ude91",keywords:["ambulance","emergency","hospital","vehicle"]},{emoji:"\ud83d\ude92",keywords:["fire truck","firefighter","emergency","vehicle"]},{emoji:"\ud83d\ude90",keywords:["minibus","van","transport","vehicle"]},{emoji:"\ud83d\ude9a",keywords:["delivery truck","cargo","shipping","vehicle"]},{emoji:"\ud83d\ude9b",keywords:["articulated lorry","semi truck","transport"]},{emoji:"\ud83d\ude9c",keywords:["tractor","farming","vehicle","agriculture"]},{emoji:"\ud83c\udfcd\ufe0f",keywords:["motorcycle","bike","riding","vehicle"]},{emoji:"\ud83d\udeb2",keywords:["bicycle","bike","cycling","vehicle"]},{emoji:"\ud83d\udef4",keywords:["kick scooter","scooter","ride","vehicle"]},{emoji:"\ud83d\udef5",keywords:["motor scooter","vespa","vehicle","ride"]},{emoji:"\ud83d\ude8f",keywords:["bus stop","transport","station","public transport"]},{emoji:"\ud83d\udee4\ufe0f",keywords:["railway track","train","rail","travel"]},{emoji:"\u26fd",keywords:["fuel pump","gas station","fuel","transport"]},{emoji:"\ud83d\udea8",keywords:["police light","emergency","alarm","vehicle"]},{emoji:"\ud83d\udea5",keywords:["horizontal traffic light","stoplight","signal"]},{emoji:"\ud83d\udea6",keywords:["vertical traffic light","stoplight","signal"]},{emoji:"\ud83d\uded1",keywords:["stop sign","warning","traffic"]},{emoji:"\ud83d\udea7",keywords:["construction","roadwork","warning"]},{emoji:"\u2693",keywords:["anchor","sailing","maritime","nautical"]},{emoji:"\u26f5",keywords:["sailboat","boat","sailing","watercraft"]},{emoji:"\ud83d\udef6",keywords:["canoe","kayak","paddling","boat"]},{emoji:"\ud83d\udea4",keywords:["speedboat","boat","speed","watercraft"]},{emoji:"\ud83d\udef3\ufe0f",keywords:["passenger ship","cruise","travel","boat"]},{emoji:"\u26f4\ufe0f",keywords:["ferry","boat","nautical","sea"]},{emoji:"\ud83d\udee5\ufe0f",keywords:["motor boat","yacht","boat","watercraft"]},{emoji:"\ud83d\udea2",keywords:["ship","ocean liner","travel","boating"]},{emoji:"\u2708\ufe0f",keywords:["airplane","flight","travel","plane"]},{emoji:"\ud83d\udee9\ufe0f",keywords:["small airplane","flight","aviation","plane"]},{emoji:"\ud83d\udeeb",keywords:["airplane departure","airport","takeoff","flight"]},{emoji:"\ud83d\udeec",keywords:["airplane arrival","landing","airport","flight"]},{emoji:"\ud83e\ude82",keywords:["parachute","skydiving","falling","activity"]},{emoji:"\ud83d\udcba",keywords:["seat","sitting","airline","travel"]},{emoji:"\ud83d\ude81",keywords:["helicopter","chopper","aviation","vehicle"]},{emoji:"\ud83d\ude9f",keywords:["suspension railway","train","transport","public transit"]},{emoji:"\ud83d\udea0",keywords:["mountain cableway","cable car","transport"]},{emoji:"\ud83d\udea1",keywords:["aerial tramway","cable car","transport","travel"]},{emoji:"\ud83d\udef0\ufe0f",keywords:["satellite","space station","orbit","communication"]},{emoji:"\ud83d\ude80",keywords:["rocket","space","launch","spaceship"]},{emoji:"\ud83d\udef8",keywords:["flying saucer","UFO","vehicle","alien"]},{emoji:"\ud83d\udef3\ufe0f",keywords:["passenger ship","cruise","voyage","boat"]},{emoji:"\ud83e\ude82",keywords:["parachute","skydiving","falling","sport"]},{emoji:"\ud83d\udeec",keywords:["landing","airplane","arrival","airport"]},{emoji:"\ud83d\udeeb",keywords:["takeoff","airplane","departure","airport"]},{emoji:"\u2708\ufe0f",keywords:["airplane","flight","travel","plane"]},{emoji:"\ud83d\ude89",keywords:["station","train","subway","transport"]},{emoji:"\ud83d\ude82",keywords:["locomotive","steam train","rail","engine"]},{emoji:"\ud83d\ude83",keywords:["railway car","train car","public transport"]},{emoji:"\ud83d\ude84",keywords:["high-speed train","shinkansen","transport"]},{emoji:"\ud83d\ude85",keywords:["bullet train","high-speed rail","transport"]},{emoji:"\ud83d\ude86",keywords:["train","rail","commuter","public transport"]},{emoji:"\ud83d\ude87",keywords:["subway","metro","underground","public transport"]},{emoji:"\ud83d\ude88",keywords:["light rail","tram","train","public transport"]},{emoji:"\ud83d\ude8a",keywords:["tram","streetcar","public transport","rail"]}],Objects:[{emoji:"\ud83d\udce6",keywords:["box","package"]},{emoji:"\ud83d\udcea",keywords:["mailbox","closed"]},{emoji:"\ud83d\udceb",keywords:["mailbox","open","mail"]},{emoji:"\ud83d\udcec",keywords:["mail","incoming"]},{emoji:"\ud83d\udced",keywords:["mail","outgoing"]},{emoji:"\ud83d\udcee",keywords:["postbox","mail"]},{emoji:"\ud83d\udcef",keywords:["postal horn"]},{emoji:"\ud83d\udcdc",keywords:["scroll","paper"]},{emoji:"\ud83d\udcc3",keywords:["page","curl","document"]},{emoji:"\ud83d\udcd1",keywords:["bookmark","tabs"]},{emoji:"\ud83d\udcc8",keywords:["chart","graph","up"]},{emoji:"\ud83d\udcc9",keywords:["chart","graph","down"]},{emoji:"\ud83d\udcca",keywords:["bar chart","graph"]},{emoji:"\ud83d\udcc7",keywords:["index card"]},{emoji:"\ud83d\udcc1",keywords:["file folder"]},{emoji:"\ud83d\udcc2",keywords:["open file folder"]},{emoji:"\ud83d\uddc2\ufe0f",keywords:["card","file","folders"]},{emoji:"\ud83d\udccb",keywords:["clipboard"]},{emoji:"\ud83d\udce4",keywords:["outbox","mail"]},{emoji:"\ud83d\udce5",keywords:["inbox","mail"]},{emoji:"\ud83d\udce6",keywords:["package","box"]},{emoji:"\ud83d\udce7",keywords:["email","envelope"]},{emoji:"\ud83d\udce8",keywords:["incoming mail"]},{emoji:"\ud83d\udce9",keywords:["envelope","arrow"]},{emoji:"\ud83d\udce4",keywords:["outbox","tray"]},{emoji:"\ud83d\udce5",keywords:["inbox","tray"]},{emoji:"\ud83d\udce6",keywords:["package"]},{emoji:"\ud83d\udce5",keywords:["inbox"]},{emoji:"\ud83d\udce7",keywords:["email"]},{emoji:"\ud83d\udce8",keywords:["incoming"]},{emoji:"\ud83d\udce9",keywords:["envelope"]},{emoji:"\ud83d\udce4",keywords:["outbox"]},{emoji:"\ud83d\udce1",keywords:["satellite","antenna"]},{emoji:"\ud83d\udd0b",keywords:["battery"]},{emoji:"\ud83d\udd0c",keywords:["plug"]},{emoji:"\ud83d\udca1",keywords:["bulb"]},{emoji:"\ud83d\udd26",keywords:["flashlight"]},{emoji:"\ud83d\udd6f\ufe0f",keywords:["candle"]},{emoji:"\ud83e\ude7a",keywords:["stethoscope","doctor"]},{emoji:"\ud83d\udd11",keywords:["key"]},{emoji:"\ud83d\udd12",keywords:["lock"]},{emoji:"\ud83d\udd13",keywords:["unlock"]},{emoji:"\ud83d\udd10",keywords:["lock","key"]},{emoji:"\ud83d\udd0f",keywords:["lock","pen"]},{emoji:"\ud83d\udcce",keywords:["paperclip"]},{emoji:"\ud83d\udd87\ufe0f",keywords:["linked","paperclips"]},{emoji:"\u2702\ufe0f",keywords:["scissors"]},{emoji:"\ud83d\uddc3\ufe0f",keywords:["file box"]},{emoji:"\ud83d\uddf3\ufe0f",keywords:["ballot box"]},{emoji:"\ud83d\uddc4\ufe0f",keywords:["file cabinet"]},{emoji:"\ud83d\udcc5",keywords:["calendar"]},{emoji:"\ud83d\udcc6",keywords:["tear-off calendar"]},{emoji:"\ud83d\uddd3\ufe0f",keywords:["spiral calendar"]},{emoji:"\ud83d\udcc7",keywords:["card index"]},{emoji:"\ud83d\udcc8",keywords:["chart increasing"]},{emoji:"\ud83d\udcc9",keywords:["chart decreasing"]},{emoji:"\ud83d\udcca",keywords:["bar chart"]},{emoji:"\ud83d\udccc",keywords:["pushpin"]},{emoji:"\ud83d\udccd",keywords:["round pushpin"]},{emoji:"\ud83d\udccf",keywords:["straight edge"]},{emoji:"\ud83d\udcd0",keywords:["triangular ruler"]},{emoji:"\u270f\ufe0f",keywords:["pencil"]},{emoji:"\ud83d\udd8d\ufe0f",keywords:["crayon"]},{emoji:"\ud83d\udd8c\ufe0f",keywords:["paintbrush"]},{emoji:"\ud83d\udd8a\ufe0f",keywords:["pen"]},{emoji:"\ud83d\udd8b\ufe0f",keywords:["fountain pen"]},{emoji:"\ud83d\udccf",keywords:["straight edge"]},{emoji:"\ud83d\udcd0",keywords:["triangular ruler"]}],Symbols:[{emoji:"\ud83d\udc49\ud83c\udffb",keywords:["point right","hand","gesture"]},{emoji:"\ud83d\udc48\ud83c\udffb",keywords:["point left","hand","gesture"]},{emoji:"\ud83d\udc46\ud83c\udffb",keywords:["point up","hand","gesture"]},{emoji:"\ud83d\udc47\ud83c\udffb",keywords:["point down","hand","gesture"]},{emoji:"\ud83d\udc4d\ud83c\udffb",keywords:["thumbs up","approval","hand","gesture"]},{emoji:"\ud83d\udc4e\ud83c\udffb",keywords:["thumbs down","disapproval","hand","gesture"]},{emoji:"\ud83d\udc4c\ud83c\udffb",keywords:["okay","hand","gesture","perfect"]},{emoji:"\u270c\ud83c\udffb",keywords:["victory","peace","hand","gesture"]},{emoji:"\ud83e\udd1e\ud83c\udffb",keywords:["crossed fingers","luck","hand","gesture"]},{emoji:"\ud83d\udd90\ud83c\udffb",keywords:["raised hand","hi","hand","gesture"]},{emoji:"\ud83e\udd1a\ud83c\udffb",keywords:["raised back hand","hi","hand","gesture"]},{emoji:"\ud83d\udd96\ud83c\udffb",keywords:["vulcan salute","hand","gesture","Spock"]},{emoji:"\ud83d\udc4b\ud83c\udffb",keywords:["waving hand","hello","goodbye","gesture"]},{emoji:"\ud83d\udc4f\ud83c\udffb",keywords:["clapping hands","applause","gesture"]},{emoji:"\ud83d\ude4c\ud83c\udffb",keywords:["raising hands","praise","gesture"]},{emoji:"\ud83d\udc50\ud83c\udffb",keywords:["open hands","gesture","offering"]},{emoji:"\ud83e\udd32\ud83c\udffb",keywords:["palms up together","offering","asking"]},{emoji:"\ud83e\udd1d\ud83c\udffb",keywords:["handshake","agreement","partnership","gesture"]},{emoji:"\ud83d\ude4f\ud83c\udffb",keywords:["folded hands","prayer","thanks","gesture"]},{emoji:"\u270b\ud83c\udffb",keywords:["raised hand","stop","gesture"]},{emoji:"\u27a1\ufe0f",keywords:["right arrow","direction","next"]},{emoji:"\u2b05\ufe0f",keywords:["left arrow","direction","previous"]},{emoji:"\u2b06\ufe0f",keywords:["up arrow","direction","above"]},{emoji:"\u2b07\ufe0f",keywords:["down arrow","direction","below"]},{emoji:"\u2194\ufe0f",keywords:["left-right arrow","direction"]},{emoji:"\u2195\ufe0f",keywords:["up-down arrow","direction"]},{emoji:"\ud83d\udd3c",keywords:["up triangle","arrow","direction"]},{emoji:"\ud83d\udd3d",keywords:["down triangle","arrow","direction"]},{emoji:"\ud83d\udd3b",keywords:["red down triangle","arrow","direction"]},{emoji:"\ud83d\udd3a",keywords:["red up triangle","arrow","direction"]},{emoji:"\u26ab",keywords:["black circle","bullet","point"]},{emoji:"\ud83d\udd34",keywords:["red circle","bullet","point"]},{emoji:"\ud83d\udd35",keywords:["blue circle","bullet","point"]},{emoji:"\ud83d\udfe2",keywords:["green circle","bullet","point"]},{emoji:"\ud83d\udfe1",keywords:["yellow circle","bullet","point"]},{emoji:"\ud83d\udfe3",keywords:["purple circle","bullet","point"]},{emoji:"\ud83d\udfe0",keywords:["orange circle","bullet","point"]},{emoji:"\ud83d\udfe4",keywords:["brown circle","bullet","point"]},{emoji:"\ud83d\udd38",keywords:["orange diamond","bullet"]},{emoji:"\ud83d\udd39",keywords:["blue diamond","bullet"]},{emoji:"\u2666\ufe0f",keywords:["diamonds","card suit"]},{emoji:"\u2665\ufe0f",keywords:["hearts","card suit"]},{emoji:"\u2663\ufe0f",keywords:["clubs","card suit"]},{emoji:"\u2660\ufe0f",keywords:["spades","card suit"]},{emoji:"\ud83d\udd32",keywords:["black square","bullet","point"]},{emoji:"\ud83d\udd33",keywords:["white square","bullet","point"]},{emoji:"\u25aa\ufe0f",keywords:["small black square","bullet"]},{emoji:"\u25ab\ufe0f",keywords:["small white square","bullet"]},{emoji:"\u25aa",keywords:["large black square","bullet"]},{emoji:"\u25ab",keywords:["large white square","bullet"]},{emoji:"\ud83d\udd18",keywords:["radio button","bullet","point"]},{emoji:"\u2b50",keywords:["star","highlight","point"]},{emoji:"\ud83d\udca0",keywords:["diamond shape","point"]},{emoji:"\u2733\ufe0f",keywords:["eight-pointed star","highlight","bullet"]},{emoji:"\u2747\ufe0f",keywords:["sparkle","highlight","point"]},{emoji:"\u2764\ufe0f",keywords:["love","heart","red","passion","valentine"]},{emoji:"\ud83d\udc9b",keywords:["love","heart","yellow","friendship","sunshine"]},{emoji:"\ud83d\udc9a",keywords:["love","heart","green","environment","jealousy"]},{emoji:"\ud83d\udc99",keywords:["love","heart","blue","calm","loyalty"]},{emoji:"\ud83d\udc9c",keywords:["love","heart","purple","royalty","romance"]},{emoji:"\ud83d\udda4",keywords:["love","heart","black","mystery","gothic"]},{emoji:"\ud83d\udc94",keywords:["broken","heartbreak","sad","love"]},{emoji:"\u2763\ufe0f",keywords:["exclamation","heart","love","emotion"]},{emoji:"\ud83d\udc95",keywords:["two hearts","love","affection","romance"]},{emoji:"\ud83d\udc9e",keywords:["revolving hearts","love","romance","affection"]},{emoji:"\ud83d\udc93",keywords:["beating heart","love","heartbeat","emotion"]},{emoji:"\ud83d\udc97",keywords:["growing heart","love","affection","emotion"]},{emoji:"\ud83d\udc96",keywords:["sparkling heart","love","affection","emotion"]},{emoji:"\ud83d\udc98",keywords:["heart with arrow","love","cupid","valentine"]},{emoji:"\ud83d\udc9d",keywords:["heart with ribbon","love","gift","present"]},{emoji:"\ud83d\udc9f",keywords:["heart decoration","love","affection","decoration"]},{emoji:"\u262e\ufe0f",keywords:["peace","symbol","pacifism"]},{emoji:"\u271d\ufe0f",keywords:["cross","christianity","religion","faith"]},{emoji:"\u262a\ufe0f",keywords:["star","crescent","islam","religion"]},{emoji:"\ud83d\udd49\ufe0f",keywords:["om","hinduism","religion","chant"]},{emoji:"\u2638\ufe0f",keywords:["wheel of dharma","buddhism","religion","spirituality"]},{emoji:"\u2721\ufe0f",keywords:["star of david","judaism","religion"]},{emoji:"\ud83d\udd2f",keywords:["star","hexagram","religion","jewish"]},{emoji:"\ud83d\udd4e",keywords:["menorah","hanukkah","religion","jewish"]},{emoji:"\u262f\ufe0f",keywords:["yin","yang","balance","taoism"]},{emoji:"\u2626\ufe0f",keywords:["orthodox cross","christianity","religion","faith"]},{emoji:"\ud83d\uded0",keywords:["place of worship","religion","faith","prayer"]},{emoji:"\u26ce",keywords:["ophiuchus","zodiac","astrology","sign"]},{emoji:"\u2648",keywords:["aries","zodiac","astrology","sign"]},{emoji:"\u2649",keywords:["taurus","zodiac","astrology","sign"]},{emoji:"\u264a",keywords:["gemini","zodiac","astrology","sign"]},{emoji:"\u264b",keywords:["cancer","zodiac","astrology","sign"]},{emoji:"\u264c",keywords:["leo","zodiac","astrology","sign"]},{emoji:"\u264d",keywords:["virgo","zodiac","astrology","sign"]},{emoji:"\u264e",keywords:["libra","zodiac","astrology","sign"]},{emoji:"\u264f",keywords:["scorpio","zodiac","astrology","sign"]},{emoji:"\u2650",keywords:["sagittarius","zodiac","astrology","sign"]},{emoji:"\u2651",keywords:["capricorn","zodiac","astrology","sign"]},{emoji:"\u2652",keywords:["aquarius","zodiac","astrology","sign"]},{emoji:"\u2653",keywords:["pisces","zodiac","astrology","sign"]},{emoji:"\ud83c\udd94",keywords:["ID","identification","label"]},{emoji:"\u269b\ufe0f",keywords:["atom","science","chemistry"]},{emoji:"\ud83c\ude51",keywords:["acceptable","kanji","japanese"]},{emoji:"\u2622\ufe0f",keywords:["radioactive","hazard","warning"]},{emoji:"\u2623\ufe0f",keywords:["biohazard","hazard","warning"]},{emoji:"\ud83d\udcf4",keywords:["mobile","off","phone"]},{emoji:"\ud83d\udcf3",keywords:["mobile","vibration","mode"]},{emoji:"\ud83c\ude36",keywords:["have","kanji","japanese"]},{emoji:"\ud83c\ude1a",keywords:["free","not","kanji"]},{emoji:"\ud83c\ude37\ufe0f",keywords:["monthly","kanji","japanese"]},{emoji:"\ud83c\ude38",keywords:["application","kanji","japanese"]},{emoji:"\ud83c\ude3a",keywords:["open","kanji","japanese"]},{emoji:"\ud83c\ude2f",keywords:["reserved","kanji","japanese"]},{emoji:"\u3299\ufe0f",keywords:["secret","kanji","japanese"]},{emoji:"\u3297\ufe0f",keywords:["congratulations","kanji","japanese"]},{emoji:"\ud83c\ude34",keywords:["passing","kanji","japanese"]},{emoji:"\ud83c\ude35",keywords:["full","kanji","japanese"]},{emoji:"\ud83c\ude39",keywords:["discount","kanji","japanese"]},{emoji:"\ud83c\ude32",keywords:["prohibited","kanji","japanese"]},{emoji:"\ud83c\udd70\ufe0f",keywords:["A","blood type","letter"]},{emoji:"\ud83c\udd71\ufe0f",keywords:["B","blood type","letter"]},{emoji:"\ud83c\udd8e",keywords:["AB","blood type","letter"]},{emoji:"\ud83c\udd91",keywords:["CL","clear","letter"]},{emoji:"\ud83c\udd7e\ufe0f",keywords:["O","blood type","letter"]},{emoji:"\ud83c\udd98",keywords:["SOS","help","emergency"]},{emoji:"\u26d4",keywords:["no","entry","forbidden","stop"]},{emoji:"\ud83d\udcdb",keywords:["badge","label","name"]},{emoji:"\ud83d\udeab",keywords:["no","prohibited","forbidden"]},{emoji:"\ud83d\udcaf",keywords:["100","score","perfect"]},{emoji:"\ud83d\udd1e",keywords:["18","age","restriction"]},{emoji:"\ud83c\udd7f\ufe0f",keywords:["P","parking","letter"]},{emoji:"\ud83c\udd93",keywords:["free","available","letter"]},{emoji:"\u267b\ufe0f",keywords:["recycle","environment","symbol"]},{emoji:"\u203c\ufe0f",keywords:["exclamation","mark","important"]},{emoji:"\u2049\ufe0f",keywords:["exclamation","question","confusion"]},{emoji:"\u2757",keywords:["exclamation","mark"]},{emoji:"\u2755",keywords:["white exclamation","mark"]},{emoji:"\u2753",keywords:["question","mark"]},{emoji:"\u2754",keywords:["white question","mark"]},{emoji:"\ud83d\udd05",keywords:["dim","brightness","low"]},{emoji:"\ud83d\udd06",keywords:["bright","brightness","high"]},{emoji:"\u303d\ufe0f",keywords:["part alternation","mark"]},{emoji:"\u269c\ufe0f",keywords:["fleur-de-lis"]},{emoji:"\ud83d\udd31",keywords:["trident","emblem","symbol"]},{emoji:"\u26a0\ufe0f",keywords:["warning","caution"]},{emoji:"\ud83d\udeb8",keywords:["children","crossing","school"]},{emoji:"\ud83d\udd30",keywords:["beginner","japanese"]},{emoji:"\u267f",keywords:["wheelchair","accessible","disability"]},{emoji:"\ud83d\udead",keywords:["no smoking","cigarette","prohibited"]}]};var se=a(44414);const oe=function(e){let{onSelect:t}=e;const[a,s]=(0,r.useState)(""),o=r.useMemo(()=>Object.entries(re).reduce((e,t)=>{let[r,s]=t;const o=s.filter(e=>e.keywords.some(e=>e.toLowerCase().includes(a.toLowerCase())));return o.length>0&&(e[r]=o),e},{}),[a]);return(0,se.jsxs)("div",{className:"emoji-picker",children:[(0,se.jsx)("input",{type:"text",placeholder:"Search...",value:a,onChange:e=>s(e.target.value),className:"emoji-search"}),(0,se.jsx)("div",{className:"emoji-categories",children:Object.entries(o).map(e=>{let[a,r]=e;return(0,se.jsxs)("div",{className:"emoji-category",children:[(0,se.jsx)("h3",{className:"emoji-category-title",children:a}),(0,se.jsx)("div",{className:"emoji-list",children:r.map((e,a)=>(0,se.jsx)("span",{onClick:()=>t(e.emoji),title:e.keywords.join(", "),className:"emoji-item",children:e.emoji},a))})]},a)})})]})};function le(e,t){const a=e.selectionStart,r=e.selectionEnd;e.setRangeText(t,a,r,"end")}const ie=function(e){let{message:t,onChange:a,onClick:s,minLength:o=2,maxLength:l=1500,placeHolder:i}=e;const[n,d]=r.useState(t),[c,m]=r.useState(!1),u=r.useRef(null);(0,r.useEffect)(()=>{u.current&&(u.current.style.height="auto",u.current.style.height="".concat(u.current.scrollHeight+2,"px"))},[n]);const p=e=>{d(e.target.value),a(e.target.value)},h=e=>{const t=u.current;let a="";switch(e){case"bold":a="*".concat(t.value.substring(t.selectionStart,t.selectionEnd),"*");break;case"italic":a="_".concat(t.value.substring(t.selectionStart,t.selectionEnd),"_");break;case"strikethrough":a="~".concat(t.value.substring(t.selectionStart,t.selectionEnd),"~");break;case"bullet":a="\u2022 ".concat(t.value.substring(t.selectionStart,t.selectionEnd));break;case"numbered":a="\n1. ".concat(t.value.substring(t.selectionStart,t.selectionEnd))}le(t,a),p({target:t})};return(0,se.jsxs)("div",{className:"message-editor",title:"Message",children:[(0,se.jsxs)("div",{className:"toolbar",children:[(0,se.jsx)("button",{title:"Bold","data-format":"bold",onClick:()=>h("bold"),children:"B"}),(0,se.jsx)("button",{title:"Italic","data-format":"italic",onClick:()=>h("italic"),children:"I"}),(0,se.jsx)("button",{title:"Strikethrough","data-format":"strikethrough",onClick:()=>h("strikethrough"),children:"S"}),(0,se.jsx)("button",{title:"Bullet","data-format":"bullet",onClick:()=>h("bullet"),children:"\u26ab"}),(0,se.jsx)("button",{title:"Numbered","data-format":"numbered",onClick:()=>h("numbered"),children:"\ud83d\udd22"}),(0,se.jsx)("button",{title:"Smiley","data-format":"smiley",onClick:()=>m(e=>!e),children:"\ud83d\ude00"})]}),(0,se.jsx)("textarea",{ref:u,value:n,onChange:p,placeholder:i,onClick:s,className:"nodrag rounded-md",onBlur:e=>{d(e.target.value),a(e.target.value)},minLength:o,maxLength:l}),c&&(0,se.jsx)(oe,{onSelect:e=>{const t=u.current;le(t,e),p({target:t})}})]})},ne=e=>{let{value:t,onChange:a,maxLength:r=2}=e;return(0,se.jsxs)("div",{className:"flex items-center gap-1",title:"Delay (seconds)",children:[(0,se.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",className:"text-gray-400",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.5"}),(0,se.jsx)("path",{d:"M12 6v6l4 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),(0,se.jsx)("input",{type:"text",value:t||"",onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,"").slice(0,r);a("delay",t)},placeholder:"0",maxLength:r,className:"nodrag w-7 px-1 text-center text-xs border border-gray-600 bg-gray-700 text-white rounded focus:outline-none focus:border-blue-500",title:"Delay in seconds"})]})},de=e=>{let{data:t}=e;const{node:a,handleChange:s,onDelete:i,setNodes:n}=t,[d,c]=(0,r.useState)(!1),m=(0,r.useRef)(null),u=(0,r.useCallback)(()=>{n(e=>e.map(e=>e.selected?(0,o.A)((0,o.A)({},e),{},{selected:!1}):e))},[n]),p=(0,r.useCallback)(e=>{m.current&&!m.current.contains(e.target)&&c(!1)},[]);return(0,r.useEffect)(()=>(document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)),[p]),(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{ref:m,className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(a.data.errors&&Object.keys(a.data.errors).length?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Message"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:a.data.delay,onChange:(e,t)=>{delete a.data.errors;const r=(0,o.A)((0,o.A)({},a.data),{},{[e]:t});s(a.id,r)}}),(0,se.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",title:"Delete Message Node",onClick:e=>{e.stopPropagation(),i(a.id)},children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3 min-w-36",children:[d?(0,se.jsx)(ie,{message:a.data.message,onChange:e=>{delete a.data.errors;const t=(0,o.A)((0,o.A)({},a),{},{data:(0,o.A)((0,o.A)({},a.data),{},{message:e})});s(a.id,t.data)},onClick:u}):(0,se.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",onDoubleClick:()=>{c(!0),u()},title:"Double Click ro Enter/Edit the Message",children:[(0,se.jsx)("span",{children:a.data.message||"Enter your message"}),(0,se.jsx)("svg",{className:"w-4 h-4 text-white ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"})})]}),a.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:a.data.errors.message})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},ce=(0,r.memo)(de),me=e=>{let{data:t,id:a}=e;const{onDelete:r}=t;return(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Lead Form"}),(0,se.jsx)("button",{title:"Delete Lead Form Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",onClick:()=>r(a),children:"\xd7"})]}),(0,se.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3",children:(0,se.jsx)("p",{className:"nodrag",children:"This will display lead form for the visitor"})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},ue=(0,r.memo)(me),pe=e=>{let{data:t,id:a}=e;const{onDelete:r}=t;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:(0,se.jsxs)("div",{className:"flex justify-between items-center pb-2 py-2 px-4",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Lead Flow"}),(0,se.jsx)("button",{title:"Delete Lead Flow Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",onClick:()=>r(a),children:"\xd7"})]})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},he=(0,r.memo)(pe);a(4064);const xe=e=>{let{data:t,id:a}=e;const{onDelete:r}=t;return(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"GPT Handler"}),(0,se.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",title:"Delete GPT Handler Node",onClick:()=>r(a),children:"\xd7"})]}),(0,se.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3",children:(0,se.jsx)("p",{className:"nodrag",children:"From here on visitors would be handled by GPT"})}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},ge=(0,r.memo)(xe),ye=e=>{let{data:t,id:a}=e;const{onDelete:r,stop:s}=t;return(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Stop"}),(0,se.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",title:"Delete Stop Node",onClick:()=>r(a),children:"\xd7"})]}),(0,se.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3 min-w-36",children:s||"The chat will stop here"}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},be=e=>{let{data:t}=e;const{message:a}=t.node.data;return(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white p-2 rounded-md shadow-lg",children:[(0,se.jsx)("div",{className:"custom-node-body text-center",children:a}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},we=(0,r.memo)(be);var ve=a(10226),je=a(63464),fe=a(88060),ke=a(83239),Ne=a(82053),Ae=a(25333),Ce=a(96319),Te=a(48205),Ee=a(22942);const Me=r.forwardRef(function(e,t){return(0,se.jsx)(Te.A,(0,o.A)({direction:"up",ref:t},e))}),Le=e=>{let{selectedFiles:t,setSelectedFiles:a,closeDialog:s,openDialog:o,mimeType:l,updateAssignedFiles:i}=e;const[n,d]=(0,r.useState)([]);(0,r.useEffect)(()=>{o&&s(!0)},[o]);const c=()=>{s(!1)};return(0,se.jsx)("div",{children:(0,se.jsxs)(je.A,{fullScreen:!0,open:o,onClose:c,TransitionComponent:Me,children:[(0,se.jsx)(fe.A,{sx:{position:"relative"},children:(0,se.jsxs)(ke.A,{children:[(0,se.jsx)(Ae.A,{edge:"start",color:"inherit",onClick:c,"aria-label":"close",children:(0,se.jsx)(Ce.A,{})}),(0,se.jsx)(Ne.A,{sx:{ml:2,flex:1},variant:"h4",component:"div",children:"Upload OR Select Files"}),(0,se.jsx)(ve.A,{autoFocus:!0,color:"inherit",onClick:()=>{const e=n.filter(e=>e.isSelected);a(e),c(),i(e)},children:"Save Selected"})]})}),(0,se.jsx)("div",{className:"p-4",children:(0,se.jsx)(Ne.A,{variant:"body1",children:(0,se.jsx)(Ee.default,{mimeType:l,selectedFiles:t,handleSelection:e=>{d(e)}})})})]})})};var Fe=a(80045);const Se=["alt","src","sx","children"],Ie=["avatar","label","icon","deleteIcon","onClick","onDelete","variant","size","sx","title"],De={borderRadius:"50%",display:"inline-flex",alignItems:"center",justifyContent:"center",overflow:"hidden",backgroundColor:"#e0e0e0",color:"#555",fontSize:20},Oe=e=>{var t;let{alt:a,src:r,sx:s,children:l}=e,i=(0,Fe.A)(e,Se);return(0,se.jsx)("div",(0,o.A)((0,o.A)({style:(0,o.A)((0,o.A)({},De),s)},i),{},{children:r?(0,se.jsx)("img",{src:r,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{var t;e.target.style.display="none",e.target.parentElement.textContent=(null===a||void 0===a?void 0:a[0])||(null===l||void 0===l||null===(t=l.toString())||void 0===t?void 0:t[0])||""}}):(null===a||void 0===a?void 0:a[0])||(null===l||void 0===l||null===(t=l.toString())||void 0===t?void 0:t[0])||""}))},Be=e=>{let{avatar:t,label:a,icon:r,deleteIcon:s,onClick:l,onDelete:i,variant:n="filled",size:d="medium",sx:c,title:m}=e,u=(0,Fe.A)(e,Ie);const p=(0,o.A)({display:"inline-flex",alignItems:"center",padding:"small"===d?"0 8px":"0 12px",fontSize:"small"===d?11:13,height:"small"===d?28:32,background:"outlined"===n?"transparent":"#e0e0e0",border:"outlined"===n?"1px solid #bdbdbd":"none",cursor:l?"pointer":"default"},c);return(0,se.jsxs)("div",(0,o.A)((0,o.A)({style:p,onClick:l,title:m},u),{},{children:[t&&(0,se.jsx)("span",{style:{marginRight:6,display:"flex",alignItems:"center"},children:t}),r&&(0,se.jsx)("span",{style:{marginRight:6,display:"flex",alignItems:"center"},children:r}),a&&(0,se.jsx)("span",{style:{marginRight:s?6:0},children:a}),s&&i&&(0,se.jsx)("span",{style:{marginLeft:6,display:"flex",alignItems:"center",cursor:"pointer"},onClick:e=>{e.stopPropagation(),i(e)},children:s})]}))};var Pe=a(57988);const He=e=>{switch(e){case"pdf":case"application/pdf":default:return"application/pdf";case"images":case"image":case"image/*":return"image/*";case"video":case"video/*":return"video/*"}},ze=e=>{var t,a,s,i;let{id:n,data:d}=e;const{node:c,onDelete:m,handleChange:u}=d;c.data.fileType=He(c.data.fileType);const[p,h]=(0,r.useState)({}),[x,g]=(0,r.useState)(c.data.fileType),[y,b]=(0,r.useState)(!1),[w,v]=(0,r.useState)((null===(t=c.data.files)||void 0===t?void 0:t.length)>0?c.data.files:[]),j=(e,t)=>{let a="";"message"===e&&(t?t.length<3?a="Message must be at least 3 characters":t.length>500&&(a="Message must be at most 500 characters"):a="Message is required"),!a&&("files"===e||"urls"===e)&&c.data.files.length<=0&&c.data.urls.length<=0&&(a="Either Files or Image URLs are mandatory"),h(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},f=(e,t)=>{delete c.data.errors;const a=(0,o.A)((0,o.A)({},c.data),{},{[e]:t});if(u(c.id,a),c.data=a,"fileType"===e){const e=He(t);g(e),c.data.files=[],v([])}};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(c.data.errors&&Object.keys(c.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"File Upload"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:c.data.delay,onChange:f}),(0,se.jsx)("button",{title:"Delete File Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>m(n),children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)(ie,{message:c.data.message,onChange:e=>f("message",e),maxLength:500,minLength:2}),c.data.errors&&(null===(a=Object.keys(c.data.errors))||void 0===a?void 0:a.length)>0&&c.data.errors.message&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.message})]}),(0,se.jsxs)("div",{className:"mb-2",title:"Select File Type",children:[(0,se.jsxs)("select",{value:c.data.fileType,onChange:e=>f("fileType",e.target.value),onBlur:e=>j("fileType",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select File Type"}),(0,se.jsx)("option",{value:"application/pdf",children:"PDF"}),(0,se.jsx)("option",{value:"image/*",children:"Images"}),(0,se.jsx)("option",{value:"video/*",children:"Video"})]}),c.data.errors&&(null===(s=Object.keys(c.data.errors))||void 0===s?void 0:s.length)>0&&c.data.errors.fileType&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.fileType})]}),w&&(0,se.jsx)("div",{className:"d-flex space-y-1",children:w.map((e,t)=>(0,se.jsx)(Be,{title:e.name,avatar:(0,se.jsx)(Oe,{alt:e.name,src:e.url}),label:e.name,onClick:()=>{return t=e.url,void window.open(t);var t},onDelete:()=>(e=>{const t=w.filter(t=>t.url!==e.url);v(t),c.data.files=t})(e),deleteIcon:(0,se.jsx)(Pe.A,{}),variant:"outlined"},t))}),(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)("button",{title:"Click to Select/Add Files",disabled:!c.data.fileType||c.data.urls.length>0,type:"button",onClick:()=>{b(!0)},className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",children:"Add Files"})}),(0,se.jsxs)("div",{className:"mb-1",title:"URLs",children:[c.data.urls.map((e,t)=>{var a;return(0,se.jsxs)("div",{className:"flex items-center mb-1",children:[(0,se.jsx)("input",{type:"text",placeholder:"URL",value:e,onChange:e=>((e,t)=>{const a=c.data.urls.map((a,r)=>r===e?t:a);f("urls",a)})(t,e.target.value),onBlur:e=>j("urls",e.target.value),disabled:c.data.files.length>0,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),(0,se.jsx)("button",{type:"button",onClick:()=>(e=>{const t=c.data.urls.filter((t,a)=>a!==e);f("urls",t)})(t),className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-4 w-4 px-1 flex items-center justify-center text-sm font-extrabold ml-2",children:"\xd7"}),c.data.errors&&(null===(a=Object.keys(c.data.errors))||void 0===a?void 0:a.length)>0&&c.data.errors.fileOrUrl&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.fileOrUrl})]},t)}),(0,se.jsxs)("button",{title:"Click to add Image Url's",type:"button",onClick:()=>{f("urls",[...c.data.urls,""])},disabled:w.length>0,className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),c.data.urls.length>0?"Add More":"Add Url"]}),p.urls&&!c.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:p.urls}),c.data.errors&&(null===(i=Object.keys(c.data.errors))||void 0===i?void 0:i.length)>0&&c.data.errors.fileOrUrl&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.fileOrUrl})]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),y&&(0,se.jsx)(Le,{selectedFiles:w,setSelectedFiles:v,openDialog:y,closeDialog:b,mimeType:x,updateAssignedFiles:e=>{c.data.files=e}})]})},Ue=(0,r.memo)(ze),We=e=>{var t,a,r,s,i;let{id:n,data:d}=e;const{node:c,onDelete:m,handleChange:u}=d,p=(e,t)=>{delete c.data.errors;const a=(0,o.A)((0,o.A)({},c.data),{},{[e]:t});u(c.id,a)};return(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(null!==(t=c.data)&&void 0!==t&&t.errors&&Object.keys(c.data.errors).length?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Google Maps"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:c.data.delay,onChange:p}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>m(n),children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"py-2 px-2",children:[(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)(ie,{maxLength:500,message:c.data.message,onChange:e=>p("message",e)}),(null===(a=c.data)||void 0===a||null===(r=a.errors)||void 0===r?void 0:r.message)&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.message})]}),(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)("input",{title:"Map Url",type:"text",value:c.data.url,onChange:e=>p("url",e.target.value),placeholder:"Google Maps URL",className:"nodrag w-full p-1 rounded-md border border-gray-600 bg-gray-700 text-white"}),(null===(s=c.data)||void 0===s||null===(i=s.errors)||void 0===i?void 0:i.url)&&(0,se.jsx)("small",{className:"text-red-500",children:c.data.errors.url})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},_e=(0,r.memo)(We);var Re=a(16497),qe=a(37324),Ve=a(70855),Xe=a(97278);const Ge=e=>{var t;let{optionsData:a,save:s,close:l}=e;const[,{botSettings:i}]=(0,Ve.G)(),[n,d]=(0,r.useState)(a),[c,m]=(0,r.useState)({});(0,r.useEffect)(()=>{d(e=>(0,o.A)((0,o.A)({},e),{},{subOptions:n.dataSource?[a.subOptions[0]]:a.subOptions}))},[a,n.dataSource]);const u=e=>{const{name:t,value:a}=e.target;d((0,o.A)((0,o.A)({},n),{},{[t]:a}))},p=(e,t,a)=>{if("googleTagManagerPayload"!==t||!a&&0!==a){if(d((0,o.A)((0,o.A)({},n),{},{message:e})),t&&(a||0==a)){const r=[...n.subOptions],s=(0,o.A)({},r[a]);s[t]=e,r[a]=s,d((0,o.A)((0,o.A)({},n),{},{subOptions:r}))}}else{const t=[...n.subOptions],r=(0,o.A)({},t[a]);r.googleTagManagerPayload=e,t[a]=r,d((0,o.A)((0,o.A)({},n),{},{subOptions:t}))}},x=(e,t,a)=>{const r=q(e,t);if(m(t=>(0,o.A)((0,o.A)({},t),{},{[e]:r})),!r&&"googleTagManagerPayload"===e&&(a||0===a))try{const e=new Function("return (".concat(t,")"))(),r=[...n.subOptions],s=(0,o.A)({},r[a]);s.googleTagManagerPayload=e,r[a]=s,d((0,o.A)((0,o.A)({},n),{},{subOptions:r}))}catch(s){}},g=(e,t,a)=>{const r=q(t,a);m(a=>{var s;return(0,o.A)((0,o.A)({},a),{},{subOptions:(0,o.A)((0,o.A)({},a.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(s=a.subOptions)||void 0===s?void 0:s[e]),{},{[t]:r})})})})},y=(e,t)=>{const{name:a,value:r}=t.target,s=[...n.subOptions],l=(0,o.A)({},s[e]);l[a]=r,s[e]=l,d((0,o.A)((0,o.A)({},n),{},{subOptions:s}))},b=(e,t)=>{const a=n.subOptions.find(t=>t.id===e);a&&(B(t)?a.leadEmailTo.includes(t)?m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"This email is already in Lead Email To."})})})}):(d((0,o.A)((0,o.A)({},n),{},{subOptions:n.subOptions.map(a=>a.id===e?(0,o.A)((0,o.A)({},a),{},{leadEmailCc:[...a.leadEmailCc,t]}):a)})),m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})})):m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})}))},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!e)return null;const a=Xe.KD[e];return a?(0,se.jsx)(a,{size:t,className:"text-blue-400"}):null};return(0,se.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,se.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,se.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,se.jsx)("h5",{className:"modal-title text-lg font-bold",children:"Edit Options"}),(0,se.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:l,children:"\xd7"})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 mt-16 mb-20",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 mb-4",children:[(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Display Text"}),(0,se.jsx)("input",{title:"fieldLabel",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fieldLabel",value:n.fieldLabel,onChange:u,onBlur:e=>x("fieldLabel",e.target.value)}),c.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:c.fieldLabel})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Property Name"}),(0,se.jsx)("input",{title:"Property",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"property",value:n.property,onChange:u,onBlur:e=>x("property",e.target.value)}),c.property&&(0,se.jsx)("small",{className:"text-red-500",children:c.property})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Message"}),(0,se.jsx)(ie,{maxLength:300,message:n.message,onChange:e=>p(e),onBlur:e=>x("message",e)}),c.message&&(0,se.jsx)("small",{className:"text-red-500",children:c.message})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Fall back"}),(0,se.jsx)("input",{title:"Fallback",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fallback",value:n.fallback,onChange:u,onBlur:e=>x("fallback",e.target.value)}),c.fallback&&(0,se.jsx)("small",{className:"text-red-500",children:c.fallback})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Data Source"}),(0,se.jsx)("input",{title:"DataSource",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"dataSource",value:n.dataSource,onChange:u,onBlur:e=>x("dataSource",e.target.value)}),c.dataSource&&(0,se.jsx)("small",{className:"text-red-500",children:c.dataSource})]})})]}),null===(t=n.subOptions)||void 0===t?void 0:t.map((e,t)=>{var a,r,s,l,u,h,v,j,f,k,N,A,C,T,E,M,L,F,S,I,D,O,P,H;return(0,se.jsxs)("div",{className:"accordion px-2 mb-2",children:[(0,se.jsxs)("div",{className:"accordion-header flex items-center p-1 cursor-pointer border border-gray-600 rounded bg-gray-800 hover:bg-gray-700 transition-colors",onClick:()=>(e=>{const t=n.subOptions.map((t,a)=>a===e?(0,o.A)((0,o.A)({},t),{},{isCollapsed:!t.isCollapsed}):t);d((0,o.A)((0,o.A)({},n),{},{subOptions:t}))})(t),children:[(0,se.jsx)("span",{className:"mr-3",children:e.isCollapsed?(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,se.jsxs)("div",{className:"flex items-center flex-1",children:[e.selectedMOG&&(0,se.jsx)("span",{className:"mr-2",children:w(e.selectedMOG)}),(0,se.jsx)("span",{children:e.title||"Sub Option ".concat(t+1)})]}),n.subOptions.length>1&&(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold ml-4",onClick:e=>{e.stopPropagation(),(e=>{d((0,o.A)((0,o.A)({},n),{},{subOptions:n.subOptions.filter((t,a)=>a!==e)}))})(t)},children:"\xd7"})]}),!e.isCollapsed&&(0,se.jsxs)("div",{className:"accordion-content bg-gray-700 p-2 rounded",children:[(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)(Re.A,{control:(0,se.jsx)(qe.A,{name:"isLink",checked:e.isLink,onChange:e=>((e,t)=>{y(e,(0,o.A)((0,o.A)({},t),{},{target:{name:t.target.name,value:t.target.checked}}))})(t,e),color:"primary",sx:{"& .MuiSwitch-thumb":{fontSize:24}}}),label:"Link",className:"text-white cursor-pointer"})}),(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Select Icon (MOG)"}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)("select",{title:"Select MOG",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",value:e.selectedMOG||"",onChange:e=>((e,t)=>{const{value:a}=t.target,r=[...n.subOptions];r[e].selectedMOG=a,d((0,o.A)((0,o.A)({},n),{},{subOptions:r}))})(t,e),style:{height:"32px"},children:Xe.aN.map(e=>(0,se.jsx)("option",{value:e.value,children:e.label},e.value))}),e.selectedMOG&&(0,se.jsx)("div",{className:"flex-shrink-0",children:w(e.selectedMOG,24)})]})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Title"}),(0,se.jsx)("input",{title:"Title",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"title",value:e.title,onChange:e=>y(t,e),onBlur:e=>g(t,"title",e.target.value)}),(null===(a=c.subOptions)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.title)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(s=c.subOptions[t])||void 0===s?void 0:s.title})]})}),!e.selectedMOG&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Sub Title"}),(0,se.jsx)("input",{title:"Sub Title",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"subTitle",value:e.subTitle,onChange:e=>y(t,e),onBlur:e=>g(t,"subTitle",e.target.value)}),(null===(l=c.subOptions)||void 0===l||null===(u=l[t])||void 0===u?void 0:u.subTitle)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(h=c.subOptions[t])||void 0===h?void 0:h.subTitle})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:e.isLink?"URL":"Value"}),(0,se.jsx)("input",{title:"Value",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"value",value:e.value,onChange:e=>y(t,e),onBlur:e=>g(t,"value",e.target.value)}),(null===(v=c.subOptions)||void 0===v||null===(j=v[t])||void 0===j?void 0:j.value)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(f=c.subOptions[t])||void 0===f?void 0:f.value})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Image url"}),(0,se.jsx)("input",{title:"Image Url",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"imageUrl",value:e.imageUrl,onChange:e=>y(t,e),onBlur:e=>g(t,"imageUrl",e.target.value)}),(null===(k=c.subOptions)||void 0===k||null===(N=k[t])||void 0===N?void 0:N.imageUrl)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(A=c.subOptions[t])||void 0===A?void 0:A.imageUrl})]})}),!n.dataSource&&!e.isLink&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Select Category"}),(0,se.jsxs)("select",{title:"Select Category",style:{height:"32px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",value:e.category,onChange:e=>((e,t)=>{const{value:a}=t.target,r=[...n.subOptions];r[e].category=a,d((0,o.A)((0,o.A)({},n),{},{subOptions:r}))})(t,e),onBlur:e=>g(t,"category",e.target.value),children:[(0,se.jsx)("option",{value:"",children:"Select Category"}),(0,se.jsx)("option",{value:"preSale",children:"Presale"}),(0,se.jsx)("option",{value:"general",children:"General"}),(0,se.jsx)("option",{value:"others",children:"Others"})]}),(null===(C=c.subOptions)||void 0===C||null===(T=C[t])||void 0===T?void 0:T.category)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(E=c.subOptions[t])||void 0===E?void 0:E.category})]})}),!e.isLink&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Lead Email To"}),(0,se.jsx)("input",{title:"Lead Mail To",autoComplete:"off",maxLength:254,type:"text",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailTo",value:e.leadEmailTo,onChange:e=>y(t,e),onBlur:e=>g(t,"leadEmailTo",e.target.value)}),(null===(M=c.subOptions)||void 0===M||null===(L=M[t])||void 0===L?void 0:L.leadEmailTo)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(F=c.subOptions[t])||void 0===F?void 0:F.leadEmailTo})]})}),!e.isLink&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Lead Email Cc"}),(0,se.jsxs)("div",{className:"flex flex-wrap items-center border border-gray-600 rounded bg-gray-800",children:[e.leadEmailCc.map(t=>(0,se.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 text-sm rounded-full mr-2 mb-2 px-3 py-1",children:[t,(0,se.jsx)("button",{type:"button",onClick:()=>{return a=e.id,r=t,void d((0,o.A)((0,o.A)({},n),{},{subOptions:n.subOptions.map(e=>e.id===a?(0,o.A)((0,o.A)({},e),{},{leadEmailCc:e.leadEmailCc.filter(e=>e!==r)}):e)}));var a,r},className:"ml-2 text-red-500 hover:text-red-700 focus:outline-none",children:"\xd7"})]},t)),(0,se.jsx)("input",{title:"Lead Mail CC",style:{padding:"2px",height:"24px"},autoComplete:"off",placeholder:"Type or paste email addresses and press `Enter`",type:"text",className:"flex-grow border-none text-sm border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailCc",onBlur:e=>g(t,"leadEmailCc",e.target.value),onKeyDown:e=>((e,t)=>{if(["Enter","Tab",","].includes(t.key)){t.preventDefault();const a=t.currentTarget.value.trim();a&&(b(n.subOptions[e].id,a),t.currentTarget.value="")}})(t,e),onPaste:t=>((e,t)=>{t.preventDefault();const a=t.clipboardData.getData("text").split(/[ ,;]/).map(e=>e.trim()).filter(e=>""!==e),r=n.subOptions.find(t=>t.id===e);if(!r)return;if(a.filter(e=>!B(e)).length>0)return void m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})});a.filter(e=>r.leadEmailTo.includes(e)).length>0?m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Some emails are already in Lead Email To"})})})}):(d((0,o.A)((0,o.A)({},n),{},{subOptions:n.subOptions.map(t=>t.id===e?(0,o.A)((0,o.A)({},t),{},{leadEmailCc:[...t.leadEmailCc,...a]}):t)})),m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})}))})(e.id,t)})]}),(null===(S=c.subOptions)||void 0===S||null===(I=S[t])||void 0===I?void 0:I.leadEmailCc)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(D=c.subOptions[t])||void 0===D?void 0:D.leadEmailCc})]})})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 mb-4",children:[(0,se.jsx)("div",{className:"min-w-[200px] m-2",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Description"}),(0,se.jsx)(ie,{maxLength:300,message:e.description,onChange:e=>p(e,"description",t),onBlur:e=>x("description",e)}),(null===(O=c.subOptions)||void 0===O||null===(P=O[t])||void 0===P?void 0:P.description)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(H=c.subOptions[t])||void 0===H?void 0:H.description})]})}),i.urlBasedGoogleAdWordsIds&&(0,se.jsx)("div",{className:"min-w-[200px] m-2",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Google Tag Manager Payload (JSON)"}),(0,se.jsx)("textarea",{rows:6,className:"form-control form-control-sm w-full px-2 py-1 border border-gray-600 bg-gray-700 text-white rounded resize-none",name:"googleTagManagerPayload",value:"object"===typeof e.googleTagManagerPayload?JSON.stringify(e.googleTagManagerPayload,null,2):e.googleTagManagerPayload,onChange:e=>p(e.target.value,"googleTagManagerPayload",t),onBlur:e=>x("googleTagManagerPayload",e.target.value,t)}),c.googleTagManagerPayload&&(0,se.jsx)("small",{className:"text-red-500",children:c.googleTagManagerPayload})]})})]})]})]},t)}),!n.dataSource&&(0,se.jsxs)("button",{className:"flex ml-2 px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{d((0,o.A)((0,o.A)({},n),{},{subOptions:[...n.subOptions,{id:h(),title:"",subTitle:"",imageUrl:"",value:"",category:"",description:"",googleTagManagerPayload:"",selectedMOG:"",isLink:!1,leadEmailTo:"",leadEmailCc:[]}]}))},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]}),(0,se.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,se.jsxs)("div",{className:"modal-footer py-2 px-4 flex justify-start gap-2",children:[(0,se.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{s(n)},children:[(0,se.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save"]}),(0,se.jsx)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{n.subOptions.forEach(e=>{e.isCollapsed=!0}),s(n),l()},children:"Save & Close"})]})})]})},Qe=(0,r.memo)(Ge),Je=e=>{let{subOption:t,index:a,onDelete:r,expandToEdit:s,length:o}=e;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>s(a),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{title:t.title,className:"text-sm grow min-w-0",children:t.title?"".concat(t.title):"Sub Option"})]})}),o>1&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2 w-[25px] w-[25px]",onClick:e=>{e.stopPropagation(),r(a)},children:"\xd7"})})]})})},Ye=(0,r.memo)(Je);var Ze=a(37267),$e=a(45e3);const Ke=["children"],et=e=>{let{children:t}=e,a=(0,Fe.A)(e,Ke);const[s,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{const e=requestAnimationFrame(()=>l(!0));return()=>{cancelAnimationFrame(e),l(!1)}},[]),s?(0,se.jsx)($e.gL,(0,o.A)((0,o.A)({},a),{},{children:t})):null},tt=e=>{let{data:t,id:a}=e;const{node:s,onDelete:i,handleChange:n}=t,[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)({}),[g,y]=(0,r.useState)(s.data),[b,w]=(0,r.useState)(s.data.message),v=(e,t)=>{const a=q(e,t);x(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},j=(e,t)=>{delete s.data.errors;const a=(0,o.A)((0,o.A)({},g),{},{[e]:t});y(a),n(s.id,a)},f=e=>{delete s.data.errors;const t=g.subOptions.filter((t,a)=>a!==e),a=(0,o.A)((0,o.A)({},g),{},{subOptions:t});y(a),n(s.id,a)},k=()=>c(!1),N=e=>{g.subOptions.forEach(e=>{e.isCollapsed=!0}),g.subOptions[e].isCollapsed=!1,c(!0)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(s.data&&s.data.errors&&Object.keys(s.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>u(!m),children:"Option"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:s.data.delay,onChange:j}),(0,se.jsx)("button",{className:"text-gray-400 hover:text-white mr-3",title:"Expand",onClick:()=>c(e=>!e),children:(0,se.jsx)("svg",{className:"w-4 h-4 text-blue-500 cursor-pointer hover:text-blue-700",fill:"white",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 242.133 242.133",children:(0,se.jsx)("path",{id:"XMLID_15_",d:"M227.133,83.033c8.283,0,15-6.716,15-15V15c0-8.284-6.717-15-15-15H174.1c-8.284,0-15,6.716-15,15 s6.716,15,15,15h16.82l-69.854,69.854L51.213,30h16.82c8.284,0,15-6.716,15-15s-6.716-15-15-15H15C6.717,0,0,6.716,0,15v53.033 c0,8.284,6.717,15,15,15c8.285,0,15-6.716,15-15v-16.82l69.854,69.854L30,190.92V174.1c0-8.284-6.715-15-15-15 c-8.283,0-15,6.716-15,15v53.033c0,8.284,6.717,15,15,15h53.033c8.284,0,15-6.716,15-15c0-8.284-6.716-15-15-15h-16.82 l69.854-69.854l69.854,69.854H174.1c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h53.033c8.283,0,15-6.716,15-15V174.1 c0-8.284-6.717-15-15-15c-8.285,0-15,6.716-15,15v16.82l-69.854-69.854l69.854-69.854v16.82 C212.133,76.317,218.848,83.033,227.133,83.033z"})})}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>i(a),children:"\xd7"})]})]}),!m&&(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Field Label",type:"text",maxLength:50,placeholder:"Field Label",value:g.fieldLabel,onChange:e=>j("fieldLabel",e.target.value),onBlur:e=>v("fieldLabel",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:p.fieldLabel})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Property Name",type:"text",maxLength:50,placeholder:"Property Name",value:g.property,onChange:e=>j("property",e.target.value),onBlur:e=>v("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.property&&(0,se.jsx)("small",{className:"text-red-500",children:p.property})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)(ie,{maxLength:300,message:g.message,onChange:e=>j("message",e)},b),p.message&&(0,se.jsx)("small",{className:"text-red-500",children:p.message})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Fall back",type:"text",maxLength:50,value:g.fallback,placeholder:"Fall back",onChange:e=>j("fallback",e.target.value),onBlur:e=>v("fallback",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.fallback&&(0,se.jsx)("small",{className:"text-red-500",children:p.fallback})]}),(0,se.jsx)($e.JY,{onDragEnd:e=>{const{source:t,destination:a}=e;if(!a)return;const r=Array.from(g.subOptions),[l]=r.splice(t.index,1);r.splice(a.index,0,l);const i=(0,o.A)((0,o.A)({},g),{},{subOptions:r});y(i),n(s.id,i)},children:(0,se.jsx)(et,{droppableId:"subOptions",children:e=>(0,se.jsxs)("div",(0,o.A)((0,o.A)({},e.droppableProps),{},{ref:e.innerRef,className:"space-y-2",children:[g.subOptions.map((e,t)=>(0,se.jsxs)("div",{className:"nodrag relative subOption-wrapper",children:[(0,se.jsx)($e.sx,{draggableId:e.id,index:t,children:a=>(0,se.jsx)("div",(0,o.A)((0,o.A)((0,o.A)({ref:a.innerRef},a.draggableProps),a.dragHandleProps),{},{style:(0,o.A)((0,o.A)({},a.draggableProps.style),{},{left:"auto !important",top:"auto !important",width:"100%"}),children:(0,se.jsx)(Ye,{subOption:e,index:t,onDelete:f,length:g.subOptions.length,expandToEdit:N},t)}))},e.id),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:e.id})]},t)),e.placeholder]}))})}),(0,se.jsxs)("button",{className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{delete s.data.errors;const e={id:h(),title:"",subTitle:"",value:"",imageUrl:"",category:"",description:"",googleTagManagerPayload:"",selectedMOG:"",leadEmailTo:"",leadEmailCc:[],isCollapsed:!1,isLink:!1},t=(0,o.A)((0,o.A)({},g),{},{subOptions:[...g.subOptions,e]});y(t),n(s.id,t),c(!0)},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:a}),(0,se.jsx)(Ze.l,{header:"Header",visible:d,style:{width:"100vw"},onHide:()=>{d&&k()},children:(0,se.jsx)(Qe,{save:e=>{const t=(0,o.A)((0,o.A)({},e),{},{subOptions:e.subOptions.map(e=>(0,o.A)({},e))});w(Math.random().toString()),y(t),n(s.id,t)},optionsData:g,close:k})})]})},at=(0,r.memo)(tt),rt=e=>{let{data:t,id:a}=e;const{node:s,onDelete:i,handleChange:n}=t,[,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1),[u,p]=(0,r.useState)(s.data),[,h]=(0,r.useState)(null);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(s.data&&s.data.errors&&Object.keys(s.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>m(!c),children:"Chat Medium"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:s.data.delay,onChange:(e,t)=>{delete s.data.errors;const a=(0,o.A)((0,o.A)({},u),{},{[e]:t});p(a),n(s.id,a)}}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>i(a),children:"\xd7"})]})]}),!c&&(0,se.jsx)("div",{className:"space-y-2 py-2 px-2",children:[{id:"web",value:"Web"},{id:"whatsapp",value:"Whatsapp"}].map((e,t)=>(0,se.jsxs)("div",{className:"nodrag relative subOption-wrapper",children:[(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsx)("div",{className:"flex justify-between items-center cursor-pointer grow",children:(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>(e=>{h(e),d(!0)})(t),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{title:e.value,className:"text-sm grow min-w-0 break-words truncate",children:e.value})]})})})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:e.id})]},e.id))})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:a})]})},st=(0,r.memo)(rt),ot=e=>{var t,a;let{carouselData:s,save:l,close:i}=e;const[n,d]=(0,r.useState)(s),[c,m]=(0,r.useState)({}),[u,p]=(0,r.useState)(0);(0,r.useEffect)(()=>{var e;(null===(e=s.cards)||void 0===e?void 0:e.length)>0&&s.cards[0].postbackTexts&&p(s.cards[0].postbackTexts.length)},[s]);const x=e=>{const{name:t,value:a}=e.target;d((0,o.A)((0,o.A)({},n),{},{[t]:a}))},g=(e,t)=>{const a=te(e,t);m(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},y=(e,t)=>{const{name:a,value:r}=t.target,s=[...n.cards],l=(0,o.A)({},s[e]);l[a]=r,s[e]=l,d((0,o.A)((0,o.A)({},n),{},{cards:s}))},b=(e,t,a)=>{const r=te(t,a);m(a=>{var s;return(0,o.A)((0,o.A)({},a),{},{cards:(0,o.A)((0,o.A)({},a.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(s=a.cards)||void 0===s?void 0:s[e]),{},{[t]:r})})})})},w=(e,t)=>{const a=n.cards.find(t=>t.id===e);var r;a&&(B(t)?a.leadEmailTo.includes(t)?m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:"This email is already in Lead Email To."})})})}):(d((0,o.A)((0,o.A)({},n),{},{cards:null===(r=n.cards)||void 0===r?void 0:r.map(a=>a.id===e?(0,o.A)((0,o.A)({},a),{},{leadEmailCc:[...a.leadEmailCc,t]}):a)})),m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})})):m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})}))};return(0,se.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,se.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,se.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,se.jsx)("h5",{className:"modal-title text-lg font-bold",children:"Edit WhatsApp Carousel"}),(0,se.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:i,children:"\xd7"})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 mt-16 mb-20",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-4",children:[(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Field Label"}),(0,se.jsx)("input",{title:"fieldLabel",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fieldLabel",value:n.fieldLabel||"",onChange:x,onBlur:e=>g("fieldLabel",e.target.value)}),c.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:c.fieldLabel})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Property Name"}),(0,se.jsx)("input",{title:"Property",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"property",value:n.property||"",onChange:x,onBlur:e=>g("property",e.target.value)}),c.property&&(0,se.jsx)("small",{className:"text-red-500",children:c.property})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Card Header Type *"}),(0,se.jsxs)("select",{title:"Card Header Type",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"cardHeaderType",value:n.cardHeaderType||"",onChange:x,onBlur:e=>g("cardHeaderType",e.target.value),style:{height:"32px"},children:[(0,se.jsx)("option",{value:"",children:"Select Header Type"}),(0,se.jsx)("option",{value:"IMAGE",children:"IMAGE"}),(0,se.jsx)("option",{value:"VIDEO",children:"VIDEO"})]}),c.cardHeaderType&&(0,se.jsx)("small",{className:"text-red-500",children:c.cardHeaderType})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"WB Template ID"}),(0,se.jsx)("input",{title:"WB Template ID",type:"text",maxLength:100,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"wbTemplateId",value:n.wbTemplateId||"",onChange:x,onBlur:e=>g("wbTemplateId",e.target.value)}),c.wbTemplateId&&(0,se.jsx)("small",{className:"text-red-500",children:c.wbTemplateId})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Content Params (comma separated)"}),(0,se.jsx)("input",{title:"Content Params",type:"text",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"contentParams",value:n.contentParams?n.contentParams.join(","):"",onChange:e=>{const t=e.target.value.split(",").map(e=>e.trim()).filter(e=>e);d((0,o.A)((0,o.A)({},n),{},{contentParams:t}))},onBlur:e=>g("contentParams",e.target.value)}),c.contentParams&&(0,se.jsx)("small",{className:"text-red-500",children:c.contentParams})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Number of Buttons (0-2)"}),(0,se.jsxs)("select",{title:"Button Count",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",value:u,onChange:e=>(e=>{var t;if(e<0||e>2)return;p(e);const a=null===(t=n.cards)||void 0===t?void 0:t.map(t=>(0,o.A)((0,o.A)({},t),{},{postbackTexts:Array.from({length:e},(e,a)=>{var r;return(null===(r=t.postbackTexts)||void 0===r?void 0:r[a])||{index:a+1,text:""}})}));d((0,o.A)((0,o.A)({},n),{},{cards:a}))})(Number(e.target.value)),style:{height:"32px"},children:[(0,se.jsx)("option",{value:"0",children:"0 Buttons"}),(0,se.jsx)("option",{value:"1",children:"1 Button"}),(0,se.jsx)("option",{value:"2",children:"2 Buttons"})]})]})})]}),null===(t=n.cards)||void 0===t?void 0:t.map((e,t)=>{var a,r,s,l,i,p,h,x,g,v,j,f,k,N,A,C;return(0,se.jsxs)("div",{className:"accordion px-2 mb-2",children:[(0,se.jsxs)("div",{className:"accordion-header flex items-center p-1 cursor-pointer border border-gray-600 rounded bg-gray-800 hover:bg-gray-700 transition-colors",onClick:()=>(e=>{var t;const a=null===(t=n.cards)||void 0===t?void 0:t.map((t,a)=>a===e?(0,o.A)((0,o.A)({},t),{},{isCollapsed:!t.isCollapsed}):t);d((0,o.A)((0,o.A)({},n),{},{cards:a}))})(t),children:[(0,se.jsx)("span",{className:"mr-3",children:e.isCollapsed?(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,se.jsxs)("span",{children:["Card ",t+1]}),(null===(a=n.cards)||void 0===a?void 0:a.length)>1&&(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold ml-auto",onClick:e=>{e.stopPropagation(),(e=>{d((0,o.A)((0,o.A)({},n),{},{cards:n.cards.filter((t,a)=>a!==e)}))})(t)},children:"\xd7"})]}),!e.isCollapsed&&(0,se.jsxs)("div",{className:"accordion-content bg-gray-700 p-2 rounded",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Link *"}),(0,se.jsx)("input",{title:"Link",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"link",value:e.link,onChange:e=>y(t,e),onBlur:e=>b(t,"link",e.target.value)}),(null===(r=c.cards)||void 0===r||null===(s=r[t])||void 0===s?void 0:s.link)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(l=c.cards[t])||void 0===l?void 0:l.link})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Value"}),(0,se.jsx)("input",{title:"Value",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"value",value:e.value,onChange:e=>y(t,e),onBlur:e=>b(t,"value",e.target.value)}),(null===(i=c.cards)||void 0===i||null===(p=i[t])||void 0===p?void 0:p.value)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(h=c.cards[t])||void 0===h?void 0:h.value})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Category"}),(0,se.jsxs)("select",{title:"Category",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"category",value:e.category,onChange:e=>y(t,e),onBlur:e=>b(t,"category",e.target.value),style:{height:"32px"},children:[(0,se.jsx)("option",{value:"",children:"Select Category"}),(0,se.jsx)("option",{value:"preSale",children:"Presale"}),(0,se.jsx)("option",{value:"general",children:"General"}),(0,se.jsx)("option",{value:"others",children:"Others"})]}),(null===(x=c.cards)||void 0===x||null===(g=x[t])||void 0===g?void 0:g.category)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(v=c.cards[t])||void 0===v?void 0:v.category})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Lead Email To"}),(0,se.jsx)("input",{title:"Lead Email To",autoComplete:"off",maxLength:254,type:"text",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailTo",value:e.leadEmailTo,onChange:e=>y(t,e),onBlur:e=>b(t,"leadEmailTo",e.target.value)}),(null===(j=c.cards)||void 0===j||null===(f=j[t])||void 0===f?void 0:f.leadEmailTo)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(k=c.cards[t])||void 0===k?void 0:k.leadEmailTo})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Lead Email Cc"}),(0,se.jsxs)("div",{className:"flex flex-wrap items-center border border-gray-600 rounded bg-gray-800",children:[e.leadEmailCc.map(t=>(0,se.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 text-sm rounded-full mr-2 mb-2 px-3 py-1",children:[t,(0,se.jsx)("button",{type:"button",onClick:()=>((e,t)=>{var a;d((0,o.A)((0,o.A)({},n),{},{cards:null===(a=n.cards)||void 0===a?void 0:a.map(a=>a.id===e?(0,o.A)((0,o.A)({},a),{},{leadEmailCc:a.leadEmailCc.filter(e=>e!==t)}):a)}))})(e.id,t),className:"ml-2 text-red-500 hover:text-red-700 focus:outline-none",children:"\xd7"})]},t)),(0,se.jsx)("input",{title:"Lead Email Cc",style:{padding:"2px",height:"24px"},autoComplete:"off",placeholder:"Type or paste email addresses and press `Enter`",type:"text",className:"flex-grow border-none text-sm border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailCc",onBlur:e=>b(t,"leadEmailCc",e.target.value),onKeyDown:e=>((e,t)=>{if(["Enter","Tab",","].includes(t.key)){t.preventDefault();const a=t.currentTarget.value.trim();a&&(w(n.cards[e].id,a),t.currentTarget.value="")}})(t,e),onPaste:t=>((e,t)=>{var a,r;t.preventDefault();const s=t.clipboardData.getData("text").split(/[ ,;]/).map(e=>e.trim()).filter(e=>""!==e),l=null===(a=n.cards)||void 0===a?void 0:a.find(t=>t.id===e);if(!l)return;if(s.filter(e=>!B(e)).length>0)return void m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})});s.filter(e=>l.leadEmailTo.includes(e)).length>0?m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Some emails are already in Lead Email To"})})})}):(d((0,o.A)((0,o.A)({},n),{},{cards:null===(r=n.cards)||void 0===r?void 0:r.map(t=>t.id===e?(0,o.A)((0,o.A)({},t),{},{leadEmailCc:[...t.leadEmailCc,...s]}):t)})),m(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{cards:(0,o.A)((0,o.A)({},t.cards),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.cards)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})}))})(e.id,t)})]}),(null===(N=c.cards)||void 0===N||null===(A=N[t])||void 0===A?void 0:A.leadEmailCc)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(C=c.cards[t])||void 0===C?void 0:C.leadEmailCc})]})})]}),u>0&&(0,se.jsxs)("div",{className:"mt-4 border-t border-gray-600 pt-4",children:[(0,se.jsx)("h6",{className:"text-md font-semibold mb-2",children:"Buttons (Name will be displayed in node)"}),(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:Array.from({length:u}).map((a,r)=>{var s,l;return(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsxs)("label",{className:"input-label",children:["Button ",r+1," Name"]}),(0,se.jsx)("input",{title:"Button ".concat(r+1," Name"),type:"text",maxLength:100,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",value:(null===(s=e.postbackTexts)||void 0===s||null===(l=s[r])||void 0===l?void 0:l.text)||"",onChange:e=>((e,t,a)=>{const r=[...n.cards],s=(0,o.A)({},r[e]);s.postbackTexts||(s.postbackTexts=[]);const l=[...s.postbackTexts];l[t]={index:t+1,text:a},s.postbackTexts=l,r[e]=s,d((0,o.A)((0,o.A)({},n),{},{cards:r}))})(t,r,e.target.value),placeholder:"Enter name for button ".concat(r+1)})]})},r)})})]})]})]},t)}),(null===(a=n.cards)||void 0===a?void 0:a.length)<10&&(0,se.jsxs)("button",{className:"flex ml-2 px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{var e;if((null===(e=n.cards)||void 0===e?void 0:e.length)>=10)return;const t={id:h(),link:"",value:"",category:"",leadEmailTo:"",leadEmailCc:[],postbackTexts:Array.from({length:u},(e,t)=>({index:t+1,text:""}))};d((0,o.A)((0,o.A)({},n),{},{cards:[...n.cards,t]}))},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add Card"]})]}),(0,se.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,se.jsxs)("div",{className:"modal-footer py-2 px-4 flex justify-start gap-2",children:[(0,se.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded",onClick:()=>{l(n)},children:[(0,se.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save"]}),(0,se.jsx)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded",onClick:()=>{var e;null===(e=n.cards)||void 0===e||e.forEach(e=>{e.isCollapsed=!0}),l(n),i()},children:"Save & Close"})]})})]})},lt=(0,r.memo)(ot),it=e=>{let{index:t,onDelete:a,expandToEdit:r,length:s}=e;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>r(t),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsxs)("strong",{title:"Card ".concat(t+1),className:"text-sm grow min-w-0",children:["Card ",t+1]})]})}),s>1&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2",onClick:e=>{e.stopPropagation(),a(t)},children:"\xd7"})})]})})},nt=(0,r.memo)(it),dt=e=>{var t,a;let{data:s,id:i}=e;const{node:n,onDelete:d,handleChange:c}=s,[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[g,y]=(0,r.useState)({}),[b,w]=(0,r.useState)(n.data),[v,j]=(0,r.useState)(()=>{var e;return(null===(e=n.data.cards)||void 0===e?void 0:e.length)>0&&n.data.cards[0].postbackTexts?n.data.cards[0].postbackTexts.length:0}),[f,k]=(0,r.useState)(()=>Array.isArray(n.data.contentParams)?n.data.contentParams.join(", "):n.data.contentParams||""),N=(e,t)=>{const a=te(e,t);y(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},A=(e,t)=>{delete n.data.errors;const a=(0,o.A)((0,o.A)({},b),{},{[e]:t});w(a),c(n.id,a)},C=e=>{delete n.data.errors;const t=b.cards.filter((t,a)=>a!==e),a=(0,o.A)((0,o.A)({},b),{},{cards:t});w(a),c(n.id,a)},T=()=>u(!1),E=e=>{u(!0)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(n.data&&n.data.errors&&Object.keys(n.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-purple-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>x(!p),children:"WhatsApp Carousel"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:n.data.delay,onChange:A}),(0,se.jsx)("button",{className:"text-gray-400 hover:text-white mr-3",title:"Expand",onClick:()=>u(e=>!e),children:(0,se.jsx)("svg",{className:"w-4 h-4 text-blue-500 cursor-pointer hover:text-blue-700",fill:"white",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 242.133 242.133",children:(0,se.jsx)("path",{id:"XMLID_15_",d:"M227.133,83.033c8.283,0,15-6.716,15-15V15c0-8.284-6.717-15-15-15H174.1c-8.284,0-15,6.716-15,15 s6.716,15,15,15h16.82l-69.854,69.854L51.213,30h16.82c8.284,0,15-6.716,15-15s-6.716-15-15-15H15C6.717,0,0,6.716,0,15v53.033 c0,8.284,6.717,15,15,15c8.285,0,15-6.716,15-15v-16.82l69.854,69.854L30,190.92V174.1c0-8.284-6.715-15-15-15 c-8.283,0-15,6.716-15,15v53.033c0,8.284,6.717,15,15,15h53.033c8.284,0,15-6.716,15-15c0-8.284-6.716-15-15-15h-16.82 l69.854-69.854l69.854,69.854H174.1c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h53.033c8.283,0,15-6.716,15-15V174.1 c0-8.284-6.717-15-15-15c-8.285,0-15,6.716-15,15v16.82l-69.854-69.854l69.854-69.854v16.82 C212.133,76.317,218.848,83.033,227.133,83.033z"})})}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>d(i),children:"\xd7"})]})]}),!p&&(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Field Label",type:"text",maxLength:50,placeholder:"Field Label",value:b.fieldLabel||"",onChange:e=>A("fieldLabel",e.target.value),onBlur:e=>N("fieldLabel",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),g.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:g.fieldLabel})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Property Name",type:"text",maxLength:50,placeholder:"Property Name",value:b.property||"",onChange:e=>A("property",e.target.value),onBlur:e=>N("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),g.property&&(0,se.jsx)("small",{className:"text-red-500",children:g.property})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("select",{title:"Card Header Type",value:b.cardHeaderType||"",onChange:e=>A("cardHeaderType",e.target.value),onBlur:e=>N("cardHeaderType",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Header Type"}),(0,se.jsx)("option",{value:"IMAGE",children:"IMAGE"}),(0,se.jsx)("option",{value:"VIDEO",children:"VIDEO"})]}),g.cardHeaderType&&(0,se.jsx)("small",{className:"text-red-500",children:g.cardHeaderType})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"WB Template ID",type:"text",maxLength:100,placeholder:"WB Template ID",value:b.wbTemplateId||"",onChange:e=>A("wbTemplateId",e.target.value),onBlur:e=>N("wbTemplateId",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),g.wbTemplateId&&(0,se.jsx)("small",{className:"text-red-500",children:g.wbTemplateId})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Content Params (comma separated)",type:"text",placeholder:"Content Params (comma separated)",value:f,onChange:e=>(e=>{delete n.data.errors,k(e);const t=e.split(",").map(e=>e.trim()).filter(e=>""!==e),a=(0,o.A)((0,o.A)({},b),{},{contentParams:t});w(a),c(n.id,a)})(e.target.value),onBlur:e=>N("contentParams",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),g.contentParams&&(0,se.jsx)("small",{className:"text-red-500",children:g.contentParams})]}),(0,se.jsx)("div",{children:(0,se.jsxs)("select",{title:"Number of Buttons (0-2)",value:v,onChange:e=>(e=>{var t;if(e<0||e>2)return;j(e);const a=null===(t=b.cards)||void 0===t?void 0:t.map(t=>(0,o.A)((0,o.A)({},t),{},{postbackTexts:Array.from({length:e},(e,a)=>{var r;return(null===(r=t.postbackTexts)||void 0===r?void 0:r[a])||{index:a+1,text:""}})})),r=(0,o.A)((0,o.A)({},b),{},{cards:a});w(r),c(n.id,r)})(Number(e.target.value)),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"0",children:"0 Buttons"}),(0,se.jsx)("option",{value:"1",children:"1 Button"}),(0,se.jsx)("option",{value:"2",children:"2 Buttons"})]})}),(0,se.jsx)("div",{className:"space-y-2",children:null===(t=b.cards)||void 0===t?void 0:t.map((e,t)=>{var a;return(0,se.jsxs)("div",{className:"nodrag relative card-wrapper",children:[(0,se.jsx)(nt,{card:e,index:t,onDelete:C,length:null===(a=b.cards)||void 0===a?void 0:a.length,expandToEdit:E},t),e.postbackTexts&&e.postbackTexts.length>0&&(0,se.jsx)("div",{className:"flex flex-col gap-2 mt-2 px-2",children:e.postbackTexts.slice(0,2).map((t,a)=>(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("button",{className:"nodrag w-full px-2 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors duration-200",title:t.text||"Button ".concat(a+1),children:t.text||"Button ".concat(a+1)}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:"".concat(e.id,"-btn-").concat(t.index),style:{top:"50%",transform:"translateY(-50%)"}})]},a))})]},t)})}),0===v&&(0,se.jsxs)("div",{className:"mt-2 px-2 relative",children:[(0,se.jsx)("button",{className:"nodrag w-full px-2 py-1 text-xs font-medium text-white bg-gray-600 hover:bg-gray-700 rounded transition-colors duration-200",title:"Default",children:"Default"}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:"".concat(i,"-default"),style:{top:"50%",transform:"translateY(-50%)"}})]}),(null===(a=b.cards)||void 0===a?void 0:a.length)<10&&(0,se.jsxs)("button",{className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{delete n.data.errors;const e={id:h(),flowId:"",link:"",value:"",category:"",leadEmailTo:"",leadEmailCc:[],postbackTexts:Array.from({length:v},(e,t)=>({index:t+1,text:""}))},t=(0,o.A)((0,o.A)({},b),{},{cards:[...b.cards,e]});w(t),c(n.id,t),u(!0)},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add Card"]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:i}),(0,se.jsx)(Ze.l,{header:"Edit WhatsApp Carousel",visible:m,style:{width:"100vw"},onHide:()=>{m&&T()},children:(0,se.jsx)(lt,{save:e=>{var t,a;const r=(0,o.A)((0,o.A)({},e),{},{cards:null===(t=e.cards)||void 0===t?void 0:t.map(e=>(0,o.A)({},e))});(null===(a=r.cards)||void 0===a?void 0:a.length)>0&&r.cards[0].postbackTexts&&j(r.cards[0].postbackTexts.length),w(r),c(n.id,r)},carouselData:b,close:T})})]})},ct=(0,r.memo)(dt);var mt=a(19274);const ut=e=>{var t,a,s,i,n,d;let{id:c,data:u}=e;const{node:p,onDelete:h,handleChange:x,setNodes:g,nodes:y}=u,[b,w]=(0,r.useState)({}),v=(0,r.useMemo)(()=>new Date((new Date).setHours(0,0,0,0)),[]),j=(0,r.useMemo)(()=>{const e=new Date;return e.setMonth(e.getMonth()+3),e.setHours(23,59,59,999),e},[]),[f,k]=(0,r.useState)({}),N=(e,t)=>{delete p.data.errors,w({});const a=(0,o.A)((0,o.A)({},p.data),{},{[e]:t});x(p.id,a)},A=()=>{g(y.map(e=>(0,o.A)((0,o.A)({},e),{},{selected:!1})))},C=(0,r.useCallback)(e=>{switch(e){case m.bh.CUSTOM:return k({min:"Custom Expression",max:""}),{min:"",max:""};case m.bh.STRING:return k({min:"String Min Length",max:"String Max Length"}),{min:3,max:500};case m.bh.NUMBER:return k({min:"Number Min Length",max:"Number Max Length"}),{min:3,max:15};case m.bh.DATE:return k({min:"Min Date",max:"Max Date"}),{min:"",max:""};case m.bh.DATETIME:return k({min:"Min Date Time",max:"Max Date Time"}),{min:"",max:""};case m.bh.TIME:return k({min:"Min Time",max:"Max Time"}),{min:"",max:""};default:return{min:"",max:""}}},[]),T=()=>(0,se.jsx)("button",{title:"Delete Question Node",className:"w-full text-white bg-red-500 hover:bg-red-700 rounded flex items-center justify-center",onClick:()=>(()=>{let e=document.querySelector(".p-datepicker");e&&(e.style.visibility="hidden")})(),children:"Close"});return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(null!==(t=p.data)&&void 0!==t&&t.errors&&Object.keys(p.data.errors).length?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Question Node"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:p.data.delay,onChange:N}),(0,se.jsx)("button",{title:"Delete Question Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>h(c),children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,se.jsx)("div",{className:"mb-2",title:"Field Label",children:(0,se.jsx)("input",{type:"text",placeholder:"Field Label",value:p.data.fieldLabel||"",onClick:A,onChange:e=>N("fieldLabel",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsxs)("div",{className:"mb-2",title:"Property Name (Alphanumeric, no spaces)",children:[(0,se.jsx)("input",{type:"text",placeholder:"Property Name (Alphanumeric, no spaces)",value:p.data.property||"",onClick:A,onChange:e=>N("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(a=Object.keys(p.data.errors))||void 0===a?void 0:a.length)>0&&p.data.errors.property&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.property})]}),(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)(ie,{maxLength:500,message:p.data.message,onChange:e=>N("message",e)}),p.data.errors&&(null===(s=Object.keys(p.data.errors))||void 0===s?void 0:s.length)>0&&p.data.errors.message&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.message})]}),(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsxs)("select",{title:"Field Type",value:p.data.fieldType,onClick:A,onChange:e=>{delete p.data.errors,e.target.value?b.fieldType&&w(e=>{const t=(0,o.A)({},e);return delete t.fieldType,t}):w(e=>(0,o.A)((0,o.A)({},e),{},{fieldType:"Question Type is Mandatory"}));const t=e.target.value,{min:a,max:r}=C(t),s=(0,o.A)((0,o.A)({},p.data),{},{fieldType:t,min:a,max:r,custom:""});x(p.id,s)},className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Field Type"}),m.r8.map(e=>(0,se.jsx)("option",{value:e.value,children:e.label},e.value))]}),p.data.errors&&(null===(i=Object.keys(p.data.errors))||void 0===i?void 0:i.length)>0&&p.data.errors.fieldType&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.fieldType})]}),(0,se.jsxs)("div",{className:"mb-2",children:[[m.bh.STRING,m.bh.NUMBER].includes(p.data.fieldType)&&(0,se.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,se.jsx)("input",{title:f.min||"Min Length",type:"number",placeholder:f.min,value:p.data.min||"",onChange:e=>N("min",e.target.value),onClick:A,className:"nodrag w-1/2 p-1 border border-gray-600 bg-gray-700 text-white rounded",maxLength:13}),(0,se.jsx)("input",{title:f.max||"Max Length",type:"number",placeholder:f.max,value:p.data.max||"",onClick:A,onChange:e=>N("max",e.target.value),className:"nodrag w-1/2 p-1 border border-gray-600 bg-gray-700 text-white rounded",maxLength:13})]}),[m.bh.DATE,m.bh.DATETIME,m.bh.TIME].includes(p.data.fieldType)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsxs)("select",{title:"Date Format",value:p.data.dateFormat,onClick:A,onChange:e=>N("dateFormat",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Date Format"}),m.lu.map(e=>(0,se.jsx)("option",{value:e,children:e},e))]})}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,se.jsx)(mt.V,{tooltip:f.min||"Min",tooltipOptions:{position:"top"},showIcon:!0,placeholder:f.min||"Min",minDate:v,maxDate:j,value:p.data.min||null,onFocus:A,onChange:e=>N("min",e.value),showTime:p.data.fieldType!==m.bh.DATE,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded small-calendar",timeOnly:m.bh.TIME===p.data.fieldType,autoZIndex:!0,footerTemplate:T,showButtonBar:!0}),(0,se.jsx)(mt.V,{tooltip:f.max||"Max",tooltipOptions:{position:"top"},showIcon:!0,placeholder:f.max||"Max",minDate:p.data.min||v,maxDate:j,value:p.data.max||null,onFocus:A,onChange:e=>N("max",e.value),showTime:p.data.fieldType!==m.bh.DATE,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",timeOnly:m.bh.TIME===p.data.fieldType,autoZIndex:!0,footerTemplate:T,showButtonBar:!0})]})]}),p.data.fieldType===m.bh.CUSTOM&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("input",{title:"Custom Expression",type:"text",placeholder:f.min||"Custom Expression",value:p.data.custom||"",onClick:A,onBlur:e=>((e,t)=>{let a="";"message"!==e||t.trim()||(a="Message is required."),"custom"!==e||p.data.fieldType!==m.bh.CUSTOM||t.trim()||(a="Regex pattern is required for custom type."),w(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))})("custom",e.target.value),onChange:e=>N("custom",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded mt-2"}),(null===(n=p.data.errors)||void 0===n?void 0:n.custom)&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.custom})]}),p.data.errors&&(null===(d=Object.keys(p.data.errors))||void 0===d?void 0:d.length)>0&&p.data.errors.answer&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.answer})]}),p.data.fieldType&&(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)(ie,{maxLength:500,placeHolder:"Error Message",message:p.data.errorMessage,onChange:e=>N("errorMessage",e)})})]})]}),(0,se.jsx)(l.h7,{id:"target",type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{id:"source",type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},pt=(0,r.memo)(ut);var ht=a(33340),xt=a(43983);const gt=e=>{var t,a;let{id:s,data:i}=e;const{node:n,onDelete:d,handleChange:c,setNodes:m,nodes:u}=i,[p]=(0,Ve.G)(),h=(0,ht.nc)(e=>e.botsList),x=(0,ht.nc)(e=>e.organizationId),[g,y]=(0,r.useState)([]),[b,w]=(0,r.useState)({}),[v,j]=(0,r.useState)({}),f=(0,r.useRef)({container:!1,callAccepted:!1,callRejected:!1}),k=()=>{m(u.map(e=>(0,o.A)((0,o.A)({},e),{},{selected:!1})))},N=(e,t)=>{var a;w(a=>(0,o.A)((0,o.A)({},a),{},{[e]:t})),null===(a=f.current[e])||void 0===a||a.focus()},A=(e,t)=>{delete n.data.errors,j({});const a=(0,o.A)((0,o.A)({},n.data),{},{[e]:t});c(n.id,a)},C=(0,r.useCallback)(e=>{f.current.container&&!f.current.container.contains(e.target)?w(e=>(0,o.A)((0,o.A)({},e),{},{successMessage:!1,failureMessage:!1})):f.current.callAccepted&&!f.current.callAccepted.contains(e.target)?w(e=>(0,o.A)((0,o.A)({},e),{},{callAccepted:!1})):f.current.callRejected&&!f.current.callRejected.contains(e.target)&&w(e=>(0,o.A)((0,o.A)({},e),{},{callRejected:!1}))},[w]);return(0,r.useEffect)(()=>(document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)),[C]),(0,r.useEffect)(()=>{var e;const t=h.find(e=>e._id===p),a=t?null===(e=t.integrations)||void 0===e?void 0:e.filter(e=>"callConnect_123"===e.channelId):[];if(a&&a.length>0){const e=a.map(e=>({name:e.serviceDetails.name,_id:e._id}));y(e)}else(0,xt.Yl)({botId:p,organizationId:x})},[p,h,x]),(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Call Connect Node"}),(0,se.jsx)("button",{title:"Delete Call Connect Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>d(s),children:"\xd7"})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsxs)("select",{title:"callConnectId",value:n.data.callConnectId,onClick:k,onChange:e=>{delete n.data.errors,e.target.value?v.callConnectId&&j(e=>{const t=(0,o.A)({},e);return delete t.callConnectId,t}):j(e=>(0,o.A)((0,o.A)({},e),{},{callConnectId:"Call Connect Name is Mandatory"}));const t=e.target.value;A("callConnectId",t)},className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Call Connect Name"}),g.map((e,t)=>(0,se.jsx)("option",{value:e._id,children:e.name},"".concat(e._id,"-").concat(t)))]}),n.data.errors&&(null===(t=Object.keys(n.data.errors))||void 0===t?void 0:t.length)>0&&n.data.errors.callConnectId&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.callConnectId})]}),(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)(ie,{maxLength:500,message:n.data.message,onChange:e=>A("message",e)}),n.data.errors&&(null===(a=Object.keys(n.data.errors))||void 0===a?void 0:a.length)>0&&n.data.errors.message&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.message})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"grid grid-cols-10 gap-2 mb-2  px-1 py-1 border border-gray-400 rounded-md relative",children:(0,se.jsxs)("div",{className:"col-span-10 flex items-center ",children:[(0,se.jsx)(bt,{onClick:()=>N("callAccepted",!0),className:"min-w-4 w-4 h-4 mx-2 text-blue-300 cursor-pointer hover:text-white"}),(0,se.jsx)("input",{type:"text",ref:e=>f.current.callAccepted=e,readOnly:!b.callAccepted,value:n.data.callAccepted,placeholder:"Enter call accepted massage",autoFocus:b.callAccepted,onClick:b.callAccepted?void 0:k,onChange:e=>A("callAccepted",e.target.value),className:"nodrag  w-full ml-1 p-1 border border-gray-600 bg-gray-700 text-white rounded capitalize"})]})}),n.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.callAccepted})]}),(0,se.jsxs)("div",{ref:e=>f.current.container=e,children:[(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 min-w-36",children:[b.successMessage?(0,se.jsx)(ie,{maxLength:500,message:n.data.successMessage,onChange:e=>A("successMessage",e)}):(0,se.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",title:"Double Click ro Enter/Edit the Message",children:[(0,se.jsx)("span",{children:n.data.successMessage||"Enter your success message"}),(0,se.jsx)(bt,{onClick:()=>N("successMessage",!0),className:"w-4 h-4 text-white ml-2"})]}),n.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.successMessage})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3 min-w-36",children:[b.failureMessage?(0,se.jsx)(ie,{maxLength:500,message:n.data.failureMessage,onChange:e=>A("failureMessage",e)}):(0,se.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",title:"Double Click ro Enter/Edit the Message",children:[(0,se.jsx)("span",{children:n.data.failureMessage||"Enter your failure message"}),(0,se.jsx)(bt,{onClick:()=>N("failureMessage",!0),className:"w-4 h-4 text-white ml-2"})]}),n.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.failureMessage})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"grid grid-cols-10 gap-2 mb-2  px-1 py-1 border border-gray-400 rounded-md relative",children:(0,se.jsxs)("div",{className:"col-span-10 flex items-center ",children:[(0,se.jsx)(bt,{onClick:()=>N("callRejected",!0),className:"min-w-4 w-4 h-4 mx-2 text-blue-300 cursor-pointer hover:text-white"}),(0,se.jsx)("input",{type:"text",readOnly:!b.callRejected,placeholder:"Enter call rejected massage",ref:e=>f.current.callRejected=e,value:n.data.callRejected,onClick:b.callRejected?void 0:k,onChange:e=>A("callRejected",e.target.value),className:"nodrag  w-full ml-1 p-1 border border-gray-600 bg-gray-700  rounded capitalize"})]})}),n.data.errors&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.callRejected})]})]})]}),(0,se.jsx)(l.h7,{id:"target",type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{id:"source",type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},yt=(0,r.memo)(gt),bt=e=>{let{onClick:t,className:a=""}=e;return(0,se.jsx)("svg",{onClick:t,className:a,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"})})},wt=e=>{var t,a;let{id:s,data:i}=e;const{node:n,onDelete:d,handleChange:c,setNodes:m,nodes:u}=i,[p,h]=(0,r.useState)({}),x=()=>{m(u.map(e=>(0,o.A)((0,o.A)({},e),{},{selected:!1})))},g=(e,t)=>{delete n.data.errors;const a=(0,o.A)((0,o.A)({},n.data),{},{[e]:t});c(n.id,a)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"OTP Node"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:n.data.delay,onChange:g}),(0,se.jsx)("button",{title:"Delete Call Connect Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>d(s),children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)(ie,{maxLength:500,message:n.data.message,onChange:e=>g("message",e),onClick:x}),n.data.errors&&(null===(t=Object.keys(n.data.errors))||void 0===t?void 0:t.length)>0&&n.data.errors.message&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.message})]}),(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsxs)("select",{title:"OTP Type",value:n.data.otpType,onClick:x,onChange:e=>{delete n.data.errors,e.target.value?p.callConnectId&&h(e=>{const t=(0,o.A)({},e);return delete t.callConnectId,t}):h(e=>(0,o.A)((0,o.A)({},e),{},{callConnectId:"Call Connect Name is Mandatory"}));const t=e.target.value;g("otpType",t)},className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Please select OTP type"}),(0,se.jsxs)("option",{value:"phoneNumber",children:[" ","Mobile Number"]},"phoneNumber"),(0,se.jsx)("option",{value:"email",children:"Email"},"email")]}),n.data.errors&&(null===(a=Object.keys(n.data.errors))||void 0===a?void 0:a.length)>0&&n.data.errors.otpType&&(0,se.jsx)("small",{className:"text-red-500",children:n.data.errors.otpType})]})]})]}),(0,se.jsx)(l.h7,{id:"target",type:"target",position:l.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,se.jsx)(l.h7,{id:"source",type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},vt=(0,r.memo)(wt),jt=e=>{let{optionsData:t,save:a,close:s}=e;const[l,i]=(0,r.useState)(t),[n,d]=(0,r.useState)([]),[c,u]=(0,r.useState)({}),p=(0,r.useMemo)(()=>new Date((new Date).setHours(0,0,0,0)),[]),x=(0,r.useMemo)(()=>{const e=new Date;return e.setMonth(e.getMonth()+3),e.setHours(23,59,59,999),e},[]);(0,r.useEffect)(()=>{i(t)},[t]);const g=(e,t,a,r,s)=>{const l=Y(t,a,r,s);l&&d(a=>{var r;return(0,o.A)((0,o.A)({},a),{},{customFields:(0,o.A)((0,o.A)({},a.customFields),{},{[e]:(0,o.A)((0,o.A)({},null===(r=a.customFields)||void 0===r?void 0:r[e]),{},{[t]:l})})})})},y=(e,t)=>{const{name:a,value:r}=t.target,s=[...l.customFields],n=(0,o.A)({},s[e]);n[a]=r,s[e]=n,i((0,o.A)((0,o.A)({},l),{},{customFields:s})),d(t=>{var r,s;const l=(0,o.A)({},t);if(null!==l&&void 0!==l&&null!==(r=l.customFields)&&void 0!==r&&null!==(s=r[e])&&void 0!==s&&s[a]){delete l.customFields[e][a];const t=l.customFields[e];t&&Object.values(t).every(e=>""===e)&&delete l.customFields[e],0===Object.keys(l.customFields).length&&delete l.customFields}return l})},b=(0,r.useCallback)(e=>{switch(e){case m.bh.CUSTOM:return u({min:"Custom Expression",max:""}),{min:"",max:""};case m.bh.STRING:return u({min:"String Min Length",max:"String Max Length"}),{min:3,max:500};case m.bh.NUMBER:return u({min:"Number Min Length",max:"Number Max Length"}),{min:3,max:15};case m.bh.DATE:return u({min:"Min Date",max:"Max Date"}),{min:"",max:""};case m.bh.DATETIME:return u({min:"Min Date Time",max:"Max Date Time"}),{min:"",max:""};case m.bh.TIME:return u({min:"Min Time",max:"Max Time"}),{min:"",max:""};default:return{min:"",max:""}}},[]),w=e=>{const t={customFields:{}},a=new Set;e.customFields.map((r,s)=>{delete e.customFields[s].isCollapsed;const o={};Object.keys(r).map(e=>{const t=r[e],s=Y(e,t,r.fieldType,r,a);s&&(o[e]=s)}),void 0===o.property&&a.add(r.property),Object.keys(o).length>0&&(t.customFields[s]=o,r.isCollapsed=!1)}),d(t);return Object.keys(t.customFields).some(e=>Object.keys(t.customFields[e]).length>0)},v=()=>(0,se.jsx)("button",{title:"Delete Question Node",className:"w-full text-white bg-red-500 hover:bg-red-700 rounded flex items-center justify-center",onClick:()=>(()=>{let e=document.querySelector(".p-datepicker");e&&(e.style.visibility="hidden")})(),children:"Close"});return(0,se.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,se.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,se.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,se.jsx)("h5",{className:"modal-title text-lg font-bold",children:"Edit Options"}),(0,se.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:s,children:"\xd7"})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 mt-16 mb-20",children:[l.customFields.map((e,t)=>{var a,r,s,d,u,h,w,j,f,k,N,A,C,T,E,M,L,F,S,I,D,O,B,P,H,z,U,W,_,R;return(0,se.jsxs)("div",{className:"accordion px-2 mb-2",children:[(0,se.jsxs)("div",{className:"accordion-header flex items-center p-1 cursor-pointer border border-gray-600 rounded bg-gray-800 hover:bg-gray-700 transition-colors",onClick:()=>(e=>{const t=l.customFields.map((t,a)=>a===e?(0,o.A)((0,o.A)({},t),{},{isCollapsed:!t.isCollapsed}):t);i((0,o.A)((0,o.A)({},l),{},{customFields:t}))})(t),children:[(0,se.jsx)("span",{className:"mr-3",children:e.isCollapsed?(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,se.jsx)("span",{className:"flex-1",children:e.title||"Custom Filed ".concat(t+1)}),l.customFields.length>1&&(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold ml-4",onClick:e=>{e.stopPropagation(),(e=>{i((0,o.A)((0,o.A)({},l),{},{customFields:l.customFields.filter((t,a)=>a!==e)}))})(t)},children:"\xd7"})]}),!e.isCollapsed&&(0,se.jsx)("div",{className:"accordion-content bg-gray-700 p-2 rounded",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Property Name"}),(0,se.jsx)("input",{title:"Property Name",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"property",value:e.property,onChange:e=>y(t,e),onBlur:e=>g(t,"property",e.target.value)}),(null===(a=n.customFields)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.property)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(s=n.customFields[t])||void 0===s?void 0:s.property.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Title"}),(0,se.jsx)("input",{title:"Title",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"title",value:e.title,onChange:e=>y(t,e),onBlur:e=>g(t,"title",e.target.value)}),(null===(d=n.customFields)||void 0===d||null===(u=d[t])||void 0===u?void 0:u.title)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(h=n.customFields[t])||void 0===h?void 0:h.title.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"WhatApp Question"}),(0,se.jsx)("input",{title:"whatsAppQuestion",type:"whatsAppQuestion",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"whatsAppQuestion",value:e.whatsAppQuestion,onChange:e=>y(t,e),onBlur:e=>g(t,"whatsAppQuestion",e.target.value)}),(null===(w=n.customFields)||void 0===w||null===(j=w[t])||void 0===j?void 0:j.whatsAppQuestion)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(f=n.customFields[t])||void 0===f?void 0:f.whatsAppQuestion.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Select Category"}),(0,se.jsxs)("select",{title:"Field Type",name:"fieldType",value:e.fieldType,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",style:{height:"25px"},onChange:e=>((e,t)=>{var a,r;null===n||void 0===n||null===(a=n.customFields)||void 0===a||null===(r=a[e])||void 0===r||delete r[t.target.name];const{value:s}=t.target,{min:d,max:c}=b(s),m=[...l.customFields];m[e].fieldType=s,"phone"!==s&&"email"!==s&&"custom"!==s&&(m[e].min=d,m[e].max=c),"custom"===s&&(m[e].custom=""),i((0,o.A)((0,o.A)({},l),{},{customFields:m}))})(t,e),onBlur:a=>g(t,"fieldType",a.target.value,e.fieldType,e),children:[(0,se.jsx)("option",{value:"",children:"Select Value Type"}),m.r8.map(e=>(0,se.jsx)("option",{value:e.value,children:e.label},e.value))]}),(null===(k=n.customFields)||void 0===k||null===(N=k[t])||void 0===N?void 0:N.fieldType)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(A=n.customFields[t])||void 0===A?void 0:A.fieldType.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),[m.bh.STRING,m.bh.NUMBER].includes(e.fieldType)&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Min & Max"}),(0,se.jsxs)("div",{className:"flex space-x-2 ",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:c.min||"Min Length",type:"number",name:"min",placeholder:c.min,value:e.min||"",onChange:e=>y(t,e),onBlur:a=>g(t,"min",a.target.value,e.fieldType,e),style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",maxLength:13}),(null===(C=n.customFields)||void 0===C||null===(T=C[t])||void 0===T?void 0:T.min)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(E=n.customFields[t])||void 0===E?void 0:E.min.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:c.max||"Max Length",type:"number",name:"max",placeholder:c.max,value:e.max||"",onChange:e=>y(t,e),style:{height:"25px"},onBlur:a=>g(t,"max",a.target.value,e.fieldType,e),className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",maxLength:13}),(null===(M=n.customFields)||void 0===M||null===(L=M[t])||void 0===L?void 0:L.max)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(F=n.customFields[t])||void 0===F?void 0:F.max.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})]})]})}),[m.bh.DATE,m.bh.DATETIME,m.bh.TIME].includes(e.fieldType)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"min-w-[200px] ",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Select Date Format"}),(0,se.jsxs)("select",{title:"Date Format",name:"dateFormat",value:e.dateFormat,onChange:e=>y(t,e),onBlur:a=>g(t,"dateFormat",a.target.value,e.fieldType,e),style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Date Format"}),m.lu.map(e=>(0,se.jsx)("option",{value:e,children:e},e))]}),(null===(S=n.customFields)||void 0===S||null===(I=S[t])||void 0===I?void 0:I.dateFormat)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(D=n.customFields[t])||void 0===D?void 0:D.dateFormat.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),(0,se.jsx)("div",{className:"min-w-[200px] mt-2",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Min"}),(0,se.jsx)(mt.V,{name:"min",tooltip:c.min||"Min",tooltipOptions:{position:"top"},showIcon:!0,placeholder:c.min||"Min",minDate:p,maxDate:x,value:e.min?new Date(e.min):null,onChange:e=>y(t,e),onBlur:a=>g(t,"min",a.target.value,e.fieldType,e),style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",showTime:e.fieldType!==m.bh.DATE,timeOnly:m.bh.TIME===e.fieldType,autoZIndex:!0,footerTemplate:v,showButtonBar:!0}),(null===(O=n.customFields)||void 0===O||null===(B=O[t])||void 0===B?void 0:B.min)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(P=n.customFields[t])||void 0===P?void 0:P.min.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})}),(0,se.jsx)("div",{className:"min-w-[200px] mt-2",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Max"}),(0,se.jsx)(mt.V,{name:"max",tooltip:c.max||"Max",tooltipOptions:{position:"top"},showIcon:!0,value:e.max?new Date(e.max):null,placeholder:c.max||"Max",minDate:p,maxDate:x,onChange:e=>y(t,e),onBlur:a=>g(t,"max",a.target.value,e.fieldType,e),style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",showTime:e.fieldType!==m.bh.DATE,timeOnly:m.bh.TIME===e.fieldType,autoZIndex:!0,footerTemplate:v,showButtonBar:!0}),(null===(H=n.customFields)||void 0===H||null===(z=H[t])||void 0===z?void 0:z.max)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(U=n.customFields[t])||void 0===U?void 0:U.max.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})})]}),e.fieldType===m.bh.CUSTOM&&(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("div",{className:"min-w-[200px] ",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Custom "}),(0,se.jsx)("input",{title:"Custom Expression",name:"custom",type:"text",placeholder:c.min||"Custom Expression",value:e.custom||"",onBlur:a=>g(t,"custom",a.target.value,e.fieldType,e),onChange:e=>y(t,e),style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded"}),(null===(W=n.customFields)||void 0===W||null===(_=W[t])||void 0===_?void 0:_.custom)&&(0,se.jsx)("div",{className:"text-red-500 text-sm",children:null===(R=n.customFields[t])||void 0===R?void 0:R.custom.split(". ").map((e,t)=>(0,se.jsx)("small",{children:e},t))})]})})})]})})]},t)}),(0,se.jsxs)("button",{className:"flex ml-2 px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{i((0,o.A)((0,o.A)({},l),{},{customFields:[...l.customFields,{id:h(),property:"",title:"",whatsAppQuestion:"",fieldType:""}]}))},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]}),(0,se.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,se.jsxs)("div",{className:"modal-footer py-2 px-4 flex justify-start gap-2",children:[(0,se.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{w(l)||(a(l),s())},children:[(0,se.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save"]}),(0,se.jsx)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{w(l)||(a(l),s())},children:"Save & Close"})]})})]})},ft=(0,r.memo)(jt),kt=e=>{let{customField:t,index:a,onDelete:r,expandToEdit:s,length:o}=e;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>s(a),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{title:t.title,className:"text-sm grow min-w-0",children:t.title?"".concat(t.title):"Custom Field"})]})}),o>1&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2 w-[25px] w-[25px]",onClick:e=>{e.stopPropagation(),r(a)},children:"\xd7"})})]})})},Nt=(0,r.memo)(kt),At=e=>{let{data:t,id:a}=e;const{node:s,onDelete:i,handleChange:n}=t,[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)({}),[g,y]=(0,r.useState)(s.data),[b,w]=(0,r.useState)(s.data.message),v=(e,t)=>{delete s.data.errors;const a=(0,o.A)((0,o.A)({},g),{},{[e]:t});y(a),n(s.id,a)},j=e=>{delete s.data.errors;const t=g.customFields.filter((t,a)=>a!==e),a=(0,o.A)((0,o.A)({},g),{},{customFields:t});y(a),n(s.id,a)},f=()=>c(!1),k=e=>{g.customFields.forEach(e=>{e.isCollapsed=!0}),g.customFields[e].isCollapsed=!1,c(!0)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(s.data&&s.data.errors&&Object.keys(s.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>u(!m),children:"Custom Form"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:g.delay,onChange:v}),(0,se.jsx)("button",{className:"text-gray-400 hover:text-white mr-3",title:"Expand",onClick:()=>c(e=>!e),children:(0,se.jsx)("svg",{className:"w-4 h-4 text-blue-500 cursor-pointer hover:text-blue-700",fill:"white",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 242.133 242.133",children:(0,se.jsx)("path",{id:"XMLID_15_",d:"M227.133,83.033c8.283,0,15-6.716,15-15V15c0-8.284-6.717-15-15-15H174.1c-8.284,0-15,6.716-15,15 s6.716,15,15,15h16.82l-69.854,69.854L51.213,30h16.82c8.284,0,15-6.716,15-15s-6.716-15-15-15H15C6.717,0,0,6.716,0,15v53.033 c0,8.284,6.717,15,15,15c8.285,0,15-6.716,15-15v-16.82l69.854,69.854L30,190.92V174.1c0-8.284-6.715-15-15-15 c-8.283,0-15,6.716-15,15v53.033c0,8.284,6.717,15,15,15h53.033c8.284,0,15-6.716,15-15c0-8.284-6.716-15-15-15h-16.82 l69.854-69.854l69.854,69.854H174.1c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h53.033c8.283,0,15-6.716,15-15V174.1 c0-8.284-6.717-15-15-15c-8.285,0-15,6.716-15,15v16.82l-69.854-69.854l69.854-69.854v16.82 C212.133,76.317,218.848,83.033,227.133,83.033z"})})}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>i(a),children:"\xd7"})]})]}),!m&&(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[(0,se.jsxs)("div",{className:"mb-2",title:"Property Name",children:[(0,se.jsx)("input",{type:"text",placeholder:"Property Name",value:g.property,onChange:e=>v("property",e.target.value),onBlur:e=>((e,t)=>{const a=Y(e,t);x(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))})("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.property&&(0,se.jsx)("small",{className:"text-red-500",children:p.property})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)(ie,{maxLength:300,message:g.message,onChange:e=>v("message",e)},b),p.message&&(0,se.jsx)("small",{className:"text-red-500",children:p.message})]}),(0,se.jsx)($e.JY,{onDragEnd:e=>{const{source:t,destination:a}=e;if(!a)return;const r=Array.from(g.customFields),[l]=r.splice(t.index,1);r.splice(a.index,0,l);const i=(0,o.A)((0,o.A)({},g),{},{customFields:r});y(i),n(s.id,i)},children:(0,se.jsx)(et,{droppableId:"customForm",children:e=>{var t;return(0,se.jsxs)("div",(0,o.A)((0,o.A)({},e.droppableProps),{},{ref:e.innerRef,className:"space-y-2",children:[null===(t=g.customFields)||void 0===t?void 0:t.map((e,t)=>(0,se.jsx)("div",{className:"nodrag relative subOption-wrapper",children:(0,se.jsx)($e.sx,{draggableId:e.id,index:t,children:a=>(0,se.jsx)("div",(0,o.A)((0,o.A)((0,o.A)({ref:a.innerRef},a.draggableProps),a.dragHandleProps),{},{style:(0,o.A)((0,o.A)({},a.draggableProps.style),{},{left:"auto !important",top:"auto !important",width:"100%"}),children:(0,se.jsx)(Nt,{customField:e,index:t,onDelete:j,length:g.customFields.length,expandToEdit:k},t)}))},e.id)},t)),e.placeholder]}))}})}),(0,se.jsxs)("button",{className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{delete s.data.errors;const e={id:h(),property:"",title:"",whatsAppQuestion:"",fieldType:""},t=(0,o.A)((0,o.A)({},g),{},{customFields:[...g.customFields,e]});y(t),n(s.id,t),c(!0)},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:a}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,id:"source"}),(0,se.jsx)(Ze.l,{header:"Header",visible:d,style:{width:"100vw"},onHide:()=>{d&&f()},children:(0,se.jsx)(ft,{save:e=>{const t=(0,o.A)((0,o.A)({},e),{},{customFields:e.customFields.map(e=>(0,o.A)({},e))});w(Math.random().toString()),y(t),n(s.id,t)},optionsData:g,close:f})})]})},Ct=(0,r.memo)(At);a(20816);var Tt=a(32026),Et=a(93038),Mt=a(12069);const Lt=e=>{let{paramsData:t,headerData:a,save:s,close:l,properties:i}=e;const[n,d]=(0,r.useState)(t),[c,u]=(0,r.useState)(a),[p,h]=(0,r.useState)({}),[x,g]=(0,r.useState)(i||[]);(0,r.useEffect)(()=>{d(t),u(a)},[t,a]);const y=e=>{const t=x.filter(t=>t.toLowerCase().includes(e.query));g(t)},b=(e,t,a)=>{const{name:r,value:s}=e.target,l="params"===a?[...n]:[...c];l[t]=(0,o.A)((0,o.A)({},l[t]),{},{[r]:s}),"valueType"===r&&(l[t].value="date"===s?new Date:""),"params"===a?d(l):u(l)},w=()=>(0,se.jsx)("button",{title:"Delete Question Node",className:"w-full text-white bg-red-500 hover:bg-red-700 rounded flex items-center justify-center",onClick:()=>v(),children:"Close"}),v=()=>{let e=document.querySelector(".p-datepicker");e&&(e.style.visibility="hidden")},j=(e,t,a)=>(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-800 mb-2 py-2 ",children:[(0,se.jsx)("div",{className:"min-w-[200px] px-4 rounded ",children:(0,se.jsx)("div",{className:"form-group",children:(0,se.jsx)("span",{className:"text-white font-bold",children:"Key"})})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 rounded",children:(0,se.jsx)("div",{className:"form-group",children:(0,se.jsx)("span",{className:"text-white font-bold",children:"Value Type"})})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 bg-gray-800 rounded",children:(0,se.jsx)("div",{className:"form-group",children:(0,se.jsx)("span",{className:"text-white font-bold",children:"Value"})})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 bg-gray-800 rounded flex justify-end",children:(0,se.jsx)("div",{className:"form-group",children:(0,se.jsx)("span",{className:"text-white font-bold",children:"Delete"})})})]}),e.map((r,s)=>(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-2 bg-gray-800",children:[(0,se.jsx)("div",{className:"min-w-[200px] px-4 py-2 shadow-md rounded ",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("input",{title:"".concat(a," key"),placeholder:"".concat(a," key"),type:"text",maxLength:50,className:"w-full px-2 py-1 border border-gray-600 bg-gray-700 text-white rounded",name:"key",value:r.key,onChange:e=>b(e,s,t),onBlur:e=>{e.target.value}}),p["key-".concat(s)]&&(0,se.jsx)("small",{className:"text-red-500",children:p["key-".concat(s)]})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 py-2 shadow-md rounded",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsxs)("select",{title:"Value Type",value:r.valueType,onChange:e=>b(e,s,t),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",name:"valueType",children:[(0,se.jsx)("option",{value:"",children:"Select Value Type"}),m.d4.map(e=>(0,se.jsx)("option",{value:e.toLowerCase(),children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),p["valueType-".concat(s)]&&(0,se.jsx)("small",{className:"text-red-500",children:p["valueType-".concat(s)]})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 py-2 shadow-md bg-gray-800 rounded",children:(0,se.jsxs)("div",{className:"form-group",children:[(!r.valueType||"date"!==r.valueType&&"number"!==r.valueType&&"header"!==r.valueType&&"param"!==r.valueType)&&(0,se.jsx)("input",{title:"".concat(a," Value"),placeholder:"".concat(a," Value"),type:"text",maxLength:50,className:"w-full px-2 py-1 border border-gray-600 bg-gray-700 text-white rounded",name:"value",value:r.value,onChange:e=>b(e,s,t),onBlur:e=>{e.target.value}}),r.valueType&&"number"===r.valueType&&(0,se.jsx)("input",{title:"".concat(a," Value"),placeholder:"".concat(a," Value"),type:"number",maxLength:50,className:"appearance-none w-full px-2 py-1 border border-gray-600 bg-gray-700 text-white rounded",name:"value",value:r.value,onChange:e=>b(e,s,t),onBlur:e=>{e.target.value},style:{MozAppearance:"textfield"}}),r.valueType&&("date"===r.valueType||"time"===r.valueType)&&(0,se.jsx)(mt.V,{tooltipOptions:{position:"top"},showIcon:!0,placeholder:"Date",value:r.value||null,onChange:e=>b(e,s,t),showTime:r.valueType!==m.bh.DATE,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",timeOnly:m.bh.TIME===r.valueType,autoZIndex:!0,footerTemplate:w,showButtonBar:!0}),r.valueType&&("param"===r.valueType||"header"===r.valueType)&&(0,se.jsx)(Mt.j,{value:r.value,suggestions:x,completeMethod:y,onChange:e=>((e,t,a)=>{if("params"==a){const a=[...n];a[t]=(0,o.A)((0,o.A)({},a[t]),{},{value:e.target.value}),d(a)}else if("headers"==a){const a=[...c];a[t]=(0,o.A)((0,o.A)({},a[t]),{},{value:e.target.value}),u(a)}})(e,s,t),dropdown:!0}),p["value-".concat(s)]&&(0,se.jsx)("small",{className:"text-red-500",children:p["value-".concat(s)]})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-4 py-2 shadow-md bg-gray-800 rounded flex justify-end items-center",children:e.length&&(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold",onClick:e=>{e.stopPropagation(),((e,t)=>{const a="params"===t?n.filter((t,a)=>a!==e):c.filter((t,a)=>a!==e);"params"===t?d(a):u(a)})(s,t)},children:"\xd7"})})]},s)),(0,se.jsxs)("button",{className:"ml-1 px-3 py-1 font-semibold text-white btn-primary-custom rounded flex items-center",onClick:()=>(e=>{const t={key:"",valueType:"",value:""};"params"===e?d(e=>[...e,t]):u(e=>[...e,t])})(t),children:[(0,se.jsx)("svg",{className:"w-5 h-5 mr-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add ",a.slice(0,-1)]})]});return(0,se.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,se.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,se.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,se.jsx)("h5",{className:"modal-title text-lg font-bold",children:"HTTP Params"}),(0,se.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:l,children:"\xd7"})]})}),(0,se.jsxs)("div",{className:"overflow-y-auto p-4 mt-16 mb-20",children:[j(n,"params","Params"),j(c,"headers","Headers")]}),(0,se.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,se.jsxs)("div",{className:"modal-footer py-2 px-4 flex justify-start gap-2",children:[(0,se.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded",onClick:()=>{s(n,c)},children:[(0,se.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save"]}),(0,se.jsx)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded",onClick:()=>{s(n,c),l()},children:"Save & Close"})]})})]})},Ft=(0,r.memo)(Lt),St=["statusWiseFlow"],It=e=>{var t,a,s,i,n,d,c,u,p;let{id:h,data:x}=e;const{node:g,onDelete:y,handleChange:b,setNodes:w,nodes:v,edges:j}=x,[f,k]=(0,r.useState)((0,o.A)({},g.data)),[N,A]=(0,r.useState)(!1),[C,T]=(0,r.useState)([]);v.forEach(e=>"question"===e.type);const E=()=>{w(v.map(e=>(0,o.A)((0,o.A)({},e),{},{selected:!1})))};(0,r.useEffect)(()=>{const e=D(g.id,j,v),t=O(e);T(t)},[v]);const M=(e,t)=>{delete g.data.errors;const a=(0,o.A)((0,o.A)({},g.data),{},{[e]:t});k(a),b(g.id,a)},L=e=>{delete g.data.errors;const t=(0,o.A)((0,o.A)({},f),{},{[e]:[...f[e]||[],{key:"",valueType:"",value:""}]});k(t),b(g.id,t),A(!0)},F=(e,t)=>{var a,r;let s;delete g.data.errors,s="params"==t?null===(a=f.params)||void 0===a?void 0:a.filter((t,a)=>a!==e):null===(r=f.headers)||void 0===r?void 0:r.filter((t,a)=>a!==e);const l=(0,o.A)((0,o.A)({},f),{},{[t]:s});k(l),b(g.id,l)},S=()=>A(!1),I=()=>A(!0);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(null!==(t=g.data)&&void 0!==t&&t.errors&&Object.keys(g.data.errors).length?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center border-b py-1 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"HTTP Node"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:g.data.delay,onChange:M}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>y(h),children:"\xd7"})]})]}),(0,se.jsxs)("div",{className:"py-2 px-2",children:[(0,se.jsx)("div",{className:"mb-2",title:"Property Name",children:(0,se.jsx)("input",{type:"text",placeholder:"Property Name",value:f.property,onClick:E,onChange:e=>M("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsx)("div",{className:"mb-2",title:"Display Text",children:(0,se.jsx)("input",{type:"text",placeholder:"Display Text",value:f.displayText,onClick:E,onChange:e=>M("displayText",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsx)("div",{className:"mb-2",title:"URL",children:(0,se.jsx)("input",{type:"text",placeholder:"URL",value:f.url,onClick:E,onChange:e=>M("url",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsxs)("select",{title:"Request Type",value:f.requestType,onClick:E,onChange:e=>{delete g.data.errors;const t=e.target.value;M("requestType",t)},className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Request Type"}),m.$q.map(e=>(0,se.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})}),(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)(Re.A,{control:(0,se.jsx)(Et.A,{checked:f.hideData,onChange:e=>M("hideData",e.target.checked),color:"primary",sx:{"& .MuiSvgIcon-root":{fontSize:28}}}),label:"Hide Data",className:"text-white cursor-pointer"})}),f.params.map((e,t)=>{var a,r,s,o;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md mt-2 px-2 py-0.5 border border-gray-400 rounded-md",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",title:e.key||e.valueType||e.value?"".concat(e.key," - ").concat(null!==(a=e.valueType)&&void 0!==a?a:""," - ").concat(null!==(r=e.value)&&void 0!==r?r:""):"HTTP Request Param",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>I(),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{className:"text-sm grow min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:e.key||e.valueType||e.value?"".concat(e.key," - ").concat(null!==(s=e.valueType)&&void 0!==s?s:""," - ").concat(null!==(o=e.value)&&void 0!==o?o:""):"Param"})]})}),f.params.length&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2 w-[25px] w-[25px]",onClick:e=>{e.stopPropagation(),F(t,"params")},children:"\xd7"})})]})},t)}),(null===(a=g.data.errors)||void 0===a||null===(s=a.params)||void 0===s?void 0:s.length)>0&&(0,se.jsx)("small",{className:"text-red-500",children:"Errors in Params"}),(0,se.jsxs)("button",{className:"flex px-2 py-1 mt-2 text-xs font-semibold text-white btn-primary-custom rounded items-center mb-2",onClick:()=>L("params"),children:[(0,se.jsx)("svg",{className:"w-3 h-3 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add Param"]}),null===(i=f.headers)||void 0===i?void 0:i.map((e,t)=>{var a,r,s,o;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md mt-2 px-2 py-0.5 border border-gray-400 rounded-md",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",title:e.key||e.valueType||e.value?"".concat(e.key," - ").concat(null!==(a=e.valueType)&&void 0!==a?a:""," - ").concat(null!==(r=e.value)&&void 0!==r?r:""):"HTTP Request Param",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[(0,se.jsxs)("svg",{onClick:()=>I(),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{className:"text-sm grow min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:e.key||e.valueType||e.value?"".concat(e.key," - ").concat(null!==(s=e.valueType)&&void 0!==s?s:""," - ").concat(null!==(o=e.value)&&void 0!==o?o:""):"Header"})]})}),f.headers.length&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2 w-[25px] w-[25px]",onClick:e=>{e.stopPropagation(),F(t,"headers")},children:"\xd7"})})]})},t)}),(null===(n=g.data.errors)||void 0===n||null===(d=n.headers)||void 0===d?void 0:d.length)>0&&(0,se.jsx)("small",{className:"text-red-500",children:"Errors in Headers"}),(0,se.jsxs)("button",{className:"flex px-2 py-1 mt-2 text-xs font-semibold text-white btn-primary-custom rounded items-center mb-2",onClick:()=>L("headers"),children:[(0,se.jsx)("svg",{className:"w-3 h-3 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add Header"]}),(0,se.jsxs)("div",{className:"grid grid-cols-10 gap-2 mb-2 px-1 py-1 border border-gray-400 rounded-md relative",children:[(0,se.jsx)("div",{className:"col-span-10",title:"Success",children:(0,se.jsx)("input",{readOnly:!0,type:"text",value:"Success",onClick:E,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded capitalize"})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:f.successFlowId})]}),(0,se.jsxs)("div",{className:"grid grid-cols-10 gap-2 mb-2 px-1 py-1 border border-gray-400 rounded-md relative",children:[(0,se.jsx)("div",{className:"col-span-10",title:"Fail",children:(0,se.jsx)("input",{readOnly:!0,type:"text",value:"Fail",onClick:E,className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded capitalize"})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:f.failureFlowId})]}),null===(c=f.statusWiseFlow)||void 0===c?void 0:c.map((e,t)=>(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-2 px-1 py-1 border border-gray-400 rounded-md relative",children:[(0,se.jsx)("div",{className:"col-span-10",title:"Fail Status Message",children:(0,se.jsx)("input",{type:"text",placeholder:"Status Message",value:e.statusCode,onClick:E,onChange:e=>((e,t,a)=>{delete g.data.errors;const r=g.data,{statusWiseFlow:s}=r,l=(0,Fe.A)(r,St);s[e][t]=a;const i=(0,o.A)((0,o.A)({},l),{},{statusWiseFlow:s});k(i),b(g.id,i)})(t,"statusCode",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded capitalize"})}),(0,se.jsx)("div",{className:"col-span-2",title:"Delete",children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center w-[25px] w-[25px]",onClick:e=>{e.stopPropagation(),(e=>{var t;delete g.data.errors;const a=null===(t=f.statusWiseFlow)||void 0===t?void 0:t.filter((t,a)=>a!==e),r=(0,o.A)((0,o.A)({},f),{},{statusWiseFlow:a});k(r),b(g.id,r)})(t)},children:"\xd7"})}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:e.id})]},t)})),(null===(u=g.data.errors)||void 0===u||null===(p=u.statusWiseFlow)||void 0===p?void 0:p.length)>0&&(0,se.jsx)("small",{className:"text-red-500",children:"Errors in statusWiseFlow"}),(0,se.jsxs)("button",{className:"flex px-2 py-1 mt-2 text-xs font-semibold text-white btn-primary-custom rounded items-center mb-2",onClick:()=>{delete g.data.errors;const e={id:(0,Tt.OX)(),statusCode:""},t=(0,o.A)((0,o.A)({},f),{},{statusWiseFlow:[...f.statusWiseFlow||[],e]});k(t),b(g.id,t)},children:[(0,se.jsx)("svg",{className:"w-3 h-3 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add More Status"]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:h})]}),(0,se.jsx)(Ze.l,{header:"Edit HTTP Params",visible:N,style:{width:"600px"},onHide:S,children:(0,se.jsx)(Ft,{save:(e,t)=>{delete g.data.errors;const a=(0,o.A)((0,o.A)({},f),{},{params:e,headers:t});k(a),b(g.id,a)},paramsData:f.params||[],headerData:f.headers||[],close:S,properties:C})})]})},Dt=(0,r.memo)(It),Ot=e=>{var t;let{urlData:a,save:s,close:l}=e;const[i,n]=(0,r.useState)(a),[d,c]=(0,r.useState)({}),m=e=>{const{name:t,value:a}=e.target;n((0,o.A)((0,o.A)({},i),{},{[t]:a}))},u=(e,t)=>{const a=q(e,t);c(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},p=(e,t,a)=>{const r=q(t,a);c(a=>{var s;return(0,o.A)((0,o.A)({},a),{},{subUrl:(0,o.A)((0,o.A)({},a.subUrl),{},{[e]:(0,o.A)((0,o.A)({},null===(s=a.subOptions)||void 0===s?void 0:s[e]),{},{[t]:r})})})})},x=(e,t)=>{const{name:a,value:r}=t.target,s=[...i.subUrls],l=(0,o.A)({},s[e]);l[a]=r,s[e]=l,n((0,o.A)((0,o.A)({},i),{},{subUrls:s}))},g=(e,t)=>{const a=i.subUrls.find(t=>t.id===e);a&&(B(t)?a.leadEmailTo.includes(t)?c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"This email is already in Lead Email To."})})})}):(n((0,o.A)((0,o.A)({},i),{},{subUrls:i.subUrls.map(a=>a.id===e?(0,o.A)((0,o.A)({},a),{},{leadEmailCc:[...a.leadEmailCc,t]}):a)})),c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})})):c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})}))};return(0,se.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,se.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,se.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,se.jsx)("h5",{className:"modal-title text-lg font-bold",children:"Edit Options"}),(0,se.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:l,children:"\xd7"})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 mt-16 mb-20",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 mb-4",children:[(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Display Text"}),(0,se.jsx)("input",{title:"fieldLabel",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fieldLabel",value:i.fieldLabel,onChange:m,onBlur:e=>u("fieldLabel",e.target.value)}),d.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:d.fieldLabel})]})}),(0,se.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Property Name"}),(0,se.jsx)("input",{title:"Property",type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"property",value:i.property,onChange:m,onBlur:e=>u("property",e.target.value)}),d.property&&(0,se.jsx)("small",{className:"text-red-500",children:d.property})]})})]}),null===(t=i.subUrls)||void 0===t?void 0:t.map((e,t)=>{var a,r,s,l,m,u,h,y,b,w,v,j;const f=t===i.subUrls.length-1;return(0,se.jsxs)("div",{className:"accordion px-2 mb-2",children:[(0,se.jsxs)("div",{className:"accordion-header flex items-center p-1 border border-gray-600 rounded bg-gray-800 ".concat(f?"cursor-not-allowed":"cursor-pointer hover:bg-gray-700"," transition-colors"),onClick:()=>!f&&(e=>{if(e===i.subUrls.length-1)return;const t=i.subUrls.map((t,a)=>a===e?(0,o.A)((0,o.A)({},t),{},{isCollapsed:!t.isCollapsed}):t);n((0,o.A)((0,o.A)({},i),{},{subUrls:t}))})(t),children:[(0,se.jsx)("span",{className:"mr-3",children:f?(0,se.jsxs)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor"}),(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16v-4m0-4h.01"})]}):e.isCollapsed?(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,se.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,se.jsx)("span",{className:"flex-1",children:f?"Default":e.title||"Sub Option ".concat(t+1)}),!f&&i.subUrls.length>1&&(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold ml-4",onClick:e=>{e.stopPropagation(),(e=>{n((0,o.A)((0,o.A)({},i),{},{subUrls:i.subUrls.filter((t,a)=>a!==e)}))})(t)},children:"\xd7"})]}),!f&&!e.isCollapsed&&(0,se.jsx)("div",{className:"accordion-content bg-gray-700 p-2 rounded",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Url"}),(0,se.jsx)("input",{title:"Url",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"url",value:e.url,onChange:e=>x(t,e),onBlur:e=>p(t,"url",e.target.value)}),(null===(a=d.subOptions)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.url)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(s=d.subOptions[t])||void 0===s?void 0:s.url})]})}),(0,se.jsx)("div",{className:"min-w-[200px",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:e.isLink?"URL":"Value"}),(0,se.jsx)("input",{title:"Value",type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"value",value:e.value,onChange:e=>x(t,e),onBlur:e=>p(t,"value",e.target.value)}),(null===(l=d.subUrl)||void 0===l||null===(m=l[t])||void 0===m?void 0:m.value)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(u=d.subUrl[t])||void 0===u?void 0:u.value})]})}),!e.isLink&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:"Lead Email To"}),(0,se.jsx)("input",{title:"Lead Mail To",autoComplete:"off",maxLength:254,type:"text",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailTo",value:e.leadEmailTo,onChange:e=>x(t,e),onBlur:e=>p(t,"leadEmailTo",e.target.value)}),(null===(h=d.subUrl)||void 0===h||null===(y=h[t])||void 0===y?void 0:y.leadEmailTo)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(b=d.subUrl[t])||void 0===b?void 0:b.leadEmailTo})]})}),!e.isLink&&(0,se.jsx)("div",{className:"min-w-[200px]",children:(0,se.jsxs)("div",{className:"form-group",children:[(0,se.jsx)("label",{className:"input-label",children:" Lead Email Cc"}),(0,se.jsxs)("div",{className:"flex flex-wrap items-center border border-gray-600 rounded bg-gray-800",children:[e.leadEmailCc.map(t=>(0,se.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 text-sm rounded-full mr-2 mb-2 px-3 py-1",children:[t,(0,se.jsx)("button",{type:"button",onClick:()=>{return a=e.id,r=t,void n((0,o.A)((0,o.A)({},i),{},{subUrls:i.subUrls.map(e=>e.id===a?(0,o.A)((0,o.A)({},e),{},{leadEmailCc:e.leadEmailCc.filter(e=>e!==r)}):e)}));var a,r},className:"ml-2 text-red-500 hover:text-red-700 focus:outline-none",children:"\xd7"})]},t)),(0,se.jsx)("input",{title:"Lead Mail CC",style:{padding:"2px",height:"24px"},autoComplete:"off",placeholder:"Type or paste email addresses and press `Enter`",type:"text",className:"flex-grow border-none text-sm border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailCc",onBlur:e=>p(t,"leadEmailCc",e.target.value),onKeyDown:e=>((e,t)=>{if(["Enter","Tab",","].includes(t.key)){t.preventDefault();const a=t.currentTarget.value.trim();a&&(g(i.subUrls[e].id,a),t.currentTarget.value="")}})(t,e),onPaste:t=>((e,t)=>{t.preventDefault();const a=t.clipboardData.getData("text").split(/[ ,;]/).map(e=>e.trim()).filter(e=>""!==e),r=i.subUrls.find(t=>t.id===e);if(!r)return;if(a.filter(e=>!B(e)).length>0)return void c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Invalid email address"})})})});a.filter(e=>r.leadEmailTo.includes(e)).length>0?c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subUrl:(0,o.A)((0,o.A)({},t.subUrl),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subUrl)||void 0===a?void 0:a[e]),{},{leadEmailCc:"Some emails are already in Lead Email To"})})})}):(n((0,o.A)((0,o.A)({},i),{},{subUrls:i.subUrls.map(t=>t.id===e?(0,o.A)((0,o.A)({},t),{},{leadEmailCc:[...t.leadEmailCc,...a]}):t)})),c(t=>{var a;return(0,o.A)((0,o.A)({},t),{},{subOptions:(0,o.A)((0,o.A)({},t.subOptions),{},{[e]:(0,o.A)((0,o.A)({},null===(a=t.subOptions)||void 0===a?void 0:a[e]),{},{leadEmailCc:""})})})}))})(e.id,t)})]}),(null===(w=d.subUrl)||void 0===w||null===(v=w[t])||void 0===v?void 0:v.leadEmailCc)&&(0,se.jsx)("small",{className:"text-red-500",children:null===(j=d.subUrl[t])||void 0===j?void 0:j.leadEmailCc})]})})]})})]},t)}),(0,se.jsxs)("button",{className:"flex ml-2 px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{const e=[...i.subUrls],t=e.pop();e.push({id:h(),url:"",value:"",leadEmailTo:"",leadEmailCc:[]}),t&&e.push(t),n((0,o.A)((0,o.A)({},i),{},{subUrls:e}))},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]}),(0,se.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,se.jsxs)("div",{className:"modal-footer py-2 px-4 flex justify-start gap-2",children:[(0,se.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{s(i)},children:[(0,se.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save"]}),(0,se.jsx)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{i.subUrls.forEach(e=>{e.isCollapsed=!0}),s(i),l()},children:"Save & Close"})]})})]})},Bt=(0,r.memo)(Ot),Pt=e=>{let{subUrl:t,index:a,onDelete:r,expandToEdit:s,length:o}=e;const l=a===o-1;return(0,se.jsx)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{padding:"2px 10px",border:"1px solid grey",borderRadius:"4px"},children:(0,se.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",children:[(0,se.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,se.jsxs)("div",{className:"flex min-w-0",children:[l?(0,se.jsxs)("svg",{className:"min-w-4 w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor"}),(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16v-4m0-4h.01"})]}):(0,se.jsxs)("svg",{onClick:()=>s(a),className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,se.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,se.jsx)("strong",{title:l?"Default":t.url,className:"text-sm grow min-w-0 break-words truncate",children:l?"Default":t.url?"".concat(t.url):"Sub URL"})]})}),!l&&o>1&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2",onClick:e=>{e.stopPropagation(),r(a)},children:"\xd7"})})]})})},Ht=(0,r.memo)(Pt),zt=e=>{let{data:t,id:a}=e;const{node:s,onDelete:i,handleChange:n}=t,[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)({}),[g,y]=(0,r.useState)(s.data),[,b]=(0,r.useState)(s.data.message),w=(e,t)=>{const a=q(e,t);x(t=>(0,o.A)((0,o.A)({},t),{},{[e]:a}))},v=(e,t)=>{delete s.data.errors;const a=(0,o.A)((0,o.A)({},g),{},{[e]:t});y(a),n(s.id,a)},j=e=>{delete s.data.errors;const t=g.subUrls.filter((t,a)=>a!==e),a=(0,o.A)((0,o.A)({},g),{},{subUrls:t});y(a),n(s.id,a)},f=()=>c(!1),k=e=>{g.subUrls.forEach(e=>{e.isCollapsed=!0}),g.subUrls[e].isCollapsed=!1,c(!0)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(s.data&&s.data.errors&&Object.keys(s.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>u(!m),children:"URL"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:s.data.delay,onChange:v}),(0,se.jsx)("button",{className:"text-gray-400 hover:text-white mr-3",title:"Expand",onClick:()=>c(e=>!e),children:(0,se.jsx)("svg",{className:"w-4 h-4 text-blue-500 cursor-pointer hover:text-blue-700",fill:"white",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 242.133 242.133",children:(0,se.jsx)("path",{id:"XMLID_15_",d:"M227.133,83.033c8.283,0,15-6.716,15-15V15c0-8.284-6.717-15-15-15H174.1c-8.284,0-15,6.716-15,15 s6.716,15,15,15h16.82l-69.854,69.854L51.213,30h16.82c8.284,0,15-6.716,15-15s-6.716-15-15-15H15C6.717,0,0,6.716,0,15v53.033 c0,8.284,6.717,15,15,15c8.285,0,15-6.716,15-15v-16.82l69.854,69.854L30,190.92V174.1c0-8.284-6.715-15-15-15 c-8.283,0-15,6.716-15,15v53.033c0,8.284,6.717,15,15,15h53.033c8.284,0,15-6.716,15-15c0-8.284-6.716-15-15-15h-16.82 l69.854-69.854l69.854,69.854H174.1c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h53.033c8.283,0,15-6.716,15-15V174.1 c0-8.284-6.717-15-15-15c-8.285,0-15,6.716-15,15v16.82l-69.854-69.854l69.854-69.854v16.82 C212.133,76.317,218.848,83.033,227.133,83.033z"})})}),(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>i(a),children:"\xd7"})]})]}),!m&&(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Field Label",type:"text",maxLength:50,placeholder:"Field Label",value:g.fieldLabel,onChange:e=>v("fieldLabel",e.target.value),onBlur:e=>w("fieldLabel",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.fieldLabel&&(0,se.jsx)("small",{className:"text-red-500",children:p.fieldLabel})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Property Name",type:"text",maxLength:50,placeholder:"Property Name",value:g.property,onChange:e=>v("property",e.target.value),onBlur:e=>w("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.property&&(0,se.jsx)("small",{className:"text-red-500",children:p.property})]}),(0,se.jsx)($e.JY,{onDragEnd:e=>{const{source:t,destination:a}=e;if(!a)return;if(0===t.index||0===a.index)return;const r=Array.from(g.subUrls),[l]=r.splice(t.index,1);r.splice(a.index,0,l);const i=(0,o.A)((0,o.A)({},g),{},{subUrls:r});y(i),n(s.id,i)},children:(0,se.jsx)(et,{droppableId:"subUrls",children:e=>{var t;return(0,se.jsxs)("div",(0,o.A)((0,o.A)({},e.droppableProps),{},{ref:e.innerRef,className:"space-y-2",children:[null===g||void 0===g||null===(t=g.subUrls)||void 0===t?void 0:t.map((e,t)=>{const a=t===g.subUrls.length-1;return(0,se.jsxs)("div",{className:"nodrag relative subOption-wrapper",children:[(0,se.jsx)($e.sx,{draggableId:e.id,index:t,isDragDisabled:a,children:a=>(0,se.jsx)("div",(0,o.A)((0,o.A)((0,o.A)({ref:a.innerRef},a.draggableProps),a.dragHandleProps),{},{style:(0,o.A)((0,o.A)({},a.draggableProps.style),{},{left:"auto !important",top:"auto !important",width:"100%"}),children:(0,se.jsx)(Ht,{subUrl:e,index:t,onDelete:j,length:g.subUrls.length,expandToEdit:k},t)}))},e.id),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Right,id:e.id})]},t)}),e.placeholder]}))}})}),(0,se.jsxs)("button",{className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{delete s.data.errors;const e=[...g.subUrls||[]],t=e.pop(),a={id:h(),url:"",value:"",leadEmailTo:"",leadEmailCc:[],isCollapsed:!1};e.push(a),t&&e.push(t);const r=(0,o.A)((0,o.A)({},g),{},{subUrls:e});y(r),n(s.id,r),c(!0)},children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:a}),(0,se.jsx)(Ze.l,{header:"Header",visible:d,style:{width:"100vw"},onHide:()=>{d&&f()},children:(0,se.jsx)(Bt,{save:e=>{const t=(0,o.A)((0,o.A)({},e),{},{subUrls:e.subUrls.map(e=>(0,o.A)({},e))});b(Math.random().toString()),y(t),n(s.id,t)},urlData:g,close:f})})]})},Ut=(0,r.memo)(zt),Wt=e=>{var t,a,s,i,n,d,c;let{data:m,id:u}=e;const{node:p,onDelete:h,handleChange:x}=m,[g,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(p.data),v=(e,t)=>{delete p.data.errors;const a=(0,o.A)((0,o.A)({},b),{},{[e]:t});w(a),x(p.id,a)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg ".concat(p.data&&p.data.errors&&Object.keys(p.data.errors).length>0?"error-in-node":""),children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold cursor-pointer mr-3",onClick:()=>y(!g),children:"WhatsApp Flow"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ne,{value:p.data.delay,onChange:v}),(0,se.jsx)("div",{className:"flex",children:(0,se.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>h(u),children:"\xd7"})})]})]}),!g&&(0,se.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[(0,se.jsx)("div",{children:(0,se.jsx)("input",{title:"Field Label",type:"text",maxLength:50,placeholder:"Field Label",value:b.fieldLabel,onChange:e=>v("fieldLabel",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Property Name",type:"text",maxLength:50,placeholder:"Property Name",value:b.property,onChange:e=>v("property",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(t=Object.keys(p.data.errors))||void 0===t?void 0:t.length)>0&&p.data.errors.property&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.property})]}),(0,se.jsx)("div",{children:(0,se.jsx)("input",{title:"Header",type:"text",maxLength:100,placeholder:"Header",value:b.header,onChange:e=>v("header",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Body",type:"text",maxLength:200,placeholder:"Body",value:b.body,onChange:e=>v("body",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(a=Object.keys(p.data.errors))||void 0===a?void 0:a.length)>0&&p.data.errors.body&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.body})]}),(0,se.jsx)("div",{children:(0,se.jsx)("input",{title:"Footer",type:"text",maxLength:100,placeholder:"Footer",value:b.footer,onChange:e=>v("footer",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsx)("div",{children:(0,se.jsx)("input",{title:"Flow Token",type:"text",maxLength:200,placeholder:"Flow Token",value:b.flow_token,onChange:e=>v("flow_token",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Flow ID",type:"text",maxLength:100,placeholder:"Flow ID",value:b.flow_id,onChange:e=>v("flow_id",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(s=Object.keys(p.data.errors))||void 0===s?void 0:s.length)>0&&p.data.errors.flow_id&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.flow_id})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("select",{title:"Flow Action",value:b.flow_action,onChange:e=>v("flow_action",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,se.jsx)("option",{value:"",children:"Select Flow Action"}),(0,se.jsx)("option",{value:"navigate",children:"Navigate"}),(0,se.jsx)("option",{value:"data_exchange",children:"Data Exchange"})]}),p.data.errors&&(null===(i=Object.keys(p.data.errors))||void 0===i?void 0:i.length)>0&&p.data.errors.flow_action&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.flow_action})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"Submit Button",type:"text",maxLength:30,placeholder:"Submit Button (Max 30)",value:b.flow_cta,onChange:e=>v("flow_cta",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(n=Object.keys(p.data.errors))||void 0===n?void 0:n.length)>0&&p.data.errors.flow_cta&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.flow_cta})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("input",{title:"First Screen",type:"text",maxLength:100,placeholder:"First Screen",value:b.screen,onChange:e=>v("screen",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),p.data.errors&&(null===(d=Object.keys(p.data.errors))||void 0===d?void 0:d.length)>0&&p.data.errors.screen&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.screen})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("textarea",{rows:4,title:"Response Data",placeholder:"Response Data (JSON)",value:"object"===typeof b.responsedata?JSON.stringify(b.responsedata,null,2):b.responsedata,onChange:e=>v("responsedata",e.target.value),className:"nodrag w-full p-1 border border-gray-600 bg-gray-700 text-white rounded resize-none"}),p.data.errors&&(null===(c=Object.keys(p.data.errors))||void 0===c?void 0:c.length)>0&&p.data.errors.responsedata&&(0,se.jsx)("small",{className:"text-red-500",children:p.data.errors.responsedata})]})]})]}),(0,se.jsx)(l.h7,{type:"target",position:l.yX.Top,id:u}),(0,se.jsx)(l.h7,{type:"source",position:l.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},_t=(0,r.memo)(Wt);function Rt(e){let{id:t,sourceX:a,sourceY:r,targetX:s,targetY:o,sourcePosition:i,targetPosition:n,style:d={}}=e;const{setEdges:c}=(0,l.VH)(),[m,u,p]=(0,l.oN)({sourceX:a,sourceY:r,sourcePosition:i,targetX:s,targetY:o,targetPosition:n});return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("svg",{style:{position:"absolute"},children:(0,se.jsx)("defs",{children:(0,se.jsx)("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:(0,se.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#ff0073"})})})}),(0,se.jsx)(l.tE,{path:m,markerEnd:"url(#arrowhead)",style:d}),(0,se.jsx)(l.rV,{children:(0,se.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(u,"px,").concat(p,"px)"),fontSize:12,pointerEvents:"all"},className:"nodrag nopan",children:(0,se.jsx)("button",{className:"w-4 h-4 bg-gray-300 border border-gray-500 rounded-full text-xs font-bold text-gray-800 flex items-baseline justify-center hover:bg-red-600 hover:border-red-700 hover:text-white hover:shadow-md",onClick:()=>{c(e=>e.filter(e=>e.id!==t))},children:"\xd7"})})})]})}const qt=e=>{let{flowList:t,value:a,onChange:s}=e;(0,r.useEffect)(()=>{if(!a&&null!==t&&void 0!==t&&t.length){const e=t.find(e=>e.label.includes("Draft"));e&&s(e.value)}},[a,t,s]);return(0,se.jsxs)("div",{className:"pb-3",children:[(0,se.jsx)("label",{htmlFor:"dropdown",className:"text-xs",children:"Flows"}),(0,se.jsxs)("select",{id:"dropdown",className:"border w-full","aria-label":"Select Draft or Version to View and Modify",onChange:e=>s(e.target.value),value:a||"",children:[(0,se.jsx)("option",{value:"",children:"Select a flow"}),null===t||void 0===t?void 0:t.map(e=>(0,se.jsx)("option",{value:e.value,children:e.label},e.value))]})]})},Vt=(0,r.memo)(qt),Xt=e=>{let{onDragStart:t,clearFlow:a,onSave:r,errors:s,nodes:o,flowList:l,onFlowSelectionChange:i,onDelete:n,flowId:d,isSaveDisabled:c}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flow-tools",children:[(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"chatMedium"),draggable:!0,children:"Chat Medium"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"message"),draggable:!0,children:"Message"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"options"),draggable:!0,children:"Options"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"whatsappCarousel"),draggable:!0,children:"WApp Carousel"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"leadForm"),draggable:!0,children:"Lead Form"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"file"),draggable:!0,children:"File"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"map"),draggable:!0,children:"Maps"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"question"),draggable:!0,children:"Question"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"callConnect"),draggable:!0,children:"CallConnect"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"otp"),draggable:!0,children:"OTP"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"customForm"),draggable:!0,children:"Custom Form"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"http"),draggable:!0,children:"HTTP"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"url"),draggable:!0,children:"URL"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"whatsAppFlow"),draggable:!0,children:"WhatsApp Flow"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"gpt"),draggable:!0,children:"GPT Handler"}),(0,se.jsx)("button",{className:"button",onDragStart:e=>t(e,"stop"),draggable:!0,children:"Stop"})]}),(0,se.jsxs)("div",{className:"flow-actions",children:[(0,se.jsx)(Vt,{flowList:l,onChange:i,value:d}),(0,se.jsx)("button",{disabled:c,className:"px-2 py-2 bg-green-500 hover:bg-green-700 text-white font-bold rounded items-center text-center",onClick:()=>r(),children:"Save"}),(0,se.jsx)("button",{disabled:Object.keys(s).length>0||o.length<2,className:"px-2 py-2 bg-blue-500 hover:bg-blue-700 text-white font-bold rounded items-center text-center",onClick:()=>r(!0),children:"Deploy"}),(0,se.jsx)("button",{disabled:o.length<2,title:"Clear Board - Will delete all Nodes and Edges",className:"text-white bg-red-500 hover:bg-red-700 rounded h-8 w-8 flex items-center justify-center",onClick:()=>a(),children:"Clear"}),(0,se.jsx)("button",{disabled:!d,title:"Delete Flow",className:"text-white bg-red-500 hover:bg-red-700 rounded h-8 w-8 flex items-center justify-center hidden",onClick:()=>n(d),children:"Delete"})]})]})},Gt=r.memo(Xt),Qt=["isCollapsed"],Jt=(e,t)=>{const a=t.find(t=>t.sourceHandle===e);return(null===a||void 0===a?void 0:a.target)||""},Yt=(e,t)=>"number"===e?Number(t):"date"===e?new Date(e):t;var Zt=a(28535);const $t=e=>{let{onAccept:t,onReject:a}=e;return(0,se.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,se.jsx)("button",{className:"text-white px-2 bg-green-500 hover:bg-green-700 rounded h-8 flex items-center justify-center",onClick:a,children:"No"}),(0,se.jsx)("button",{className:"text-white bg-red-500 px-2 hover:bg-red-700 rounded h-8 flex items-center justify-center",onClick:t,autoFocus:!0,children:"Yes"})]})};var Kt=a(47751);function ea(e){const t=document.createElement("a");t.setAttribute("download","reactflow.png"),t.setAttribute("href",e),t.click()}const ta=1024;const aa=function(){const{getNodes:e}=(0,l.VH)();return(0,se.jsx)(l.Zk,{position:"top-right",children:(0,se.jsx)("button",{className:"download-btn",onClick:()=>{const t=(0,l.Jo)(e()),a=(0,l.R4)(t,ta,768,.5,2,20);(0,Kt.$E)(document.querySelector(".react-flow__viewport"),{backgroundColor:"#1a365d",width:ta,height:768,style:{width:"".concat(ta,"px"),height:"".concat(768,"px"),transform:"translate(".concat(a.x,"px, ").concat(a.y,"px) scale(").concat(a.zoom,")")}}).then(ea)},children:"Download Image"})})},ra=e=>{let{flowData:t,flowList:a,onSave:s,onVersionSelected:d,onDelete:c}=e;const m=(0,r.useMemo)(()=>({start:we,chatMedium:st,message:ce,options:at,whatsappCarousel:ct,leadForm:ue,leadFlow:he,gpt:ge,stop:ye,file:Ue,map:_e,question:pt,callConnect:yt,otp:vt,customForm:Ct,http:Dt,url:Ut,whatsAppFlow:_t}),[]),u=(0,r.useMemo)(()=>({custom:Rt}),[]),[p,g]=(0,r.useState)([]),[y,b]=(0,r.useState)([]),[w,v]=(0,r.useState)({}),[j,f]=(0,r.useState)(!0),[k,N]=(0,r.useState)(null),[A,C]=(0,r.useState)(!1),T=(0,r.useRef)(null),M=(0,r.useRef)(!1),L=(0,r.useRef)(""),F=(0,r.useRef)({}),D=(0,r.useRef)({}),O=()=>{v({})};(0,r.useEffect)(()=>{M.current&&t&&(M.current=!1,T.current&&T.current.show({severity:"success",summary:"Chatbot Flow",detail:"Chatbot Flow Design has been saved successfully",life:5e3}));const{flowNodes:e,flowEdges:a}=x(t);g(e),b(a)},[t]),(0,r.useEffect)(()=>{f(p.length<2||Object.keys(w).length>0)},[p,w,y]);const B=(0,r.useCallback)(e=>{O(),g(t=>(0,l._0)(e,t))},[]),_=(0,r.useCallback)(e=>{if("reset"===e[0].type&&!A&&D.current)return L.current="Edge Delete",D.current=e,void C(!0);O(),b(t=>(0,l.zW)(e,t))},[A]),R=e=>{O(),b(t=>(0,l.zW)(e,t))},q=(0,r.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),G=(0,r.useCallback)(e=>{if(!k)return void console.error("React Flow instance is not initialized yet.");if(O(),e.preventDefault(),!e.dataTransfer.getData("application/reactflow"))return;const t=((e,t)=>{const a=e.dataTransfer.getData("application/reactflow");return(0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)({id:h(),type:a,position:t,data:{message:""}},"options"===a&&{data:{delay:1,fieldLabel:"",property:"",message:"",fallback:"",subOptions:[{id:h(),title:"",subTitle:"",value:"",leadEmailTo:"",leadEmailCc:[],category:"",description:"",googleTagManagerPayload:[],isCollapsed:!0,isLink:!1}]}}),"whatsappCarousel"===a&&{data:{delay:1,flowId:"",nextFlowId:"",type:"whatsappCarousel",property:"",fieldLabel:"",meta:{cardHeaderType:"",wbTemplateId:"",contentParams:[]},cards:[{id:h(),link:"",value:"",category:"",leadEmailTo:"",leadEmailCc:[],postbackTexts:[],isCollapsed:!0}]}}),"file"===a&&{data:{delay:1,message:"",fileType:"pdf",urls:[],files:[]}}),"map"===a&&{data:{delay:1,message:"",url:""}}),"leadForm"===a&&{data:{message:"This will display lead form for the visitor"}}),"gpt"===a&&{data:{message:"From here on visitors would be handled by GPT"}}),"question"===a&&{data:{delay:1,message:"",fieldLabel:"",property:"",type:"",meta:{min:"",max:"",regex:"",errorMessage:""}}}),"http"===a&&{data:{delay:1,propertyName:"",displayText:"",url:"",requestType:"",hideData:!1,params:[],headers:[],successFlowId:h(),failureFlowId:h(),statusWiseFlow:[]}}),"callConnect"===a&&{data:{delay:1,message:"",meta:{callConnectId:"",callAccepted:"",callRejected:"",successMessage:"",failureMessage:""},callAcceptedId:h(),callRejectedId:h()}}),"otp"===a&&{data:{delay:1,message:"",meta:{otpType:""}}}),"customForm"===a&&{data:{delay:1,property:"",message:"",customFields:[{id:h(),title:"",property:"",fieldType:"",isCollapsed:!0}]}}),"url"===a&&{data:{delay:1,fieldLabel:"",property:"",subUrls:[{id:h(),url:"Default",value:"NA",leadEmailTo:"",leadEmailCc:[],isCollapsed:!0}]}}),"whatsAppFlow"===a&&{data:{delay:1,fieldLabel:"",property:"",header:"",body:"",footer:"",flow_token:"",flow_id:"",flow_action:"navigate",flow_cta:"",screen:"",responsedata:""}}),"chatMedium"===a&&{data:{delay:1,message:"",chatMedium:[{id:"web",value:"Web"},{id:"whatsapp",value:"Whatsapp"}]}})})(e,null===k||void 0===k?void 0:k.screenToFlowPosition({x:e.clientX,y:e.clientY}));g(e=>e.concat(t))},[k]),Y=(0,r.useCallback)(e=>{O(),g(t=>t.filter(t=>t.id!==e)),b(t=>t.filter(t=>t.source!==e&&t.target!==e))},[]),Z=e=>{if(!A&&e)return L.current="Node Delete",F.current=e,void C(!0)},K=(0,r.useCallback)(e=>{if("Delete"===e.key){const e=p.filter(e=>e.selected),t=y.filter(e=>e.selected);if(!A&&e.length>0)return L.current="Node Delete",F.current=e[0].id,void C(!0);if(!A&&t.length>0)return L.current="Edge Delete",D.current=t,void C(!0);e.length>0&&(Y(e[0].id),b(t=>t.filter(t=>!e.some(e=>e.id===t.source||e.id===t.target)))),t.length>0&&b(e=>e.filter(e=>!t.includes(e)))}},[p,y,A,Y]),te=(0,r.useCallback)(e=>{O(),b(e.reduce((e,t)=>{const a=(0,l.FB)(t,p,y),r=(0,l.RM)(t,p,y),s=(0,l.AX)([t],y);return[...e.filter(e=>!s.includes(e)),...a.flatMap(e=>{let{id:t}=e;return r.map(e=>{let{id:a}=e;return{id:"".concat(t,"->").concat(a),source:t,target:a}})})]},y))},[p,y]),re=e=>{if(p.length<2){const e={MinNodes:"Minimum 2 nodes required for a valid flow"};return v(e),!1}let a={},r={};for(const t of p)if("message"===t.type){const e=P(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("options"===t.type){const e=H(t,t.data,p,y);a=(0,o.A)((0,o.A)({},a),e)}else if("url"===t.type){const e=z(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("whatsAppFlow"===t.type){const e=X(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("whatsappCarousel"===t.type){const e=ee(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("file"===t.type){const e=U(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("map"===t.type){const e=W(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("question"===t.type){const e=V(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("callConnect"===t.type){const e=Q(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("otp"===t.type){const e=J(t.data);a=(0,o.A)((0,o.A)({},a),e)}else if("http"===t.type){const{newErrors:e,newWarnings:s}=$(t,p,y);a=(0,o.A)((0,o.A)({},a),e),r=(0,o.A)({},s)}if(Object.keys(a).length>0){v(a);const e=Object.values(a);return T.current&&T.current.show(e.map(e=>({severity:"error",summary:"Error",detail:e,life:3100}))),g(p),void f(!0)}if(e&&Object.keys(r).length>0){const e=Object.values(r);return T.current&&T.current.show(e.map(e=>({severity:"warn",summary:"Warning",detail:e,life:3100}))),void f(!0)}const l={nodes:p,edges:y},i=(e=>e.map(e=>{let{id:t,type:a,data:r,position:s}=e;return r.subOptions&&(r.subOptions=r.subOptions.map(e=>{const{isCollapsed:t}=e;return(0,Fe.A)(e,Qt)})),{id:t,type:a,data:r,position:s}}))(p);l.nodes=i;const n=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.slice(1);let s=[];const l=e.find(e=>"start"===e.type),i=t.find(e=>e.source===(null===l||void 0===l?void 0:l.id)),n=i?i.target:"",d=r.map(e=>{var a;const r=t.find(t=>t.source===e.id),l=r?r.target:null,i={flowId:e.id,nextFlowId:"options"!==e.type&&"whatsappCarousel"!==e.type&&"http"!==e.type&&"url"!==e.type&&"chatMedium"!==e.type?l:"",type:e.type,content:(null===(a=e.data.message)||void 0===a?void 0:a.trim())||""};var n,d,c,m,u;if("options"!==e.type&&"question"!==e.type&&"url"!==e.type&&"whatsappCarousel"!==e.type&&"whatsAppFlow"!==e.type||(i.fieldLabel=null===(n=e.data.fieldLabel)||void 0===n?void 0:n.trim()),"options"!==e.type&&"question"!==e.type&&"http"!==e.type&&"customForm"!==e.type&&"url"!==e.type&&"whatsappCarousel"!==e.type&&"whatsAppFlow"!==e.type||(i.property=null===(d=e.data.property)||void 0===d?void 0:d.trim()),"options"!==e.type&&"question"!==e.type&&"http"!==e.type&&"customForm"!==e.type&&"url"!==e.type&&"whatsAppFlow"!==e.type&&"whatsappCarousel"!==e.type&&"chatMedium"!==e.type&&"file"!==e.type&&"map"!==e.type&&"message"!==e.type&&"otp"!==e.type||(i.delay=e.data.delay),"options"===e.type&&(i.meta={fallback:null===(c=e.data.fallback)||void 0===c?void 0:c.trim(),dataSource:null===(m=e.data.dataSource)||void 0===m?void 0:m.trim()}),"whatsappCarousel"===e.type&&(i.meta={cardHeaderType:e.data.cardHeaderType,wbTemplateId:e.data.wbTemplateId,contentParams:e.data.contentParams}),"file"===e.type){const t=(e=>"application/pdf"===e||"pdf"===e?"pdf":e.startsWith("image/")?"image":e.startsWith("video/")?"video":"unknown")(e.data.fileType);e.data.files.length>0?i.meta={type:t,media:e.data.files.map(e=>{var t,a;return{name:e.name||"Unnamed file",url:(null===(t=e.url)||void 0===t?void 0:t.trim())||"",type:E(null===(a=e.url)||void 0===a?void 0:a.trim())}})}:i.meta={type:t,media:e.data.urls.map(e=>({url:(null===e||void 0===e?void 0:e.trim())||"",type:E(null===e||void 0===e?void 0:e.trim())}))}}if("map"===e.type&&e.data.url&&(i.meta={url:null===(u=e.data.url)||void 0===u?void 0:u.trim()}),"question"===e.type){if("number"===e.data.fieldType||"string"===e.data.fieldType||"age"===e.data.fieldType)i.meta={min:e.data.min?parseInt(e.data.min):e.data.min,max:e.data.max?parseInt(e.data.max):e.data.max,type:e.data.fieldType};else if("date"===e.data.fieldType)i.meta={min:e.data.min?S(e.data.min,!0):e.data.min,max:e.data.max?S(e.data.max,!1,!0):e.data.min,type:e.data.fieldType};else if("datetime"===e.data.fieldType)i.meta={min:e.data.min?S(e.data.min):e.data.min,max:e.data.max?S(e.data.max):e.data.min,type:e.data.fieldType};else if("time"===e.data.fieldType)i.meta={min:I(e.data.min),max:I(e.data.max),type:e.data.fieldType};else if("custom"===e.data.fieldType){var p;i.meta={custom:null===(p=e.data.custom)||void 0===p?void 0:p.trim(),type:e.data.fieldType}}else i.meta={type:e.data.fieldType};i.meta.dateFormat=e.data.dateFormat||"",i.meta.errorMessage=e.data.errorMessage||""}if(e.data.subOptions&&(i.children=e.data.subOptions.map(e=>{var a,r,s,o,l,i,n;const d=t.find(t=>t.sourceHandle===e.id);return{id:e.id,flowId:e.id,isLink:e.isLink,title:null===(a=e.title)||void 0===a?void 0:a.trim(),subTitle:null===(r=e.subTitle)||void 0===r?void 0:r.trim(),imageUrl:null===(s=e.imageUrl)||void 0===s?void 0:s.trim(),value:null===(o=e.value)||void 0===o?void 0:o.trim(),category:null===(l=e.category)||void 0===l?void 0:l.trim(),description:e.description,googleTagManagerPayload:e.googleTagManagerPayload,selectedMOG:(null===(i=e.selectedMOG)||void 0===i?void 0:i.trim())||"",leadEmailTo:null===(n=e.leadEmailTo)||void 0===n?void 0:n.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],nextFlowId:d?d.target:void 0}})),e.data.cards)if(e.data.cards.some(e=>e.postbackTexts&&e.postbackTexts.length>0))i.children=e.data.cards.map(e=>{if(e.postbackTexts&&e.postbackTexts.length>0){var a,r,s,l;const i=e.postbackTexts.map(a=>{const r=t.find(t=>t.sourceHandle==="".concat(e.id,"-btn-").concat(a.index));return(0,o.A)((0,o.A)({},a),{},{nextFlowId:r?r.target:void 0})});return{id:e.id,link:null===(a=e.link)||void 0===a?void 0:a.trim(),value:null===(r=e.value)||void 0===r?void 0:r.trim(),category:null===(s=e.category)||void 0===s?void 0:s.trim(),leadEmailTo:null===(l=e.leadEmailTo)||void 0===l?void 0:l.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],postbackTexts:i||[]}}var i,n,d,c;return{id:e.id,link:null===(i=e.link)||void 0===i?void 0:i.trim(),value:null===(n=e.value)||void 0===n?void 0:n.trim(),category:null===(d=e.category)||void 0===d?void 0:d.trim(),leadEmailTo:null===(c=e.leadEmailTo)||void 0===c?void 0:c.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],postbackTexts:[]}});else{const a=t.find(t=>t.sourceHandle==="".concat(e.id,"-default"));a&&(i.nextFlowId=a.target),i.children=e.data.cards.map(e=>{var t,a,r,s;return{id:e.id,link:null===(t=e.link)||void 0===t?void 0:t.trim(),value:null===(a=e.value)||void 0===a?void 0:a.trim(),category:null===(r=e.category)||void 0===r?void 0:r.trim(),leadEmailTo:null===(s=e.leadEmailTo)||void 0===s?void 0:s.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],postbackTexts:[]}})}if(e.data.subUrls&&(i.children=e.data.subUrls.map(e=>{var a,r,s;const o=t.find(t=>t.sourceHandle===e.id);return{id:e.id,flowId:e.id,url:null===(a=e.url)||void 0===a?void 0:a.trim(),value:null===(r=e.value)||void 0===r?void 0:r.trim(),leadEmailTo:null===(s=e.leadEmailTo)||void 0===s?void 0:s.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],nextFlowId:o?o.target:void 0}})),"http"===e.type){if(i.meta={displayText:e.data.displayText,requestType:e.data.requestType,hideData:e.data.hideData,url:e.data.url,successFlowId:Jt(e.data.successFlowId,t),failureFlowId:Jt(e.data.failureFlowId,t)},e.data.params.length>0){const t=e.data.params.map(e=>({key:e.key,valueType:e.valueType,value:Yt(e.valueType,e.value)}));i.meta.params=t}if(e.data.headers.length>0){const t=e.data.headers.map(e=>({key:e.key,valueType:e.valueType,value:Yt(e.valueType,e.value)}));i.meta.headers=t}if(e.data.statusWiseFlow.length>0){const a=e.data.statusWiseFlow.map(e=>{const a=t.find(t=>t.sourceHandle===e.id);return{statusCode:e.statusCode,flowId:e.id,nextFlowId:a?a.target:void 0}});i.meta.statusWiseFlowId=a}}return"callConnect"===e.type&&(i.content=e.data.message,i.meta={callConnectId:e.data.callConnectId,callAccepted:e.data.callAccepted,callRejected:e.data.callRejected,successMessage:e.data.successMessage,failureMessage:e.data.failureMessage}),"otp"===e.type&&(i.content=e.data.message,i.meta={otpType:e.data.otpType}),"customForm"===e.type&&(i.property=e.data.property,i.content=e.data.message,i.meta={customFields:e.data.customFields}),"url"===e.type&&(i.property=e.data.property,i.meta={subUrls:e.data.subUrls}),"whatsAppFlow"===e.type&&(i.meta={header:e.data.header,body:e.data.body,footer:e.data.footer,flow_token:e.data.flow_token,flow_id:e.data.flow_id,flow_action:e.data.flow_action,flow_cta:e.data.flow_cta,screen:e.data.screen,responsedata:e.data.responsedata}),"chatMedium"===e.type&&(i.meta={chatMedium:e.data.chatMedium.map(e=>{var a;const r=t.find(t=>t.sourceHandle===e.id);return{id:e.id,value:null===(a=e.value)||void 0===a?void 0:a.trim(),nextFlowId:r?r.target:void 0}})}),s.push({nodeId:e.id,position:e.position}),i});return{_id:a._id||"",organizationId:a.organizationId||"",botId:a.botId||"",createdAt:(new Date).toISOString(),version:0,startFlowId:n,flows:d,__v:0,deployedAt:(new Date).toISOString(),modifiedAt:(new Date).toISOString(),positions:s}}(i,y,t);M.current=!0,s(n,e)};return(0,r.useEffect)(()=>{const e=document.getElementById("reactflow-wrap");return e&&e.addEventListener("keydown",K),()=>{e&&e.removeEventListener("keydown",K)}},[K]),(0,se.jsxs)(Zt.mD,{children:[(0,se.jsxs)("div",{className:"flow-diagram",children:[(0,se.jsx)("div",{id:"reactflow-wrap",className:"reactflow-wrapper",children:(0,se.jsx)("div",{className:"flex flex-col h-full",children:(0,se.jsx)("div",{className:"reactflow-box",onDrop:G,onDragOver:q,children:(0,se.jsx)(l.Ln,{children:(0,se.jsxs)(l.Gc,{nodes:p.map(e=>(0,o.A)((0,o.A)({},e),{},{data:{node:e,nodes:p,handleChange:(e,t)=>((e,t)=>{O();const a=p.map(a=>a.id===e?(0,o.A)((0,o.A)({},a),{},{selected:!1,data:(0,o.A)((0,o.A)({},a.data),t)}):(0,o.A)((0,o.A)({},a),{},{selected:!1}));g(a)})(e,t),onDelete:Z,edges:y,updateEdges:R,setNodes:g}})),edges:y,onInit:N,onNodesChange:B,onEdgesChange:_,onConnect:e=>{O(),b(t=>{const a=t.filter(t=>{const a=t.source===e.source,r=t.sourceHandle===e.sourceHandle;return!a||t.sourceHandle&&!r});return(0,l.rN)((0,o.A)((0,o.A)({},e),{},{type:"custom"}),a)})},nodeTypes:m,edgeTypes:u,onNodesDelete:te,children:[(0,se.jsx)(i.H,{}),(0,se.jsx)(n.V,{}),(0,se.jsx)(aa,{})]})})})})}),(0,se.jsx)(ae.y,{ref:T}),(0,se.jsx)("div",{className:"toolbar",children:(0,se.jsx)(Gt,{onDragStart:(e,t)=>{e.dataTransfer.setData("application/reactflow",t)},clearFlow:()=>{L.current="",C(!0)},onSave:e=>re(e),errors:w,nodes:p,flowList:a,onFlowSelectionChange:d,flowId:null===t||void 0===t?void 0:t._id,onDelete:()=>{c(t)},flowData:t,isSaveDisabled:j})})]}),(0,se.jsx)(Ze.l,{header:"Confirmation",visible:A,style:{width:"25vw"},onHide:()=>C(!1),footer:(0,se.jsx)($t,{onAccept:()=>{const{flowNodes:e}=x(),t=y.filter(e=>e.selected);return"Node Delete"==L.current?(Y(F.current),void C(!1)):"Edge Delete"===L.current?(D.current.length>0&&b(e=>e.filter(e=>!t.includes(e))),void C(!1)):(g([e[0]]),b([]),void C(!1))},onReject:()=>C(!1)}),children:(0,se.jsx)("p",{className:"mb-3 text-red",children:"Are you Sure that you want to proceed?"})})]})};var sa=a(47851),oa=a(46704),la=a(31739),ia=a(74250);const na=()=>{};const da=function(e){let{flowId:t,flow:a}=e;const[,o]=(0,Ve.G)(),[l,i]=r.useState();return r.useEffect(()=>{if(t)return async function(){const e=await(0,s.Jc)(t);i(e)}(),()=>(0,ia.oy)();i(null)},[t,a]),o?(0,se.jsx)(sa.A,{botDetails:o,botDesign:o.botDesign,startupFlow:l,autoLaunch:!1,recipientId:(0,la.J)(),onReceiveChatResponse:na,onCallback:la.u}):(0,se.jsx)(oa.A,{})};a(73907),a(63363);function ca(){const[e,t]=r.useState(null),[a,o]=r.useState(),[l,i]=r.useState(""),n=r.useRef({flow:a});n.current.flow=a;const d=r.useCallback(()=>{(0,s.Ek)().then(e=>{var a;t(e),i((null===(a=e[0])||void 0===a?void 0:a.value)||"")})},[]);r.useEffect(d,[d]),r.useEffect(()=>{var e;l&&(null===(e=n.current.flow)||void 0===e?void 0:e._id)!==l&&(0,s.EO)(l).then(o)},[l]);const c=r.useCallback(async(e,t)=>{const a=await(0,s.EZ)(e.organizationId,e.botId,e,!0===t);i(a._id),o(a),d()},[d]),m=r.useCallback(async e=>{await(0,s.C7)(e.organizationId,e.botId,e._id)&&(t(null),i(""),d())},[d]);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ra,{flowData:a,flowList:e,onSave:c,onVersionSelected:i,onDelete:m}),(0,se.jsx)(da,{flowId:l,flow:a})]})}},28564(e,t,a){a.d(t,{C7:()=>d,CC:()=>m,EO:()=>o,EZ:()=>n,Ek:()=>c,Gl:()=>l,Jc:()=>i});var r=a(33340),s=a(8478);async function o(e){const{selectedBotId:t,organizationId:a}=r.nc.getState();return await l(a,t,e)}async function l(e,t,a){return await s.Jt("/bot/".concat(e,"/").concat(t,"/chat-flow/").concat(a))}async function i(e){try{const{selectedBotId:t,organizationId:a}=r.nc.getState(),o=await s.Jt("/bot/".concat(a,"/").concat(t,"/chat-flow/").concat(e,"/startup"));if("string"===typeof o&&o.startsWith("<"))throw new Error("Invalid JSON response, received HTML");return o}catch(t){return console.error("Error fetching startup with Flow ID:",t),null}}async function n(e,t,a){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const l=r.nc.getState();e||(e=l.organizationId),t||(t=l.selectedBotId);const i="/bot/".concat(e,"/").concat(t,"/chat-flow").concat(o?"?deploy=true":"");return await s.bE(i,a)}async function d(e,t,a){return await s.TF("/bot/".concat(e,"/").concat(t,"/chat-flow/").concat(a))}async function c(){const{selectedBotId:e,organizationId:t}=r.nc.getState();return(await s.Jt("/bot/".concat(t,"/").concat(e,"/chat-flow"))).map(m).sort((e,t)=>e.label.includes("Draft")?-1:t.label.includes("Draft")?1:0)}function m(e){return{value:e._id,label:"v".concat(e.version," - ").concat(e.deployedAt?"Deployed":"Draft")}}},43983(e,t,a){a.d(t,{Ay:()=>d,Yl:()=>i,qo:()=>n,u4:()=>m,uV:()=>c});var r=a(89379),s=a(8478),o=a(33340),l=a(97601);async function i(e){const t=await s.Jt("/integrations/".concat(e.organizationId,"/").concat(e.botId,"/list")),{botId:a}=e;((e,t)=>{o.nc.setState(a=>{const s=a.botsList.map(a=>a._id===e?(0,r.A)((0,r.A)({},a),{},{integrations:t}):a);return(0,r.A)((0,r.A)({},a),{},{botsList:s})})})(a,t)}async function n(e){const t=await s.TF("/integrations/".concat(e.organizationId,"/").concat(e.botId,"/").concat(e._id),e);try{await i(e)}catch(a){(0,l.i)(!0,"Not able to fetch all integrations. Try after sometime!","error")}return t}async function d(e){const t=await s.bE("/integrations/".concat(e.organizationId,"/").concat(e.botId,"/crm-callback-integration"),e),a={organizationId:t.organizationId,botId:t.botId};try{await i(a)}catch(r){(0,l.i)(!0,"Not able to fetch all integrations. Try after sometime!","error")}}async function c(e){const t=await s.bE("/integrations/".concat(e.organizationId,"/").concat(e.botId),e),a={organizationId:t.organizationId,botId:t.botId};try{await i(a)}catch(r){(0,l.i)(!0,"Not able to fetch all integrations. Try after sometime!","error")}}async function m(e){const{organizationId:t,selectedBotId:a}=o.nc.getState();await s.bE("/integrations/".concat(t,"/").concat(a,"/whatsapp"),e);try{await i({organizationId:t,botId:a})}catch(r){(0,l.i)(!0,"Not able to fetch all integrations. Try after sometime!","error")}}}}]);