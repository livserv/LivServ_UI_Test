"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[7597],{3602:(e,t,n)=>{n.d(t,{Ay:()=>u});var a=n(9950),r=n(59051),i=n.n(r),o=n(32796),s=(n(52010),n(44414));const l=["This month","One month","Prev month","This week","Last 7 days","Prev week","Prev 2 weeks","Last 14 days"];function c(){return{"This month":[i()().startOf("month").toDate(),i()().endOf("month").toDate()],"One month":[i()().subtract(1,"months").toDate(),i()().toDate()],"Prev month":[i()().subtract(1,"months").startOf("month").toDate(),i()().subtract(1,"months").endOf("month").toDate()],"This week":[i()().startOf("week").toDate(),i()().endOf("week").toDate()],"Last 7 days":[i()().subtract(6,"days").toDate(),i()().toDate()],"Prev week":[i()().subtract(1,"weeks").startOf("week").toDate(),i()().subtract(1,"weeks").endOf("week").toDate()]}}function d(e){const t=a.useMemo(c,[]),{timePicker24Hour:n,displayFormat:r}=function(e){let t=d.defaultTimeFormat||" hh:mm tt";const n=-1===t.indexOf("tt");t=t.replace("tt","A").replace(".ss","").replace(":ss","");const a=e.dateFormat||`DD-MMM-YYYY${e.showTime?t:""}`;return{timePicker24Hour:n,displayFormat:a}}(e),{value:u,range:v}=e,[x,g]=a.useState(()=>h(u,v,r)),f=a.useCallback(e=>g(t=>({...t,...e})),[g]),A=a.useRef(),y=a.useRef({props:e,state:x,displayFormat:r});y.current.state=x,y.current.props=e,y.current.displayFormat=r;const b=a.useCallback(()=>f(h(u,v,y.current.displayFormat)),[u,v,f]);a.useEffect(()=>{b()},[b]);const j=a.useCallback((e,t)=>{var n,a;const{props:r,displayFormat:i}=y.current;y.current.manuallyEdited=!1;const{range:o,field:s,args:c}=r;let d=t.startDate,u=null===(n=d)||void 0===n?void 0:n.toDate(),h="";if(o){const{chosenLabel:e,startDate:n,endDate:a}=t;if(n&&a){u={fromDate:n.toDate(),toDate:a.toDate()};const t=l.indexOf(e);t>=0&&(u.quickDate=t),h=`${n.format(i)} - ${a.format(i)}`,d=[u.fromDate,u.toDate]}}else null!==(a=d)&&void 0!==a&&a.isValid()&&(h=d.format(i));f({value:d,displayDate:h}),r.onChange(u,s,c)},[f]),D=a.useCallback(e=>{const{manuallyEdited:t,props:n,state:a,displayFormat:r}=y.current;if(t){let{target:{value:t}}=e;if(t=t.trim(),!t&&!0===n.allowClear)return void j(null,{startDate:null});let o=i()(t,r);o.isValid()||(o=i()(t)),o.isValid()&&o.format(r)===t||(o=a.value),A.setStartDate(o),A.setEndDate(o),j(null,{fromDate:o})}else null!==e&&void 0!==e&&e.currentTarget&&n.onBlur&&n.onBlur(e)},[j]),_=a.useCallback(e=>{const{props:t}=y.current,{keyCode:n}=e;13===n?D(e):t.onKeyDown&&(27===n&&(b(t),y.current.manuallyEdited=!1),t.onKeyDown(e))},[D,b]),S=a.useCallback(()=>y.current.manuallyEdited=!0,[]),{disabled:P,style:w,className:E,autoFocus:C,fullWidth:T}=e,{displayDate:k}=x;return(0,s.jsx)("div",{className:"react-bootstrap-daterangepicker-container "+(E||""),children:(0,s.jsx)(o.A,{ref:A,style:w,className:E,disabled:P,initialSettings:p({timePicker24Hour:n,dateRange:t,props:e,state:x}),onApply:j,children:(0,s.jsx)("span",{children:(0,s.jsx)("input",{type:"text",className:"date-range-ctl",value:k,readOnly:v,placeholder:m(e),autoFocus:C,onChange:v?void 0:S,onBlur:v?void 0:D,onKeyDown:_,style:T?{width:"100%",height:"40px"}:null})})})})}const u=d;function h(e,t,n){const a={displayDate:""};return e?t?"object"===typeof e&&(e=e.quickDate>=0?function(e,t){if(0===e||e>0){const n=c(),a=l[e],r=a&&n[a]||[];return t?r.map(e=>i()(e)):r}}(e.quickDate,!0):"object"===typeof e&&e.fromDate?[i()(e.fromDate),i()(e.toDate)||null]:[],a.value=e,e[0]&&e[1]&&(a.displayDate=`${e[0].format(n)} - ${e[1].format(n)}`)):(a.value=i()(e),a.displayDate=a.value.format(n)):t&&(a.value=[]),a}function m(e){const{range:t}=e;let{placeholder:n}=e;return!0===t&&(n=n||"Select a date range"),n||"Select a date"}function p(e){let{dateRange:t,timePicker24Hour:n,props:{showTime:a,range:r,minDate:i,maxDate:o,maxSpan:s=6},state:{value:l}}=e;const c={showDropdowns:!0,timePicker:a||!1,alwaysShowCalendars:!1,maxSpan:s,autoApply:!0,linkedCalendars:!1,autoUpdateInput:!1,minDate:i,maxDate:o};let d=null;return d=r?{...c,fromDate:l[0],toDate:l[1],ranges:t,singleDatePicker:!1,showCustomRangeLabel:!0}:{...c,singleDatePicker:!0,fromDate:l,toDate:l,timePicker24Hour:n},d}},8478:(e,t,n)=>{n.d(t,{Jt:()=>i,TF:()=>l,bE:()=>o,yJ:()=>s});var a=n(32026),r=n(44364);async function i(e,t){return c("GET",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function o(e,t){return c("POST",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function s(e,t){return c("PUT",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function l(e,t){return c("DELETE",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function c(e,t,n){let{headers:a,noAuth:r,...i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o="POST"===e||"PUT"===e||"DELETE"===e;t=function(e,t){if(!e)return e;const n=t&&Object.keys(t);if(null!==n&&void 0!==n&&n.length){const a=n.reduce((e,n)=>{let a=t[n];return null===a||void 0===a?e:(a=`${n}=${encodeURIComponent(a)}`,e?`${e}&${a}`:a)},"");a&&(e=`${e}${e.includes("?")?"&":"?"}${a}`)}if(e.startsWith("https://"))return e;return`${d}${e}`}(t,o?void 0:n);const s=n instanceof FormData;if(s||(n=n&&"object"===typeof n&&o?JSON.stringify(n):void 0),a||(a={}),s||(a["Content-Type"]="application/json"),a.Accept="application/json",!1!==r){const e=sessionStorage.getItem("token");e&&(a.Authorization=`Bearer ${e}`)}try{const r=await fetch(t,{...i,headers:a,body:n,method:e}),o=await r.json();if(r.ok){const{data:e,...t}=o;return delete t.status,e&&!Object.keys(t).length?e:o}throw o.message?new Error(o.message):o}catch(c){var l;throw console.error("Error calling API: ",c),null!==(l=c.message)&&void 0!==l&&l.includes("fetch")?new Error("Unable to reach server. Please check your network connectivity and try again."):new Error(c.message)}}const d=(0,a.s8)(r.jn,"/")},31408:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(59051),r=n.n(a);const i=function(e){let{value:t,dateOnly:n}=e;return r()(t).format(n?"DD-MMM-YYYY":"DD-MMM-YYYY HH:mm:ss")}},32026:(e,t,n)=>{n.d(t,{G6:()=>s,Ke:()=>h,OX:()=>c,PE:()=>u,TZ:()=>m,Yq:()=>o,do:()=>d,qW:()=>l,s8:()=>r,wE:()=>p});var a=n(44364);function r(e,t){return e.replace(new RegExp(`${i(t)}+$`),"")}function i(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(e){const t=new Date(e),n=t.getDate();return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]} ${n}, ${t.getFullYear()}`}function s(e,t,n){if(!t&&!e)return n;e=e||{};const a=Array.isArray(e)?[...e]:{...e};if(t.includes(".")){const r=t.indexOf("."),i=t.substring(0,r),o=t.substring(r+1);a[i]=s(e[i],o,n)}else a[t]=n;return a}function l(e,t){return btoa(`${e}_${t}_whatsapp_int`)}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<e;a++)n+=t.charAt(Math.floor(36*Math.random()));return n}function d(e,t,n){if(!t&&!e)return n;e=e||{};const a=Array.isArray(e)?[...e]:{...e};if(t.includes(".")){const r=t.indexOf("."),i=t.substring(0,r),o=t.substring(r+1);a[i]=d(e[i],o,n)}else a[t]=n;return a}function u(e,t){const n=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function h(e,t){return!t||t.startsWith("http")?t:(t.startsWith("/")&&(t=t.substring(1)),`${a.J}/${e}/${t}`)}function m(e){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.getElementsByTagName("head")[0].appendChild(t)),null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.favicon&&(t.href=h(null===e||void 0===e?void 0:e.domain,null===e||void 0===e?void 0:e.favicon)):t.href="/favicon.png"}function p(e){null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.displayName&&(document.title=null===e||void 0===e?void 0:e.displayName):document.title="LivServ"}},44364:(e,t,n)=>{n.d(t,{DX:()=>c,E1:()=>u,J:()=>l,Og:()=>i,Rc:()=>d,jn:()=>a,mB:()=>s,pA:()=>o,pR:()=>r});const a="https://devbackend.livhousing.com",r="c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WEB_SOCKET_AUTH_KEY:"wFSMmt7sfsbNJLabQvVdKNrjga6diuvwuLaD3to2RbQ=",REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com/voice/ws"}.TRAINING_MEDIA_MAXSIZE,o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WEB_SOCKET_AUTH_KEY:"wFSMmt7sfsbNJLabQvVdKNrjga6diuvwuLaD3to2RbQ=",REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com/voice/ws"}.CONVERSATION_MEDIA_MAXSIZE,s="AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",l="https://livserv-organizations.s3.ap-south-1.amazonaws.com",c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WEB_SOCKET_AUTH_KEY:"wFSMmt7sfsbNJLabQvVdKNrjga6diuvwuLaD3to2RbQ=",REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com/voice/ws"}.REACT_APP_NGROK_BACKEND_URL||"https://devbackend.livhousing.com",d="https://devbackend.livhousing.com/",u="wss://devbackend.livhousing.com/voice/ws"},51637:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(9950),r=n(14857),i=n(48089),o=n(45180),s=n(82053),l=n(50704),c=n(44414);const d={p:2.5,"& .MuiCardHeader-action":{m:"0px auto",alignSelf:"center"}},u=(0,a.forwardRef)((e,t)=>{let{border:n=!0,boxShadow:a,children:u,content:h=!0,contentSX:m={},darkTitle:p,elevation:v,secondary:x,shadow:g,sx:f={},title:A,...y}=e;const b=(0,r.A)();return a="dark"===b.palette.mode?a||!0:a,(0,c.jsxs)(i.A,{elevation:v||0,ref:t,...y,sx:{border:n?"1px solid":"none",borderRadius:2,borderColor:"dark"===b.palette.mode?b.palette.divider:b.palette.grey.A800,boxShadow:!a||n&&"dark"!==b.palette.mode?"inherit":g||b.customShadows.z1,":hover":{boxShadow:a?g||b.customShadows.z1:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:b.typography.fontFamily,fontSize:"0.75rem"},...f},children:[!p&&A&&(0,c.jsx)(o.A,{sx:d,titleTypographyProps:{variant:"subtitle1"},title:A,action:x}),p&&A&&(0,c.jsx)(o.A,{sx:d,title:(0,c.jsx)(s.A,{variant:"h3",children:A}),action:x}),h&&(0,c.jsx)(l.A,{sx:m,children:u}),!h&&u]})})},90587:(e,t,n)=>{function a(e,t){return"desc"===e?(e,n)=>r(e,n,t):(e,n)=>-r(e,n,t)}function r(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function i(e,t){const n=e.map((e,t)=>[e,t]);return n.sort((e,n)=>{const a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]}),n.map(e=>e[0])}n.d(t,{h:()=>a,q:()=>i})},93176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe});var a=n(9950),r=n(59051),i=n.n(r),o=n(60899),s=n(82053),l=n(3602),c=n(81616),d=n(25277),u=n(78317),h=n(51637),m=n(40271),p=n(18182),v=n(44414);const x=function(e){let{title:t,count:n,percentage:a,extra:r,period:i="month",color:l=(r<0?"warning":"success")}=e;const x=r<0;return r=Math.abs(r||0),(0,v.jsxs)(h.A,{contentSX:{p:2.25},children:[(0,v.jsxs)(c.A,{spacing:.5,children:[(0,v.jsx)(s.A,{variant:"h6",color:"textSecondary",children:t}),(0,v.jsxs)(o.Ay,{container:!0,alignItems:"center",children:[(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(s.A,{variant:"h4",color:"inherit",children:n})}),!!a&&(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(d.A,{variant:"combined",color:l,icon:(0,v.jsxs)(v.Fragment,{children:[!x&&(0,v.jsx)(m.A,{style:{fontSize:"0.75rem",color:"inherit"}}),x&&(0,v.jsx)(p.A,{style:{fontSize:"0.75rem",color:"inherit"}})]}),label:`${a}%`,sx:{ml:1.25,pl:1},size:"small"})})]})]}),x&&(0,v.jsx)(u.A,{sx:{pt:2.25},children:(0,v.jsxs)(s.A,{variant:"caption",color:"textSecondary",children:["You're down by "," ",(0,v.jsx)(s.A,{component:"span",variant:"caption",sx:{color:`${l||"primary"}.main`},children:r})," ","this ",i]})}),!x&&(0,v.jsx)(u.A,{sx:{pt:2.25},children:(0,v.jsxs)(s.A,{variant:"caption",color:"textSecondary",children:["You made an extra"," ",(0,v.jsx)(s.A,{component:"span",variant:"caption",sx:{color:`${l||"primary"}.main`},children:r})," ","this ",i]})})]})};var g=n(33340);const f=function(){const e=(0,g.qi)(e=>e.overview),{current:t={},difference:n={},diffPercentage:a={}}=e||{};return(0,v.jsxs)(v.Fragment,{children:[t.totalVisitors>0&&(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"Total Visitors",count:t.totalVisitors,percentage:a.totalVisitors,extra:n.totalVisitors})}),(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"Interactive Visitors",count:t.interactiveVisitors,percentage:a.interactiveVisitors,extra:n.interactiveVisitors})}),(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"Presales",count:t.preSale,percentage:a.preSale,extra:n.preSale})}),(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"General",count:t.general,percentage:a.general,extra:n.general})}),!t.revisit&&(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"Others",count:t.others,percentage:a.others,extra:n.others})}),!!t.revisit&&(0,v.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,v.jsx)(x,{title:"Revisit Count",count:t.revisit,percentage:a.revisit,extra:n.revisit})}),(0,v.jsx)(o.Ay,{item:!0,md:8,sx:{display:{sm:"none",md:"block",lg:"none"}}})]})};var A=n(8478);async function y(){const{organizationId:e,selectedBotId:t}=g.nc.getState(),n=g.qi.getState(),{organizationId:a,botId:r}=n;let{fromDate:o,toDate:s}=n;o=i()(o).startOf("day").toDate(),s=i()(s).endOf("day").toDate();e===a&&t===r||g.qi.setState((0,g.Vs)(e,t),!0);const l=await A.Jt(`/analytics/${e}/${t}/dashboard/overview`,{fromDate:o,toDate:s}),c=function(e,t){e=i()(e),t=i()(t);const n=t.diff(e,"days"),a=e.clone().subtract(1,"days");return{start:a.clone().subtract(n,"days").startOf("day").toDate(),end:a.endOf("day").toDate()}}(o,s);o=c.start,s=c.end;const d=await A.Jt(`/analytics/${e}/${t}/dashboard/overview`,{fromDate:o,toDate:s}),u={interactiveVisitors:(l.interactiveVisitors||0)-(d.interactiveVisitors||0),preSale:(l.preSale||0)-(d.preSale||0),general:(l.general||0)-(d.general||0),others:(l.others||0)-(d.others||0),revisit:(l.revisit||0)-(d.revisit||0)},h={current:l,previous:d,difference:u,diffPercentage:{interactiveVisitors:D(d.interactiveVisitors,u.interactiveVisitors),preSale:D(d.preSale,u.preSale),general:D(d.general,u.general),others:D(d.others,u.others),revisit:D(d.revisit,u.revisit)}};g.qi.setState({overview:h})}async function b(e){const{organizationId:t,selectedBotId:n}=g.nc.getState(),a=g.qi.getState();let{visitorProps:r}=a;r={page:1,count:10,...r,...e},g.qi.setState({visitorProps:r,visitorList:null,visitorsListTotal:0});const{total:i,visitorList:o}=await A.Jt(`/analytics/${t}/${n}/dashboard/visitors-list`,r);g.qi.setState({visitorsListTotal:i,visitorList:o})}function j(e){let{fromDate:t,toDate:n}=e;return g.qi.setState({fromDate:i()(t).startOf("day").toDate(),toDate:i()(n).endOf("day").toDate()}),y()}function D(e,t){return t&&e?parseFloat((100*t/e).toFixed(2)):0}var _=n(10226);const S=function(e){let{showToday:t=!1,value:n=(t?"day":"week"),customRange:r,onChange:s}=e;const[l,d]=a.useState(n),u=a.useRef({onChange:s,slot:l});u.current.slot=l,u.current.customRange=r,a.useEffect(()=>{if("custom"===u.current.slot){const{onChange:e}=u.current;e(r)}},[r]);const h=a.useCallback(e=>{d(e);const{onChange:t}=u.current;if(t)if("custom"===e)t(u.current.customRange);else{t({fromDate:i()().add(-1,e).add(1,"day").startOf("day").toDate(),toDate:i()().endOf("day").toDate()})}},[]);return u.current.handleChange=h,a.useEffect(()=>{u.current.handleChange(u.current.slot)},[]),(0,v.jsx)(o.Ay,{item:!0,style:{paddingTop:"14px"},children:(0,v.jsxs)(c.A,{direction:"row",alignItems:"center",spacing:.5,children:[!!r&&(0,v.jsx)(_.A,{size:"small",onClick:()=>h("custom"),color:"primary",variant:"custom"===l?"contained":"outlined",children:"Custom"}),(0,v.jsx)(_.A,{size:"small",onClick:()=>h("month"),color:"primary",variant:"month"===l?"contained":"outlined",children:"Month"}),(0,v.jsx)(_.A,{size:"small",onClick:()=>h("week"),color:"primary",variant:"week"===l?"contained":"outlined",children:"Week"}),t&&(0,v.jsx)(_.A,{size:"small",onClick:()=>h("day"),color:"primary",variant:"day"===l?"contained":"outlined",children:"Today"})]})})};var P=n(69780),w=n(9213),E=n(21671),C=n(7251),T=n(72595),k=n(6258),R=n(1320),O=n(15769),I=n(34075),L=n(80691),M=n(14857);const N=e=>{let{color:t,size:n}=e;const a=(0,M.A)();let r;switch(t){case"secondary":r=a.palette.secondary.main;break;case"error":r=a.palette.error.main;break;case"warning":r=a.palette.warning.main;break;case"info":r=a.palette.info.main;break;case"success":r=a.palette.success.main;break;default:r=a.palette.primary.main}return(0,v.jsx)(u.A,{sx:{width:n||8,height:n||8,borderRadius:"50%",bgcolor:r}})};var V=n(31408),$=n(48746),K=n(32026);const B=[{id:"name",label:"Name"},{id:"email",disablePadding:!0,label:"Email Id"},{id:"phoneNumber",label:"Phone Number",sortable:!1},{id:"country",label:"Country"},{id:"city",label:"City"},{id:"visitTime",label:"Visit Time"},{id:"category",label:"Category"},{id:"transcriptUrl",align:"right",label:"Transcript",sortable:!1}];function Y(e){let{order:t,orderBy:n}=e;return(0,v.jsx)(P.A,{children:(0,v.jsx)(w.A,{children:B.map(e=>(0,v.jsxs)(E.A,{align:e.align||"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&("desc"===t?"asc":"desc"),children:[!1===e.sortable&&e.label,!1!==e.sortable&&(0,v.jsxs)(C.A,{active:n===e.id,direction:n===e.id?"desc"===t?"asc":"desc":"asc",onClick:()=>b({orderBy:e.id,order:n===e.id?"desc"===t?"asc":"desc":"asc"}),children:[e.label,n===e.id?(0,v.jsx)(u.A,{component:"span",sx:L.A,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})]},e.id))})})}function F(e){let{page:t=0,rowsCount:n,rowsPerPage:a=10}=e;return(0,v.jsx)(T.A,{children:(0,v.jsx)(w.A,{children:(0,v.jsx)(E.A,{colSpan:B.length,children:(0,v.jsx)(k.A,{component:"div",count:n,page:t,rowsPerPage:a,onPageChange:(e,t)=>b({page:t+1}),onRowsPerPageChange:(e,t)=>{let{props:{value:n}}=t;return b({count:n,page:1})}})})})})}const U=e=>{let t,{value:n}=e;switch(n){case"Pre-Sale":t="success";break;case"General":t="primary";break;case"Others":t="warning";break;default:t="error"}return(0,v.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,v.jsx)(N,{color:t}),(0,v.jsx)(s.A,{children:n})]})};function q(e){let{data:t,rowsCount:n,page:r,rowsPerPage:i,order:s,orderBy:l,dateRange:c}=e;const[d]=(0,a.useState)([]);let h=null;c&&(h="Leads - "+(0,K.Yq)(c.fromDate)+" to "+(0,K.Yq)(c.toDate));const m=(0,a.useRef)(null);return(0,v.jsx)(u.A,{children:(0,v.jsxs)(R.A,{sx:{width:"100%",overflowX:"auto",position:"relative",display:"block",maxWidth:"100%","& td, & th":{whiteSpace:"nowrap"}},children:[(0,v.jsxs)(O.A,{ref:m,"aria-labelledby":"VisitorList",sx:{"& .MuiTableCell-root:first-of-type":{pl:2},"& .MuiTableCell-root:last-of-type":{pr:3}},children:[(0,v.jsx)(Y,{order:s,orderBy:l}),(0,v.jsxs)(I.A,{children:[!(null!==t&&void 0!==t&&t.length)&&(0,v.jsx)(w.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:(0,v.jsx)(E.A,{colSpan:7,children:"No visitors exists for the selected duration"})}),(null===t||void 0===t?void 0:t.length)>0&&t.map((e,t)=>{return(0,v.jsx)(z,{row:e,index:t,isSelected:(n=e._id,-1!==d.indexOf(n))},e._id);var n})]})]}),(0,v.jsxs)(o.Ay,{container:!0,spacing:2,justifyContent:"flex-end",alignItems:"center",children:[(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)($.DownloadTableExcel,{filename:h,sheet:"Leads",currentTableRef:m.current,children:(0,v.jsx)(_.A,{size:"large",variant:"contained",color:"success",disabled:!((null===t||void 0===t?void 0:t.length)>0),children:"Download excel"})})}),(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(F,{rowsCount:n,page:r,rowsPerPage:i,order:s,orderBy:l})})]})]})})}function z(e){let{row:t,index:n,isSelected:a}=e;const r=`enhanced-table-checkbox-${n}`;return(0,v.jsxs)(w.A,{hover:!0,role:"checkbox",sx:{"&:last-child td, &:last-child th":{border:0}},"aria-checked":a,tabIndex:-1,selected:a,children:[(0,v.jsx)(E.A,{component:"th",id:r,scope:"row",align:"left",children:t.name}),(0,v.jsx)(E.A,{align:"left",children:t.email}),(0,v.jsx)(E.A,{align:"left",children:t.phoneNumber}),(0,v.jsx)(E.A,{align:"left",children:t.country}),(0,v.jsx)(E.A,{align:"left",children:t.city}),(0,v.jsx)(E.A,{align:"left",children:(0,v.jsx)(V.A,{value:t.visitTime})}),(0,v.jsx)(E.A,{align:"left",children:(0,v.jsx)(U,{value:t.category})}),(0,v.jsx)(E.A,{align:"right",children:(0,v.jsx)("a",{href:t.transcriptUrl,target:"_blank",rel:"opener",children:(0,v.jsx)(s.A,{children:"View"})})})]},t._id)}var W=n(25979),J=n(3788),G=n(70006),H=n(2660),X=n(23266),Q=n(93038),Z=n(83563);const ee={PaperProps:{style:{maxHeight:224,width:250}}},te=[{value:"preSale",label:"Pre-Sale"},{value:"general",label:"General"},{value:"others",label:"Others"}],ne=te.reduce((e,t)=>(e[t.value]=t.label,e),{});const ae=function(e){let{value:t=[],onChange:n}=e;return(0,v.jsxs)(W.A,{sx:{m:1,width:300,float:"left"},children:[(0,v.jsx)(J.A,{id:"visitor-type-label",style:{lineHeight:"15px"},children:"Visitor Category"}),(0,v.jsx)(G.A,{labelId:"visitor-type-label",id:"visitor-type",multiple:!0,value:t||[],onChange:e=>{n(e.target.value)},input:(0,v.jsx)(H.A,{label:"Visitor Category"}),renderValue:e=>e.map(e=>ne[e]).join(", "),MenuProps:ee,children:te.map(e=>{let{value:n,label:a}=e;return(0,v.jsxs)(X.A,{value:n,children:[(0,v.jsx)(Q.A,{checked:null===t||void 0===t?void 0:t.includes(n)}),(0,v.jsx)(Z.A,{primary:a})]},n)})})]})};const re=function(e){let{customRange:t}=e;const[n,r]=a.useState(),{visitorList:i,visitorProps:l,visitorsListTotal:c}=(0,g.qi)(),{category:d,count:u,page:m,orderBy:p,order:x}=l||{};return a.useEffect(()=>{n&&b(n).catch(e=>console.log("Error loading visitor list:-",e))},[n]),(0,v.jsxs)(o.Ay,{item:!0,xs:12,children:[(0,v.jsxs)(o.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(s.A,{variant:"h5",children:"Visitors List"})}),(0,v.jsx)(o.Ay,{item:!0,xs:9,alignItems:"right",children:(0,v.jsxs)(o.Ay,{container:!0,alignItems:"right",justifyContent:"flex-end",children:[(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(ae,{value:d,onChange:e=>b({category:e})})}),(0,v.jsx)(S,{showToday:!0,customRange:t,onChange:r})]})})]}),(0,v.jsx)(h.A,{sx:{mt:2},content:!1,children:(0,v.jsx)(q,{data:i,orderBy:p,order:x,category:d,rowsCount:c||0,rowsPerPage:u||10,page:(m||1)-1,dateRange:n})})]})},ie=[{value:"country",text:"Country"},{value:"city",text:"City"},{value:"os",text:"OS Name"},{value:"browser",text:"Browser"},{value:"date",text:"Date"},{value:"landing_page",text:"Landing Page"}],oe=ie.reduce((e,t)=>(e[t.value]=t.text,e),{});const se=function(e){let{value:t,onChange:n}=e;return(0,v.jsx)(le,{list:ie,value:t,onChange:n})};function le(e){let{list:t,value:n,onChange:a}=e;return(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsx)(c.A,{direction:"row",alignItems:"center",spacing:0,children:t.map(e=>(0,v.jsx)(_.A,{size:"small",onClick:()=>a(e.value),color:n===e.value?"primary":"secondary",variant:n===e.value?"outlined":"text",children:e.text},e.value))})})}var ce=n(90587);const de=[{id:"group",label:"Group"},{id:"totalInteractions",disablePadding:!0,label:"Interactions"},{id:"preSale",label:"Pre-Sale"},{id:"general",label:"General"},{id:"others",label:"Others"}];function ue(e){let{order:t,orderBy:n}=e;return(0,v.jsx)(P.A,{children:(0,v.jsx)(w.A,{children:de.map(e=>(0,v.jsx)(E.A,{align:e.align||"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t,children:e.label},e.id))})})}function he(e){let{data:t}=e;const[n]=(0,a.useState)("asc"),[r]=(0,a.useState)("_id"),[i]=(0,a.useState)([]);return(0,v.jsx)(u.A,{children:(0,v.jsx)(R.A,{sx:{width:"100%",overflowX:"auto",position:"relative",display:"block",maxWidth:"100%","& td, & th":{whiteSpace:"nowrap"}},children:(0,v.jsxs)(O.A,{"aria-labelledby":"VisitorList",sx:{"& .MuiTableCell-root:first-of-type":{pl:2},"& .MuiTableCell-root:last-of-type":{pr:3}},children:[(0,v.jsx)(ue,{order:n,orderBy:r}),(0,v.jsxs)(I.A,{children:[!(null!==t&&void 0!==t&&t.length)&&(0,v.jsx)(w.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:(0,v.jsx)(E.A,{colSpan:7,children:"No visitors exists for the selected duration"})}),(null===t||void 0===t?void 0:t.length)>0&&(0,ce.q)(t,(0,ce.h)(n,r)).map((e,t)=>{return(0,v.jsx)(me,{row:e,index:t,isSelected:(n=e._id,-1!==i.indexOf(n))},e.group);var n})]})]})})})}function me(e){let{row:t,index:n,isSelected:a}=e;const r=`enhanced-table-checkbox-${n}`;return(0,v.jsxs)(w.A,{hover:!0,role:"checkbox",sx:{"&:last-child td, &:last-child th":{border:0}},"aria-checked":a,tabIndex:-1,selected:a,children:[(0,v.jsx)(E.A,{component:"th",id:r,scope:"row",align:"left",children:t.group}),(0,v.jsx)(E.A,{align:"left",children:t.totalInteractions}),(0,v.jsx)(E.A,{align:"left",children:t.preSale||"-"}),(0,v.jsx)(E.A,{align:"left",children:t.general||"-"}),(0,v.jsx)(E.A,{align:"left",children:t.others||"-"})]})}const pe=function(){const[e,t]=a.useState("country"),n=(0,g.qi)(e=>e.visitorGroupedList),{fromDate:r,toDate:i}=g.qi.getState();return a.useEffect(()=>{e&&async function(e){const{organizationId:t,selectedBotId:n}=g.nc.getState(),{fromDate:a,toDate:r}=g.qi.getState();g.qi.setState({visitorGroupedList:null});const i=await A.Jt(`/analytics/${t}/${n}/dashboard/grouped/${e}`,{fromDate:a,toDate:r});g.qi.setState({visitorGroupedList:i})}(e).catch(e=>console.log("Error loading visitor grouped list:-",e))},[e]),(0,v.jsxs)(o.Ay,{item:!0,xs:12,children:[(0,v.jsxs)(o.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,v.jsx)(o.Ay,{item:!0,children:(0,v.jsxs)(s.A,{variant:"h5",children:["Analytics - [",oe[e]," Wise] (",(0,v.jsx)(V.A,{value:r,dateOnly:!0})," - ",(0,v.jsx)(V.A,{value:i,dateOnly:!0}),")"]})}),(0,v.jsx)(se,{value:e,onChange:t})]}),(0,v.jsx)(h.A,{sx:{mt:2},content:!1,children:(0,v.jsx)(he,{data:n})})]})},ve=new Date("2023-10-01"),xe=i()().endOf("day").toDate(),ge={month:3};const fe=function(){const{fromDate:e,toDate:t}=(0,g.qi)(),n=a.useMemo(()=>({fromDate:e,toDate:t}),[e,t]);return a.useEffect(()=>{y().catch(e=>console.error("Unable to load analytics data",e))},[]),(0,v.jsxs)(o.Ay,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,v.jsxs)(o.Ay,{item:!0,xs:12,children:[(0,v.jsx)(s.A,{variant:"h5",style:{display:"inline-block",marginRight:"18px"},children:"Dashboard"}),(0,v.jsx)(l.Ay,{range:!0,value:n,onChange:j,minDate:ve,maxDate:xe,maxSpan:ge})]}),(0,v.jsx)(o.Ay,{item:!0,md:8,sx:{display:{sm:"none",md:"block",lg:"none"}}}),(0,v.jsx)(f,{}),(0,v.jsx)(pe,{}),(0,v.jsx)(re,{customRange:n})]})}}}]);