"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[2517],{31739:(t,e,n)=>{n.d(e,{J:()=>r,u:()=>a});const o="lp-vid";function a(t,e){if("set-visitor-id"===t){const{recipientId:t}=e||{};t&&function(t){try{localStorage.setItem(o,t)}catch(e){console.error("Unable to use browser cache",e)}}(t)}}function r(){try{return localStorage.getItem(o)||void 0}catch(t){console.error("Unable to use browser cache",t)}}},47851:(t,e,n)=>{n.d(e,{A:()=>M});var o=n(9950),a=n(46816),r=n(74250),s=n(78023),i=n(80045),c=n(89379),l=n(44364),d=n(8478);const u=["startupFlow","hideChatWindow","googleTagManagerId","googleAdWordsId"];function g(t,e,n){var o,a,s;const{updateContact:i,onReceiveChatResponse:u,bot:g,locationDetails:p,onCallback:v,recipientId:m,history:w,chatFlowId:b,preferredLanguage:f,url:y}=e,{flowId:C,flowType:I}=(null===w||void 0===w||null===(o=w[w.length-1])||void 0===o?void 0:o.media)||{};return"string"===typeof t&&C&&(t={method:"flow-response",type:I,flowId:C,answer:t}),"customForm"===(null===(a=t)||void 0===a?void 0:a.type)&&null!==(s=t)&&void 0!==s&&s.answer&&(t={method:"flow-response",type:I,flowId:C,answer:t.answer}),n?async function(t,e,n,o,a){let{onReceiveChatResponse:s,updateContact:i,onCallback:d,recipientId:u,chatFlowId:g,language:p}=o;const v=r.Db(),{_id:m,organizationId:w,botSettings:b}=e,f={userQuery:t,recipientDetails:(0,c.A)({recipientId:u,conversationId:v,language:p},a),chatFlowId:g};s&&(f.testMode=!0);try{const t=await fetch("".concat(l.Rc,"voicebot/voiceChat?organizationId=").concat(w,"&botId=").concat(m),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),e=await t.json();null===s||void 0===s||s(e.data);return{data:h(e.data,{updateContact:i,botSettings:b,onCallback:d}),audioUri:e.data.audioUri}}catch(y){return console.log(y,"error"),[{role:"assistant",type:"text",content:y.message||"Unknown Server error"}]}}(t,g,0,{onReceiveChatResponse:u,updateContact:i,onCallback:v,recipientId:m,chatFlowId:b,language:f},p):async function(t,e,n,o,a){let{onReceiveChatResponse:s,updateContact:i,onCallback:l,recipientId:u,chatFlowId:g,language:p}=o;const v=r.Db(),{_id:m,organizationId:w,botSettings:b}=e,f={url:n,userQuery:t,recipientDetails:(0,c.A)({recipientId:u,conversationId:v,language:p},a),chatFlowId:g};s&&(f.testMode=!0);try{const t=await d.bE("/bot/".concat(w,"/").concat(m,"/chat"),f,{noAuth:!0});return null===s||void 0===s||s(t),h(t,{updateContact:i,botSettings:b,onCallback:l})}catch(y){return[{role:"assistant",type:"text",content:y.message||"Unknown Server error"}]}}(t,g,y,{onReceiveChatResponse:u,updateContact:i,onCallback:v,recipientId:m,chatFlowId:b,language:f},p)}function h(t,e){let{updateContact:n,botSettings:o,onCallback:a}=e;const{chatRefId:s,recipientId:i,messages:c}=t;return r.d6(s),null===a||void 0===a||a("set-visitor-id",{recipientId:i}),p(c,{updateContact:n,botSettings:o})}function p(t,e){let{updateContact:n,botSettings:o}=e;if(null===t||void 0===t||!t.length)return t;const a=t[t.length-1];return"form"===a.type&&t.push({role:"user",type:"lead",content:"",profile:a.media,updateContact:n,botSettings:o}),"customForm"===a.type&&("assistant"===a.role&&(a.role="user"),Object.assign(a,{type:"customForm",content:"",media:a.media,updateContact:n,botSettings:o})),t}async function v(t,e,n,o){let{autoLaunch:a,startupMessages:s}=o;const{_id:i,organizationId:c,botSettings:l={}}=t,u=r.Db();if(!e||!u)return a?s||[{role:"assistant",type:"text",content:"Hello, greetings for the day, how may I assist you?"}]:[];try{const t=await d.Jt("/bot/".concat(c,"/").concat(i,"/chat/history/").concat(e,"/").concat(u),null,{noAuth:!0}),{messages:o}=t||{};return p(o,{updateContact:n,botSettings:l})}catch(g){console.error("Failed to fetch chat history:-",g)}return a?[{role:"assistant",type:"text",content:"Hello, greetings for the day, how may I assist you?"}]:[]}let m=null;function w(t){t.origin||(t.origin=null),t.botId||(t.botId=null);try{const{origin:e,botId:n}=t;m=new BroadcastChannel("lp_web_chat");const o=function(t){let{onHistoryChange:e,getHistory:n,origin:o=null,botId:a=null}=t;return t=>{const s=t.data||{};if(s.origin===o&&s.botId===a)try{if("GetConversationId"===s.action){b(n(),o,a)}else if("SetConversationId"===s.action){const{conversationId:t,history:n}=s;t?r.d6(t||void 0):r.oy(),n&&(null===e||void 0===e||e(n))}}catch(i){console.log("Error occurred when trying to handle session sharing:",i)}}}(t);return m.addEventListener("message",o),m.postMessage({action:"GetConversationId",origin:e,botId:n}),()=>{m&&(m.removeEventListener("message",o),m.close(),m=null)}}catch(e){console.error("Unable to start session sharing:",e)}}function b(t,e,n,o){if(m)try{const a=r.Db()||"";if(!o&&!a)return;m.postMessage({action:"SetConversationId",origin:e,botId:n,conversationId:a,history:t})}catch(a){console.error("Error sharing session:",a)}}var f=n(17119),y=n(44414);const C=function(t){let{design:e}=t;const n=null===e||void 0===e?void 0:e.remoteFontLink;return n?f.createPortal((0,y.jsx)("link",{rel:"stylesheet",href:n}),document.head,"remoteFont"):null};const I=function(t){let{googleTagManagerId:e}=t;return(0,o.useEffect)(()=>{if(!e)return;if(document.querySelector('script[data-gtm="'.concat(e,'"]')))return;if(window.dataLayer&&document.querySelector('script[src*="gtm.js"]'))return void console.log("GTM already loaded by server");const t=document.createElement("script");t.innerHTML="\n            (function(w,d,s,l,i){\n                w[l]=w[l]||[];\n                w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});\n                var f=d.getElementsByTagName(s)[0],\n                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';\n                j.async=true;\n                j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;\n                f.parentNode.insertBefore(j,f);\n            })(window,document,'script','dataLayer','".concat(e,"');\n        "),document.head.appendChild(t);const n=document.createElement("noscript");return n.innerHTML='\n          <iframe src="https://www.googletagmanager.com/ns.html?id='.concat(e,'"\n            height="0" width="0" style="display:none;visibility:hidden" title="Google Tag Manager"></iframe>\n        '),document.body.insertBefore(n,document.body.firstChild),()=>{document.head.removeChild(t),document.body.removeChild(n)}},[e]),null};const x=function(t){let{googleAdWordsId:e}=t;return(0,o.useEffect)(()=>{if(!e)return;const t=document.createElement("script");t.src="https://www.googletagmanager.com/gtag/js?id=".concat(e),t.async=!0,document.head.appendChild(t);const n=document.createElement("script");return n.innerHTML="\n      window.dataLayer = window.dataLayer || [];\n      function gtag(){dataLayer.push(arguments);}\n      window.gtag = gtag;\n      gtag('js', new Date());\n      gtag('config', '".concat(e,"');\n    "),document.head.appendChild(n),()=>{document.head.removeChild(t),document.head.removeChild(n)}},[e]),null};var S=n(28891);const k=function(t){let{text:e="We are Online!",onHide:n,design:a,isLeft:r}=t;const s=function(t,e){let{spacingCorner:n,spacingBottom:o}=(null===t||void 0===t?void 0:t.launcher)||{};n=parseFloat(n)||void 0,o=parseFloat(o)||void 0,n&&(n+=5);o&&(o+=75);if(n||o)return{bottom:o,[e?"left":"right"]:n}}(a,r),[i,c]=o.useState(!0),l=o.useCallback(t=>{t.preventDefault(),t.stopPropagation(),c(!1),null===n||void 0===n||n()},[n]);return i?(0,y.jsxs)("div",{className:"button-tooltip",style:s,children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("img",{draggable:!1,className:"chat-hand",alt:"\ud83d\udc4b",src:"https://cwc.livserv.in/uploads/Templates/cwc_trend1/hand.png"}),(0,y.jsx)("b",{children:e}),(0,y.jsx)("br",{})]}),(0,y.jsx)("a",{className:"close-indicator",onClick:l,children:(0,y.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg",children:(0,y.jsx)("path",{d:"M1490 1245q0 40-24 68l-136 136q-24 24-68 24t-68-28l-294-294-294 294q-24 24-68 24t-68-28l-136-136q-24-24-24-68t24-68l294-294-294-294q-24-24-24-68t24-68l136-136q24-24 68-24t68 28l294 294 294-294q24-24 68-28t68 28l136 136q28 24 24 68t-24 68l-294 294 294 294q24 24 24 68z",fill:"#fff"})})})]}):null};const j=function(t){let{isLeft:e,bgColor:n,secBgColor:a,imageUrl:r,chatIcon:s,barText:i="Live Chat",fontSize:c,color:l,autoAnimate:d=!0,style:u,onClick:g}=t;const h=e?"bottom-left":"bottom-right",p={backgroundColor:n},v={backgroundImage:"linear-gradient(90deg, ".concat(n,", ").concat(a,")")},m=o.useRef(null);return o.useEffect(()=>{if(d){const t=setInterval(()=>{var t;null===(t=m.current)||void 0===t||t.classList.remove("bar-hide"),setTimeout(()=>{var t;return null===(t=m.current)||void 0===t?void 0:t.classList.add("bar-hide")},7e3)},35e3);return()=>clearInterval(t)}},[d]),(0,y.jsxs)("div",{className:"lp-launcher expand-button ".concat(h),onClick:g,style:u,children:[(0,y.jsx)("div",{ref:m,className:"text-container bar-hide",style:v,children:(0,y.jsx)("div",{className:"bar-text",style:{minWidth:"150px",fontSize:c,color:l},children:(0,y.jsxs)("p",{children:["Hi there, ",(0,y.jsx)("img",{draggable:!1,className:"chat-hand",alt:"\ud83d\udc4b",src:"https://cwc.livserv.in/uploads/Templates/cwc_trend1/hand.png"})," We are online!"]})})}),(0,y.jsx)("div",{className:"image-container",style:p,children:(0,y.jsxs)("div",{className:"image-sub-container",children:[r&&(0,y.jsx)("img",{src:r,alt:i}),!r&&s]})})]})};const L=function(t){let{design:e,onToggle:n}=t;const{launcher:{launcherType:o,buttonLogoUrl:a,buttonOnMobile:r,barText:s,fontSize:i,spacingCorner:l,spacingBottom:d,showMinimizeButtonToolTip:u=!0}={},header:{bgColor:g,secBgColor:h,fontColor:p}={},window:{fontFamily:v,align:m}={}}=e||{},w="bottomLeft"===m,b={bottom:d,[w?"left":"right"]:l};return"icon"===o||r?(0,y.jsxs)("div",{id:"lp-launcher",className:"lp-launcher button"+(a?"":" bordered"),onClick:n,style:(0,c.A)({borderColor:g,color:p,background:a?"transparent":"linear-gradient(to right,"+g+", "+h+")",verticalAlign:"middle",padding:a?void 0:"16px",display:"flex"},b),children:[u&&(0,y.jsx)(k,{design:e,isLeft:w}),a&&(0,y.jsx)("img",{src:a,alt:"Live Chat"}),!a&&S.Or]}):"expand"===o?(0,y.jsx)(j,{isLeft:w,color:p,style:b,bgColor:g,secBgColor:h,imageUrl:a,chatIcon:S.Or,barText:s,fontSize:i,onClick:n}):(0,y.jsxs)("div",{id:"lp-launcher",className:"lp-launcher bar",onClick:n,style:(0,c.A)({background:"linear-gradient(to right, "+g+", "+h+")",color:p,fontFamily:v},b),children:[S.Or,(0,y.jsx)("span",{children:s||"Live Chat"})]})},T={window:{spacingCorner:"0px",spacingBottom:"7px"},launcher:{spacingCorner:"0px",spacingBottom:"7px"}},B=["lead","options","customForm","stop"];const M=function(t){var e,n,c,l;const{botDetails:h,botDesign:m,startupFlow:f,onReceiveChatResponse:S,autoLaunch:k,recipientId:j,origin:M,onCallback:A,optionsRenderer:F,fullscreen:R,customChatWindow:H,sourceUrl:E}=t,[U,N]=o.useState(k||!1),[_,D]=o.useState(m),[W,q]=o.useState(!1),[z,O]=o.useState(h),[G,J]=o.useState(f),[P,Q]=o.useState(null===f||void 0===f?void 0:f.messages),[V,Y]=o.useState(j),[K,X]=o.useState([]),[Z,$]=o.useState(),[tt,et]=o.useState(),[nt,ot]=o.useState(null),[at,rt]=o.useState(null),st=o.useRef({autoLaunch:k});if(R)try{const t=window.innerWidth+"px",e=window.innerHeight+"px";_.window.width=t,_.window.height=e,_.window.spacingBottom="0px",_.window.spacingCorner="0px",_.launcher.spacingBottom="0px",_.launcher.spacingCorner="0px"}catch(vt){}st.current.recipientId=V,st.current.bot=z,st.current.chatFlowId=null===G||void 0===G?void 0:G.flowId,st.current.startupMessages=P,st.current.origin=M,st.current.preferredLanguage=tt,st.current.url=E;const it=o.useCallback(t=>{r.eB(t),et(t)},[]);st.current.setAndBroadcastHistory=o.useCallback(t=>{var e;"function"===typeof t?X(e=>{var n;const o=t(e);return b(o,st.current.origin,null===(n=st.current.bot)||void 0===n?void 0:n._id,!0),o}):(X(t),b(t,st.current.origin,null===(e=st.current.bot)||void 0===e?void 0:e._id,!0))},[]),st.current.onCallback=o.useCallback((t,e)=>{"set-visitor-id"===t&&e.recipientId&&Y(e.recipientId),null===A||void 0===A||A(t,e)},[A]),st.current.history=K,st.current.showBot=U,st.current.design=_,st.current.locationDetails=Z,st.current.onReceiveChatResponse=S,st.current.isLoadedInConsole=!!S,o.useEffect(()=>{O(h)},[h]),o.useEffect(()=>{var t;const{updateContact:e,bot:n}=st.current;J(f),null!==f&&void 0!==f&&null!==(t=f.messages)&&void 0!==t&&t.length?Q(p([...f.messages],{updateContact:e,botSettings:n.botSettings})):Q(!1)},[f]),o.useEffect(()=>{if(z&&!st.current.isLoadedInConsole)return w({botId:z._id,origin:st.current.origin,onHistoryChange:t=>{var e;(null!==t&&void 0!==t&&t.length||null!==(e=st.current.history)&&void 0!==e&&e.length)&&X(t)},getHistory:()=>st.current.history})},[z]),o.useEffect(()=>{D(m)},[m]),o.useEffect(()=>{et(r.cO());const{updateContact:t,bot:e,recipientId:n,autoLaunch:o,setAndBroadcastHistory:a,startupMessages:c}=st.current;e?v(e,n,t,{autoLaunch:o,startupMessages:p(c,{updateContact:t,botSettings:e.botSettings})}).then(a):async function(t){try{const e=await r.e(),n=new URLSearchParams(window.location.search),o=n.get("token"),a=n.get("sourceUrl");let s=document.referrer;if(a&&s)try{new URL(a).hostname===new URL(s).hostname&&(s="")}catch(vt){console.error("Invalid URL in sourceUrl or referer:",vt)}const c={authToken:o,recipientId:t,sourceUrl:a,referer:s,country:(null===e||void 0===e?void 0:e.country_name)||"NA",city:(null===e||void 0===e?void 0:e.city)||"NA"},l=await d.Jt("/bot/get-bot-details-by-auth-token",c,{noAuth:!0}),{startupFlow:g,hideChatWindow:h,googleTagManagerId:p,googleAdWordsId:v}=l;return{startupFlow:g,hideChatWindow:h,googleTagManagerId:p,googleAdWordsId:v,bot:(0,i.A)(l,u)}}catch(e){console.log("Failed to init chat:-",e)}}(n).then(e=>{let{bot:r,startupFlow:i,hideChatWindow:c,googleTagManagerId:l,googleAdWordsId:d}=e;if(c)window.top.postMessage({lsMessage:"hide_ls_window"},"*");else{ot(l),rt(d),O(r),J(i);const e=p(null===i||void 0===i?void 0:i.messages,{updateContact:t,botSettings:r.botSettings});Q(e);const{design:c,isLoadedInConsole:u}=st.current;!c&&r.botDesign&&D((0,s.Y)(r.botDesign,u?void 0:T)),v(r,n,t,{autoLaunch:o,startupMessages:p(e,{updateContact:t,botSettings:r.botSettings})}).then(a)}}),r.a().then($)},[]);const ct=o.useCallback((t,e)=>{var n,o,a,r;let{showBot:s,design:i,onCallback:c}=st.current;s=t?!s:s,null===c||void 0===c||c("windowToggle",{state:s,design:s?{width:null===i||void 0===i||null===(n=i.window)||void 0===n?void 0:n.width,height:null===i||void 0===i||null===(o=i.window)||void 0===o?void 0:o.height,spacingBottom:null===i||void 0===i||null===(a=i.window)||void 0===a?void 0:a.spacingBottom,spacingCorner:null===i||void 0===i||null===(r=i.window)||void 0===r?void 0:r.spacingCorner}:e})},[]),lt=o.useCallback(async t=>{var e;null!==(e=st.current.history)&&void 0!==e&&e.length||setTimeout(()=>{var t;if(null!==(t=st.current.startupMessages)&&void 0!==t&&t.length)return void st.current.setAndBroadcastHistory(t=>t.concat(...st.current.startupMessages));const e={role:"assistant",type:"text",content:"Hello, greetings for the day, how may I assist you?"};st.current.setAndBroadcastHistory(t=>t?t.concat(e):[e])},t||1700)},[]),dt=o.useCallback(()=>{ct(!0),N(t=>!t),q(!0),setTimeout(()=>q(!1),1e3),lt()},[ct,lt]);o.useLayoutEffect(()=>{_&&ct(!1,!0)},[_,ct]);const ut=o.useCallback(async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g(t,st.current,e)},[]);st.current.updateContact=o.useCallback(async t=>{const e=await ut(t);st.current.setAndBroadcastHistory(t=>t.filter(t=>!B.includes(t.type)).concat(...e))},[ut]);const gt=o.useCallback(()=>{st.current.setAndBroadcastHistory([]),r.oy(),delete st.current.history,lt(700)},[lt]);if(!z||!Z)return null;let ht="hide-chat";U&&W?ht="opening":U&&!W?ht="show-chat":!U&&W&&(ht="closing"),ht+="bottomLeft"===(null===_||void 0===_||null===(e=_.window)||void 0===e?void 0:e.align)?" bottom-left ":" bottom-right ",S&&(ht+=" test-console");const pt=K&&B.includes(null===(n=K[K.length-1])||void 0===n?void 0:n.type);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(C,{design:_}),(0,y.jsx)(I,{googleTagManagerId:nt}),(0,y.jsx)(x,{googleAdWordsId:at}),(0,y.jsxs)("div",{className:"chat-handler "+ht,children:[U&&!!z&&(0,y.jsx)(a.A,{botDesign:_,messages:K,showTime:!0,onUserMessage:ut,disabledMessage:pt,onHistoryChange:st.current.setAndBroadcastHistory,onClear:gt,onHide:dt,onCallback:st.current.onCallback,optionsRenderer:F,language:tt,setLanguage:it,fullscreen:R,customChatWindow:H,activateVoiceBot:null!==(c=null===_||void 0===_||null===(l=_.composer)||void 0===l?void 0:l.activateVoiceBot)&&void 0!==c&&c}),!U&&!W&&(0,y.jsx)(L,{design:_,onToggle:dt})]})]})}}}]);