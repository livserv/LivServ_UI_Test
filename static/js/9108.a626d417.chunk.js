"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[9108],{22942:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var n=i(9950),s=i(60899),o=i(82053),l=i(78317),r=i(81616),a=i(24516),d=i(53065),c=i(50704),p=i(10226),x=i(25713),u=i(52472),m=i(99532),h=i(57988),f=i(62375),y=i(69935),g=i(4983),j=i(93153),b=i(94540),v=i(29714),A=i(61467),w=i(44364),S=i(51637),I=i(32829),C=i(21788),z=i(33340),F=i(70855);const k=i.p+"static/media/media-image.16ef5ffabad85fb7ba76.png";var M=i(26092),T=i(93383),D=i(8478),U=i(98415);var $=i(46278),L=i(74248),P=i(44414);const _=function(e){var t;const{mimeType:i,selectedFiles:n,handleSelection:s}={...e},o=(0,z.nc)(e=>e.botsList),[l]=(0,F.G)(),r=null===(t=o.find(e=>e._id===l))||void 0===t?void 0:t.conversationMedia,a=(0,z.nc)(e=>e.organizationId);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(B,{organizationId:a,botId:l,mimeType:i}),(0,P.jsx)(E,{botId:l,organizationId:a,conversationMediaList:r,mimeType:i,handleSelection:s,selectedFiles:n})]})};function B(e){var t;let{organizationId:i,botId:x,mimeType:h=".png,.jpeg,.jpg,.mpeg,.mp4,.pdf"}=e;const[f,y]=n.useState(!1),g=(0,n.useRef)(null),j=(0,z.nc)(e=>e.conversationMediaUpdate),b=null===(t=(0,z.nc)(e=>e.botsList).find(e=>e._id===x))||void 0===t?void 0:t.conversationMedia,S=w.pA?w.pA:5242880,C=v.Ik().shape({file:v.gl().required("File is not selected").test("is-valid-size",`Maximum allowed file size is ${S/1048576} MB`,e=>e&&e.size<=S)});return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(L.y,{ref:g}),(0,P.jsxs)(s.Ay,{container:!0,spacing:3,children:[(0,P.jsx)(s.Ay,{item:!0,xs:8,children:(0,P.jsx)(o.A,{variant:"h5",children:"Conversation Media"})}),(0,P.jsx)(s.Ay,{item:!0,xs:3,sx:{position:"relative",display:"flex",justifyContent:"flex-end"},children:j&&(0,P.jsx)("div",{style:{position:"fixed"},children:(0,P.jsx)(I.A,{children:(0,P.jsx)(T.A,{isLoading:isKeyWordSubmitting,disabled:isKeyWordSubmitting,variant:"contained",color:"success",size:"large",onClick:updateConversationMediaKeywords,children:"Save Changes"})})})}),(0,P.jsx)(s.Ay,{item:!0,xs:1,sx:{position:"relative"},style:{paddingTop:25,display:"flex",justifyContent:"right"},children:(0,P.jsx)(d.A,{title:"Upload Conversation Media",children:(0,P.jsx)(u.A,{color:"primary",size:"small",style:{position:"fixed"},onClick:()=>{y(!0)},children:(0,P.jsx)(m.A,{})})})})]}),(0,P.jsx)(M.A,{openPopUpDialog:f,setPopUpDialog:y,title:"Upload Conversation Media",children:(0,P.jsx)(l.A,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:(0,P.jsxs)(s.Ay,{container:!0,spacing:3,justify:"center",children:[(0,P.jsx)(s.Ay,{item:!0,xs:12,style:{padding:0,display:"flex",alignItems:"baseline",justifyContent:"center"},children:"Upload Media (*.png,*.jpeg,*.jpg,*.mpeg,*.mp4,*.pdf)"}),(0,P.jsx)(s.Ay,{item:!0,xs:12,justify:"center",children:(0,P.jsx)(c.A,{style:{padding:0,display:"flex",alignItems:"flex-start",justifyContent:"center"},children:(0,P.jsx)(r.A,{spacing:1,children:(0,P.jsx)(A.l1,{initialValues:{file:null},validationSchema:C,onSubmit:async(e,t)=>{let{setErrors:n,setStatus:s,setSubmitting:o}=t;try{const{name:t}=e.file;b.some(e=>e.name===t)?g.current&&g.current.show({severity:"error",summary:"File Upload",detail:"The file already uploaded!. Please select another file",life:5e3}):(await async function(e,t,i){const n=new FormData;n.append("file",e);const s=await D.bE(`/bot/${i}/${t}/upload-conversation-media`,n),{conversationMedia:o}=s;(0,U.rv)(t,{conversationMedia:o})}(e.file,x,i),s({success:!0}),o(!0),y(!1),g.current&&g.current.show({severity:"success",summary:"File Upload",detail:"The file uploaded successfully!",life:5e3}))}catch(l){s({success:!1}),n({submit:l.message}),o(!1),y(!1),g.current&&g.current.show({severity:"error",summary:"File Upload",detail:"Not able to upload the file. Try after sometime!",life:5e3})}},children:e=>{let{values:t,errors:i,isSubmitting:n,setFieldValue:l}=e;return(0,P.jsxs)(A.lV,{children:[(0,P.jsxs)(s.Ay,{container:!0,spacing:2,children:[(0,P.jsx)(s.Ay,{item:!0,xs:12,md:12,children:t.file&&(0,P.jsxs)(o.A,{variant:"body2",children:["Selected File: ",t.file.name]})}),(0,P.jsx)(s.Ay,{item:!0,xs:6,md:6,style:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end"},children:(0,P.jsx)(A.D0,{type:"file",name:"file",as:e=>{let{field:t}=e;return(0,P.jsx)(I.A,{children:(0,P.jsxs)(p.A,{variant:"contained",component:"label",htmlFor:"file-input",size:"large",children:["SelectFile",(0,P.jsx)("input",{...t,type:"file",id:"file-input",style:{display:"none"},onChange:e=>{l("file",e.currentTarget.files[0])},accept:h})]})})}})}),(0,P.jsx)(s.Ay,{item:!0,xs:6,md:6,children:(0,P.jsx)(I.A,{children:(0,P.jsx)(p.A,{variant:"contained",size:"large",type:"submit",disabled:n,children:n?"Uploading...":"Upload"})})})]}),(0,P.jsx)(s.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(a.A,{error:!0,id:"helper-text-file-input",children:i.file})})]})}})})})})]})})})]})}function E(e){let{conversationMediaList:t,botId:i,organizationId:r,handleSelection:a,selectedFiles:d,mimeType:c}=e;const[p,x]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=((e,t)=>e?e.filter(e=>{const{type:i}=e;return!t||("application/pdf"===t?i===t:"image/*"===t?i.startsWith("image/"):"video/*"===t&&i.startsWith("video/"))}):[])(t,c),i=e.map(e=>({...e,isSelected:!!d&&d.some(t=>t.url===e.url)}));x(i)},[t,d,c]);const u=e=>{const t=p.map(t=>t.url===e.url?{...t,isSelected:!t.isSelected}:t);x(t),a(t)};return(0,P.jsx)(l.A,{children:(0,P.jsxs)(s.Ay,{container:!0,spacing:3,justify:"center",children:[(0,P.jsx)(s.Ay,{item:!0,xs:12,children:p&&0===p.length&&(0,P.jsx)(o.A,{variant:"caption",color:"#FF0000",children:(0,P.jsxs)(s.Ay,{container:!0,spacing:1,children:[(0,P.jsx)(s.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(b.A,{style:{fontSize:40}})}),(0,P.jsx)(s.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:"Conversation Media and Keywords are not uploaded!"})]})})}),p&&p.map((e,t)=>(0,P.jsx)(s.Ay,{item:!0,xs:12,sm:4,lg:3,justify:"center",children:(0,P.jsx)(N,{media:e,botId:i,organizationId:r,onToggleSelection:u,handleSelection:a})},t))]})})}function N(e){let{media:t,botId:i,organizationId:o,onToggleSelection:l,handleSelection:r}=e;const[a,d]=n.useState(!1),u=(0,n.useRef)(null),m=async(e,t,i,n)=>{try{const s={fileName:t,fileUrl:e};await async function(e,t,i){const n=await D.bE(`/bot/${t}/${i}/delete-conversation-media`,e),{conversationMedia:s}=n;(0,U.rv)(i,{conversationMedia:s})}(s,n,i),u.current&&u.current.show({severity:"success",summary:"File Delete",detail:"The file deleted successfully!",life:5e3})}catch(s){u.current&&u.current.show({severity:"error",summary:"Delete File",detail:"Not able to delete the file. Try after sometime!",life:5e3})}};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(L.y,{ref:u}),(0,P.jsxs)(S.A,{className:"main-card "+(t.isSelected?"card-selected":""),contentSX:{p:2,cursor:"pointer"},children:[(0,P.jsx)(c.A,{style:{padding:"24px 0 0 0",minHeight:"120px",maxHeight:"135px",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:(0,P.jsx)(s.Ay,{container:!0,spacing:3,justifyContent:"center",children:(0,P.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",textAlign:"center"},children:"image"===t.type.split("/")[0]?(0,P.jsxs)("a",{href:t.url,rel:"noreferrer",target:"_blank",title:t.name,children:[(0,P.jsx)("img",{src:t.url,alt:t.name,style:{maxHeight:"100px",margin:"0 auto"}}),(0,P.jsx)("strong",{className:"truncate overflow-hidden whitespace-nowrap py-2",style:{maxWidth:"100px",textOverflow:"ellipsis",display:"inline-block",overflow:"hidden"},children:t.name})]}):"application"===t.type.split("/")[0]?(0,P.jsxs)("a",{href:t.url,rel:"noreferrer",target:"_blank",title:t.name,children:[(0,P.jsx)("img",{src:k,alt:"LivServ",style:{maxHeight:"100px",margin:"0 auto"}}),(0,P.jsx)("strong",{className:"truncate overflow-hidden whitespace-nowrap py-2",style:{maxWidth:"100px",textOverflow:"ellipsis",display:"inline-block",overflow:"hidden"},children:t.name})]}):(0,P.jsxs)("video",{controls:!0,style:{maxWidth:"100%",margin:"0 auto"},children:[(0,P.jsx)("source",{src:t.url,type:"video/mp4"}),(0,P.jsx)("track",{kind:"captions",src:"",srcLang:"en",label:"English"}),"Your browser does not support the video tag."]})})})}),(0,P.jsx)(x.A,{style:{justifyContent:"flex-end",padding:"5px"},children:(0,P.jsxs)(s.Ay,{container:!0,children:[(0,P.jsxs)(s.Ay,{item:!0,xs:3,md:3,children:[(0,P.jsx)(p.A,{size:"small",component:"label",variant:"contained",onClick:()=>d(!0),color:"error",startIcon:(0,P.jsx)(h.A,{fontSize:"small"}),title:"Delete File"}),(0,P.jsxs)($.A,{title:"Delete file?",open:a,setOpen:d,onConfirm:()=>m(t.url,t.name,i,o),children:["Confirm the deletion of ",t.name,"?"]})]}),(0,P.jsx)(s.Ay,{item:!0,xs:3,md:3,children:(0,P.jsx)(p.A,{size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{return e=t.url,void window.open(e);var e},startIcon:(0,P.jsx)(f.A,{}),title:"View File"})}),(0,P.jsx)(s.Ay,{item:!0,xs:3,md:3,children:(0,P.jsx)(p.A,{color:"primary",size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{navigator.clipboard.writeText(t.url).then(()=>{(0,C.i)(!0,"Image URL copied to clipboard!","success")})},startIcon:(0,P.jsx)(y.A,{}),title:"Copy Url"})}),(0,P.jsx)(s.Ay,{item:!0,xs:3,md:3,children:r&&(0,P.jsx)(p.A,{color:t.isSelected?"success":"primary",size:"small",component:"label",role:void 0,variant:"contained",onClick:()=>{l(t)},startIcon:t.isSelected?(0,P.jsx)(g.A,{}):(0,P.jsx)(j.A,{}),title:"Select File"})})]})})]})]})}},26092:(e,t,i)=>{i.d(t,{A:()=>u});i(9950);var n=i(92728),s=i(63464),o=i(40033),l=i(28170),r=i(96319),a=i(59254),d=i(14857),c=i(25333),p=i(44414);const x=(0,a.Ay)(s.A)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)},zIndex:11010}});function u(e){const t=(0,d.A)(),{breakpoints:i}=t,{openPopUpDialog:s,setPopUpDialog:a,setFieldsValues:u,onClose:m=()=>(a(!1),null===u||void 0===u?void 0:u({})),title:h,width:f="70%"}=e;return(0,p.jsxs)(x,{TransitionComponent:n.A,"aria-labelledby":"customized-dialog-title",open:s,PaperProps:{sx:{width:{width:f},[i.down("sm")]:{width:"90%"}}},children:[(0,p.jsx)(o.A,{sx:{m:0,p:2},id:"customized-dialog-title",children:h}),(0,p.jsx)(c.A,{"aria-label":"close",onClick:m,sx:{position:"absolute",right:8,top:8},children:(0,p.jsx)(r.A,{})}),(0,p.jsx)(l.A,{dividers:!0,children:e.children})]})}},46278:(e,t,i)=>{i.d(t,{A:()=>d});i(9950);var n=i(63464),s=i(40033),o=i(28170),l=i(79739),r=i(10226),a=i(44414);const d=e=>{const{title:t,children:i,open:d,setOpen:c,onConfirm:p}=e;return(0,a.jsxs)(n.A,{open:d,onClose:()=>c(!1),style:{zIndex:1e4},children:[(0,a.jsx)(s.A,{sx:{m:0,p:2},id:"confirm-dialog",children:t}),(0,a.jsx)(o.A,{dividers:!0,children:i}),(0,a.jsxs)(l.A,{children:[(0,a.jsx)(r.A,{size:"large",type:"submit",variant:"contained",color:"secondary",onClick:()=>c(!1),children:"No"}),(0,a.jsx)(r.A,{size:"large",type:"submit",variant:"contained",color:"success",onClick:()=>{c(!1),p()},children:"Yes"})]})]})}},51637:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(9950),s=i(14857),o=i(48089),l=i(45180),r=i(82053),a=i(50704),d=i(44414);const c={p:2.5,"& .MuiCardHeader-action":{m:"0px auto",alignSelf:"center"}},p=(0,n.forwardRef)((e,t)=>{let{border:i=!0,boxShadow:n,children:p,content:x=!0,contentSX:u={},darkTitle:m,elevation:h,secondary:f,shadow:y,sx:g={},title:j,...b}=e;const v=(0,s.A)();return n="dark"===v.palette.mode?n||!0:n,(0,d.jsxs)(o.A,{elevation:h||0,ref:t,...b,sx:{border:i?"1px solid":"none",borderRadius:2,borderColor:"dark"===v.palette.mode?v.palette.divider:v.palette.grey.A800,boxShadow:!n||i&&"dark"!==v.palette.mode?"inherit":y||v.customShadows.z1,":hover":{boxShadow:n?y||v.customShadows.z1:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:v.typography.fontFamily,fontSize:"0.75rem"},...g},children:[!m&&j&&(0,d.jsx)(l.A,{sx:c,titleTypographyProps:{variant:"subtitle1"},title:j,action:f}),m&&j&&(0,d.jsx)(l.A,{sx:c,title:(0,d.jsx)(r.A,{variant:"h3",children:j}),action:f}),x&&(0,d.jsx)(a.A,{sx:u,children:p}),!x&&p]})})},92728:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(9950),s=i(48205),o=i(44414);const l=n.forwardRef(function(e,t){return(0,o.jsx)(s.A,{direction:"up",ref:t,...e})})},98415:(e,t,i)=>{i.d(t,{Ci:()=>p,I4:()=>c,TF:()=>a,gI:()=>l,gR:()=>u,jo:()=>d,rv:()=>m,so:()=>x,yo:()=>r});var n=i(8478),s=i(33340),o=i(32026);async function l(e){const{organization:{websiteUrl:t,_id:i}}=s.nc.getState(),o={organizationId:i,websiteUrl:t,botName:e,botDesign:{visitorMessageLogo:{name:"",url:""},botMessageLogo:{name:"",url:""},botChatButton:{name:"",url:""},botLogo:{name:"",url:""},backgroundColor:"#e7a654",textColor:"#ffffff",dimensions:{heightInPixel:"500px",heightInPercent:"70%",widthInPixel:"350px",widthInPercent:"25%"},botLogoDimensions:{heightInPixel:"30px",heightInPercent:"100%",widthInPixel:"30px",widthInPercent:"100%"}}};h(await n.bE(`/bot/${i}`,o),!0)}async function r(e,t,i){const{organizationId:o}=s.nc.getState();if(!o||!e)throw new Error("Bot details not found");const l=await n.yJ(`/bot/${o}/${e}`,t);return h(l,i),l}async function a(e){const{organizationId:t,selectedBotId:i}=s.nc.getState();if(!t||!e)throw new Error("Bot details not found");const{deleted:o}=await n.TF(`/bot/${t}/${e}`);if(o){let{botsMap:e,botsList:t}=s.nc.getState();e={...e},t=[...t],delete e[o];const n=t.findIndex(e=>e._id===o);n>=0&&t.splice(n,1);const r={botsMap:e,botsList:t};var l;if(i===o)r.selectedBotId=(null===(l=t[0])||void 0===l?void 0:l._id)||null;s.nc.setState(r)}return!!o}function d(e,t){let{botDesign:i}=s.nc.getState();return i={...i,...t},r(e,{botDesign:i})}async function c(e,t){const{organizationId:i,selectedBotId:o}=s.nc.getState(),l=new FormData;l.append("file",t);const r=await n.bE(`/bot/${i}/${o}/update-logo/${e}`,l);return m(o,r),r[`botDesign.${e}`]}async function p(e){const{organizationId:t,selectedBotId:i}=s.nc.getState(),o=await n.TF(`/bot/${t}/${i}/update-logo/${e}`);return m(i,o),o[`botDesign.${e}`]}function x(e,t){return r(e,{botName:t})}function u(e,t){let{botSettings:i={}}=s.nc.getState();return i={...i,...t},r(e,{botSettings:i})}function m(e,t){const{botsMap:i}=s.nc.getState(),n=i[e];if(!n)return;h(Object.keys(t).reduce((e,i)=>(0,o.G6)(e,i,t[i]),n))}function h(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=e._id;let{botsMap:n,botsList:o}=s.nc.getState();n={...n,[i]:e},o=[...o];const l=o.findIndex(e=>e._id===i);l>=0?o[l]=e:o.push(e);const r={botsMap:n,botsList:o};t&&(r.selectedBotId=i),s.nc.setState(r)}}}]);