"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[7597],{3602:(e,t,n)=>{n.d(t,{Ay:()=>h});var a=n(89379),r=n(9950),o=n(59051),i=n.n(o),s=n(32796),c=(n(52010),n(44414));const l=["This month","One month","Prev month","This week","Last 7 days","Prev week","Prev 2 weeks","Last 14 days"];function d(){return{"This month":[i()().startOf("month").toDate(),i()().endOf("month").toDate()],"One month":[i()().subtract(1,"months").toDate(),i()().toDate()],"Prev month":[i()().subtract(1,"months").startOf("month").toDate(),i()().subtract(1,"months").endOf("month").toDate()],"This week":[i()().startOf("week").toDate(),i()().endOf("week").toDate()],"Last 7 days":[i()().subtract(6,"days").toDate(),i()().toDate()],"Prev week":[i()().subtract(1,"weeks").startOf("week").toDate(),i()().subtract(1,"weeks").endOf("week").toDate()]}}function u(e){const t=r.useMemo(d,[]),{timePicker24Hour:n,displayFormat:o}=function(e){let t=u.defaultTimeFormat||" hh:mm tt";const n=-1===t.indexOf("tt");t=t.replace("tt","A").replace(".ss","").replace(":ss","");const a=e.dateFormat||"DD-MMM-YYYY".concat(e.showTime?t:"");return{timePicker24Hour:n,displayFormat:a}}(e),{value:h,range:g}=e,[v,A]=r.useState((()=>m(h,g,o))),f=r.useCallback((e=>A((t=>(0,a.A)((0,a.A)({},t),e)))),[A]),y=r.useRef(),b=r.useRef({props:e,state:v,displayFormat:o});b.current.state=v,b.current.props=e,b.current.displayFormat=o;const j=r.useCallback((()=>f(m(h,g,b.current.displayFormat))),[h,g,f]);r.useEffect((()=>{j()}),[j]);const D=r.useCallback(((e,t)=>{var n,a;const{props:r,displayFormat:o}=b.current;b.current.manuallyEdited=!1;const{range:i,field:s,args:c}=r;let d=t.startDate,u=null===(n=d)||void 0===n?void 0:n.toDate(),h="";if(i){const{chosenLabel:e,startDate:n,endDate:a}=t;if(n&&a){u={fromDate:n.toDate(),toDate:a.toDate()};const t=l.indexOf(e);t>=0&&(u.quickDate=t),h="".concat(n.format(o)," - ").concat(a.format(o)),d=[u.fromDate,u.toDate]}}else null!==(a=d)&&void 0!==a&&a.isValid()&&(h=d.format(o));f({value:d,displayDate:h}),r.onChange(u,s,c)}),[f]),S=r.useCallback((e=>{const{manuallyEdited:t,props:n,state:a,displayFormat:r}=b.current;if(t){let{target:{value:t}}=e;if(t=t.trim(),!t&&!0===n.allowClear)return void D(null,{startDate:null});let o=i()(t,r);o.isValid()||(o=i()(t)),o.isValid()&&o.format(r)===t||(o=a.value),y.setStartDate(o),y.setEndDate(o),D(null,{fromDate:o})}else null!==e&&void 0!==e&&e.currentTarget&&n.onBlur&&n.onBlur(e)}),[D]),_=r.useCallback((e=>{const{props:t}=b.current,{keyCode:n}=e;13===n?S(e):t.onKeyDown&&(27===n&&(j(t),b.current.manuallyEdited=!1),t.onKeyDown(e))}),[S,j]),P=r.useCallback((()=>b.current.manuallyEdited=!0),[]),{disabled:w,style:C,className:E,autoFocus:k,fullWidth:T}=e,{displayDate:R}=v;return(0,c.jsx)("div",{className:"react-bootstrap-daterangepicker-container "+(E||""),children:(0,c.jsx)(s.A,{ref:y,style:C,className:E,disabled:w,initialSettings:x({timePicker24Hour:n,dateRange:t,props:e,state:v}),onApply:D,children:(0,c.jsx)("span",{children:(0,c.jsx)("input",{type:"text",className:"date-range-ctl",value:R,readOnly:g,placeholder:p(e),autoFocus:k,onChange:g?void 0:P,onBlur:g?void 0:S,onKeyDown:_,style:T?{width:"100%",height:"40px"}:null})})})})}const h=u;function m(e,t,n){const a={displayDate:""};return e?t?"object"===typeof e&&(e=e.quickDate>=0?function(e,t){if(0===e||e>0){const n=d(),a=l[e],r=a&&n[a]||[];return t?r.map((e=>i()(e))):r}}(e.quickDate,!0):"object"===typeof e&&e.fromDate?[i()(e.fromDate),i()(e.toDate)||null]:[],a.value=e,e[0]&&e[1]&&(a.displayDate="".concat(e[0].format(n)," - ").concat(e[1].format(n)))):(a.value=i()(e),a.displayDate=a.value.format(n)):t&&(a.value=[]),a}function p(e){const{range:t}=e;let{placeholder:n}=e;return!0===t&&(n=n||"Select a date range"),n||"Select a date"}function x(e){let{dateRange:t,timePicker24Hour:n,props:{showTime:r,range:o,minDate:i,maxDate:s,maxSpan:c=6},state:{value:l}}=e;const d={showDropdowns:!0,timePicker:r||!1,alwaysShowCalendars:!1,maxSpan:c,autoApply:!0,linkedCalendars:!1,autoUpdateInput:!1,minDate:i,maxDate:s};let u=null;return u=o?(0,a.A)((0,a.A)({},d),{},{fromDate:l[0],toDate:l[1],ranges:t,singleDatePicker:!1,showCustomRangeLabel:!0}):(0,a.A)((0,a.A)({},d),{},{singleDatePicker:!0,fromDate:l,toDate:l,timePicker24Hour:n}),u}},8478:(e,t,n)=>{n.d(t,{Jt:()=>l,TF:()=>h,bE:()=>d,yJ:()=>u});var a=n(89379),r=n(80045),o=n(32026),i=n(44364);const s=["headers","noAuth"],c=["data"];async function l(e,t){return m("GET",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function d(e,t){return m("POST",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function u(e,t){return m("PUT",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function h(e,t){return m("DELETE",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function m(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{headers:i,noAuth:l}=o,d=(0,r.A)(o,s);const u="POST"===e||"PUT"===e||"DELETE"===e;t=function(e,t){if(!e)return e;const n=t&&Object.keys(t);if(null!==n&&void 0!==n&&n.length){const a=n.reduce(((e,n)=>{let a=t[n];return null===a||void 0===a?e:(a="".concat(n,"=").concat(encodeURIComponent(a)),e?"".concat(e,"&").concat(a):a)}),"");a&&(e="".concat(e).concat(e.includes("?")?"&":"?").concat(a))}if(e.startsWith("https://"))return e;return"".concat(p).concat(e)}(t,u?void 0:n);const h=n instanceof FormData;if(h||(n=n&&"object"===typeof n&&u?JSON.stringify(n):void 0),i||(i={}),h||(i["Content-Type"]="application/json"),i.Accept="application/json",!1!==l){const e=sessionStorage.getItem("token");e&&(i.Authorization="Bearer ".concat(e))}try{const o=await fetch(t,(0,a.A)((0,a.A)({},d),{},{headers:i,body:n,method:e})),s=await o.json();if(o.ok){const{data:e}=s,t=(0,r.A)(s,c);return delete t.status,e&&!Object.keys(t).length?e:s}throw s.message?new Error(s.message):s}catch(x){var m;throw console.error("Error calling API: ",x),null!==(m=x.message)&&void 0!==m&&m.includes("fetch")?new Error("Unable to reach server. Please check your network connectivity and try again."):new Error(x.message)}}const p=(0,o.s8)(i.jn,"/")},31408:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59051),r=n.n(a);const o=function(e){let{value:t,dateOnly:n}=e;return r()(t).format(n?"DD-MMM-YYYY":"DD-MMM-YYYY HH:mm:ss")}},32026:(e,t,n)=>{n.d(t,{G6:()=>c,Ke:()=>m,OX:()=>d,PE:()=>h,TZ:()=>p,Yq:()=>s,do:()=>u,qW:()=>l,s8:()=>o,wE:()=>x});var a=n(89379),r=n(44364);function o(e,t){return e.replace(new RegExp("".concat(i(t),"+$")),"")}function i(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function s(e){const t=new Date(e),n=t.getDate(),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],r=t.getFullYear();return"".concat(a," ").concat(n,", ").concat(r)}function c(e,t,n){if(!t&&!e)return n;e=e||{};const r=Array.isArray(e)?[...e]:(0,a.A)({},e);if(t.includes(".")){const a=t.indexOf("."),o=t.substring(0,a),i=t.substring(a+1);r[o]=c(e[o],i,n)}else r[t]=n;return r}function l(e,t){return btoa("".concat(e,"_").concat(t,"_whatsapp_int"))}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<e;a++)n+=t.charAt(Math.floor(36*Math.random()));return n}function u(e,t,n){if(!t&&!e)return n;e=e||{};const r=Array.isArray(e)?[...e]:(0,a.A)({},e);if(t.includes(".")){const a=t.indexOf("."),o=t.substring(0,a),i=t.substring(a+1);r[o]=u(e[o],i,n)}else r[t]=n;return r}function h(e,t){const n=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function m(e,t){return!t||t.startsWith("http")?t:(t.startsWith("/")&&(t=t.substring(1)),"".concat(r.J,"/").concat(e,"/").concat(t))}function p(e){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.getElementsByTagName("head")[0].appendChild(t)),null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.favicon&&(t.href=m(null===e||void 0===e?void 0:e.domain,null===e||void 0===e?void 0:e.favicon)):t.href="/favicon.png"}function x(e){null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.displayName&&(document.title=null===e||void 0===e?void 0:e.displayName):document.title="LivServ"}},44364:(e,t,n)=>{n.d(t,{DX:()=>l,E1:()=>u,J:()=>c,Og:()=>o,Rc:()=>d,jn:()=>a,mB:()=>s,pA:()=>i,pR:()=>r});const a="https://devbackend.livhousing.com:444",r="c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com:444/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com:444/voice/ws"}.TRAINING_MEDIA_MAXSIZE,i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com:444/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com:444/voice/ws"}.CONVERSATION_MEDIA_MAXSIZE,s="AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",c="https://livserv-organizations.s3.ap-south-1.amazonaws.com",l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RVM_BACKEND_URL:"https://devbackend.livhousing.com:444/",REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444",REACT_APP_RVM_WEB_SOCKET_URL:"wss://devbackend.livhousing.com:444/voice/ws"}.REACT_APP_NGROK_BACKEND_URL||"https://devbackend.livhousing.com:444",d="https://devbackend.livhousing.com:444/",u="wss://devbackend.livhousing.com:444/voice/ws"},51637:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(89379),r=n(80045),o=n(9950),i=n(14857),s=n(48089),c=n(45180),l=n(82053),d=n(50704),u=n(44414);const h=["border","boxShadow","children","content","contentSX","darkTitle","elevation","secondary","shadow","sx","title"],m={p:2.5,"& .MuiCardHeader-action":{m:"0px auto",alignSelf:"center"}},p=(0,o.forwardRef)(((e,t)=>{let{border:n=!0,boxShadow:o,children:p,content:x=!0,contentSX:g={},darkTitle:v,elevation:A,secondary:f,shadow:y,sx:b={},title:j}=e,D=(0,r.A)(e,h);const S=(0,i.A)();return o="dark"===S.palette.mode?o||!0:o,(0,u.jsxs)(s.A,(0,a.A)((0,a.A)({elevation:A||0,ref:t},D),{},{sx:(0,a.A)({border:n?"1px solid":"none",borderRadius:2,borderColor:"dark"===S.palette.mode?S.palette.divider:S.palette.grey.A800,boxShadow:!o||n&&"dark"!==S.palette.mode?"inherit":y||S.customShadows.z1,":hover":{boxShadow:o?y||S.customShadows.z1:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:S.typography.fontFamily,fontSize:"0.75rem"}},b),children:[!v&&j&&(0,u.jsx)(c.A,{sx:m,titleTypographyProps:{variant:"subtitle1"},title:j,action:f}),v&&j&&(0,u.jsx)(c.A,{sx:m,title:(0,u.jsx)(l.A,{variant:"h3",children:j}),action:f}),x&&(0,u.jsx)(d.A,{sx:g,children:p}),!x&&p]}))}))},90587:(e,t,n)=>{function a(e,t){return"desc"===e?(e,n)=>r(e,n,t):(e,n)=>-r(e,n,t)}function r(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function o(e,t){const n=e.map(((e,t)=>[e,t]));return n.sort(((e,n)=>{const a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((e=>e[0]))}n.d(t,{h:()=>a,q:()=>o})},93176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe});var a=n(9950),r=n(59051),o=n.n(r),i=n(60899),s=n(82053),c=n(3602),l=n(81616),d=n(25277),u=n(78317),h=n(51637),m=n(40271),p=n(18182),x=n(44414);const g=function(e){let{title:t,count:n,percentage:a,extra:r,period:o="month",color:c=(r<0?"warning":"success")}=e;const g=r<0;return r=Math.abs(r||0),(0,x.jsxs)(h.A,{contentSX:{p:2.25},children:[(0,x.jsxs)(l.A,{spacing:.5,children:[(0,x.jsx)(s.A,{variant:"h6",color:"textSecondary",children:t}),(0,x.jsxs)(i.Ay,{container:!0,alignItems:"center",children:[(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(s.A,{variant:"h4",color:"inherit",children:n})}),!!a&&(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(d.A,{variant:"combined",color:c,icon:(0,x.jsxs)(x.Fragment,{children:[!g&&(0,x.jsx)(m.A,{style:{fontSize:"0.75rem",color:"inherit"}}),g&&(0,x.jsx)(p.A,{style:{fontSize:"0.75rem",color:"inherit"}})]}),label:"".concat(a,"%"),sx:{ml:1.25,pl:1},size:"small"})})]})]}),g&&(0,x.jsx)(u.A,{sx:{pt:2.25},children:(0,x.jsxs)(s.A,{variant:"caption",color:"textSecondary",children:["You're down by "," ",(0,x.jsx)(s.A,{component:"span",variant:"caption",sx:{color:"".concat(c||"primary",".main")},children:r})," ","this ",o]})}),!g&&(0,x.jsx)(u.A,{sx:{pt:2.25},children:(0,x.jsxs)(s.A,{variant:"caption",color:"textSecondary",children:["You made an extra"," ",(0,x.jsx)(s.A,{component:"span",variant:"caption",sx:{color:"".concat(c||"primary",".main")},children:r})," ","this ",o]})})]})};var v=n(33340);const A=function(){const e=(0,v.qi)((e=>e.overview)),{current:t={},difference:n={},diffPercentage:a={}}=e||{};return(0,x.jsxs)(x.Fragment,{children:[t.totalVisitors>0&&(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"Total Visitors",count:t.totalVisitors,percentage:a.totalVisitors,extra:n.totalVisitors})}),(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"Interactive Visitors",count:t.interactiveVisitors,percentage:a.interactiveVisitors,extra:n.interactiveVisitors})}),(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"Presales",count:t.preSale,percentage:a.preSale,extra:n.preSale})}),(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"General",count:t.general,percentage:a.general,extra:n.general})}),!t.revisit&&(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"Others",count:t.others,percentage:a.others,extra:n.others})}),!!t.revisit&&(0,x.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,x.jsx)(g,{title:"Revisit Count",count:t.revisit,percentage:a.revisit,extra:n.revisit})}),(0,x.jsx)(i.Ay,{item:!0,md:8,sx:{display:{sm:"none",md:"block",lg:"none"}}})]})};var f=n(89379),y=n(8478);async function b(){const{organizationId:e,selectedBotId:t}=v.nc.getState(),n=v.qi.getState(),{organizationId:a,botId:r}=n;let{fromDate:i,toDate:s}=n;i=o()(i).startOf("day").toDate(),s=o()(s).endOf("day").toDate();e===a&&t===r||v.qi.setState((0,v.Vs)(e,t),!0);const c=await y.Jt("/analytics/".concat(e,"/").concat(t,"/dashboard/overview"),{fromDate:i,toDate:s}),l=function(e,t){e=o()(e),t=o()(t);const n=t.diff(e,"days"),a=e.clone().subtract(1,"days");return{start:a.clone().subtract(n,"days").startOf("day").toDate(),end:a.endOf("day").toDate()}}(i,s);i=l.start,s=l.end;const d=await y.Jt("/analytics/".concat(e,"/").concat(t,"/dashboard/overview"),{fromDate:i,toDate:s}),u={interactiveVisitors:(c.interactiveVisitors||0)-(d.interactiveVisitors||0),preSale:(c.preSale||0)-(d.preSale||0),general:(c.general||0)-(d.general||0),others:(c.others||0)-(d.others||0),revisit:(c.revisit||0)-(d.revisit||0)},h={current:c,previous:d,difference:u,diffPercentage:{interactiveVisitors:S(d.interactiveVisitors,u.interactiveVisitors),preSale:S(d.preSale,u.preSale),general:S(d.general,u.general),others:S(d.others,u.others),revisit:S(d.revisit,u.revisit)}};v.qi.setState({overview:h})}async function j(e){const{organizationId:t,selectedBotId:n}=v.nc.getState(),a=v.qi.getState();let{visitorProps:r}=a;r=(0,f.A)((0,f.A)({page:1,count:10},r),e),v.qi.setState({visitorProps:r,visitorList:null,visitorsListTotal:0});const{total:o,visitorList:i}=await y.Jt("/analytics/".concat(t,"/").concat(n,"/dashboard/visitors-list"),r);v.qi.setState({visitorsListTotal:o,visitorList:i})}function D(e){let{fromDate:t,toDate:n}=e;return v.qi.setState({fromDate:o()(t).startOf("day").toDate(),toDate:o()(n).endOf("day").toDate()}),b()}function S(e,t){return t&&e?parseFloat((100*t/e).toFixed(2)):0}var _=n(10226);const P=function(e){let{showToday:t=!1,value:n=(t?"day":"week"),customRange:r,onChange:s}=e;const[c,d]=a.useState(n),u=a.useRef({onChange:s,slot:c});u.current.slot=c,u.current.customRange=r,a.useEffect((()=>{if("custom"===u.current.slot){const{onChange:e}=u.current;e(r)}}),[r]);const h=a.useCallback((e=>{d(e);const{onChange:t}=u.current;if(t)if("custom"===e)t(u.current.customRange);else{t({fromDate:o()().add(-1,e).add(1,"day").startOf("day").toDate(),toDate:o()().endOf("day").toDate()})}}),[]);return u.current.handleChange=h,a.useEffect((()=>{u.current.handleChange(u.current.slot)}),[]),(0,x.jsx)(i.Ay,{item:!0,style:{paddingTop:"14px"},children:(0,x.jsxs)(l.A,{direction:"row",alignItems:"center",spacing:.5,children:[!!r&&(0,x.jsx)(_.A,{size:"small",onClick:()=>h("custom"),color:"primary",variant:"custom"===c?"contained":"outlined",children:"Custom"}),(0,x.jsx)(_.A,{size:"small",onClick:()=>h("month"),color:"primary",variant:"month"===c?"contained":"outlined",children:"Month"}),(0,x.jsx)(_.A,{size:"small",onClick:()=>h("week"),color:"primary",variant:"week"===c?"contained":"outlined",children:"Week"}),t&&(0,x.jsx)(_.A,{size:"small",onClick:()=>h("day"),color:"primary",variant:"day"===c?"contained":"outlined",children:"Today"})]})})};var w=n(69780),C=n(9213),E=n(21671),k=n(7251),T=n(72595),R=n(6258),O=n(1320),I=n(15769),L=n(34075),M=n(80691),N=n(14857);const V=e=>{let{color:t,size:n}=e;const a=(0,N.A)();let r;switch(t){case"secondary":r=a.palette.secondary.main;break;case"error":r=a.palette.error.main;break;case"warning":r=a.palette.warning.main;break;case"info":r=a.palette.info.main;break;case"success":r=a.palette.success.main;break;default:r=a.palette.primary.main}return(0,x.jsx)(u.A,{sx:{width:n||8,height:n||8,borderRadius:"50%",bgcolor:r}})};var B=n(31408),K=n(48746),Y=n(32026);const F=[{id:"name",label:"Name"},{id:"email",disablePadding:!0,label:"Email Id"},{id:"phoneNumber",label:"Phone Number",sortable:!1},{id:"country",label:"Country"},{id:"city",label:"City"},{id:"visitTime",label:"Visit Time"},{id:"category",label:"Category"},{id:"transcriptUrl",align:"right",label:"Transcript",sortable:!1}];function q(e){let{order:t,orderBy:n}=e;return(0,x.jsx)(w.A,{children:(0,x.jsx)(C.A,{children:F.map((e=>(0,x.jsxs)(E.A,{align:e.align||"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&("desc"===t?"asc":"desc"),children:[!1===e.sortable&&e.label,!1!==e.sortable&&(0,x.jsxs)(k.A,{active:n===e.id,direction:n===e.id?"desc"===t?"asc":"desc":"asc",onClick:()=>j({orderBy:e.id,order:n===e.id?"desc"===t?"asc":"desc":"asc"}),children:[e.label,n===e.id?(0,x.jsx)(u.A,{component:"span",sx:M.A,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})]},e.id)))})})}function U(e){let{page:t=0,rowsCount:n,rowsPerPage:a=10}=e;return(0,x.jsx)(T.A,{children:(0,x.jsx)(C.A,{children:(0,x.jsx)(E.A,{colSpan:F.length,children:(0,x.jsx)(R.A,{component:"div",count:n,page:t,rowsPerPage:a,onPageChange:(e,t)=>j({page:t+1}),onRowsPerPageChange:(e,t)=>{let{props:{value:n}}=t;return j({count:n,page:1})}})})})})}const z=e=>{let t,{value:n}=e;switch(n){case"Pre-Sale":t="success";break;case"General":t="primary";break;case"Others":t="warning";break;default:t="error"}return(0,x.jsxs)(l.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,x.jsx)(V,{color:t}),(0,x.jsx)(s.A,{children:n})]})};function G(e){let{data:t,rowsCount:n,page:r,rowsPerPage:o,order:s,orderBy:c,dateRange:l}=e;const[d]=(0,a.useState)([]);let h=null;l&&(h="Leads - "+(0,Y.Yq)(l.fromDate)+" to "+(0,Y.Yq)(l.toDate));const m=(0,a.useRef)(null);return(0,x.jsx)(u.A,{children:(0,x.jsxs)(O.A,{sx:{width:"100%",overflowX:"auto",position:"relative",display:"block",maxWidth:"100%","& td, & th":{whiteSpace:"nowrap"}},children:[(0,x.jsxs)(I.A,{ref:m,"aria-labelledby":"VisitorList",sx:{"& .MuiTableCell-root:first-of-type":{pl:2},"& .MuiTableCell-root:last-of-type":{pr:3}},children:[(0,x.jsx)(q,{order:s,orderBy:c}),(0,x.jsxs)(L.A,{children:[!(null!==t&&void 0!==t&&t.length)&&(0,x.jsx)(C.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:(0,x.jsx)(E.A,{colSpan:7,children:"No visitors exists for the selected duration"})}),(null===t||void 0===t?void 0:t.length)>0&&t.map(((e,t)=>{return(0,x.jsx)(W,{row:e,index:t,isSelected:(n=e._id,-1!==d.indexOf(n))},e._id);var n}))]})]}),(0,x.jsxs)(i.Ay,{container:!0,spacing:2,justifyContent:"flex-end",alignItems:"center",children:[(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(K.DownloadTableExcel,{filename:h,sheet:"Leads",currentTableRef:m.current,children:(0,x.jsx)(_.A,{size:"large",variant:"contained",color:"success",disabled:!((null===t||void 0===t?void 0:t.length)>0),children:"Download excel"})})}),(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(U,{rowsCount:n,page:r,rowsPerPage:o,order:s,orderBy:c})})]})]})})}function W(e){let{row:t,index:n,isSelected:a}=e;const r="enhanced-table-checkbox-".concat(n);return(0,x.jsxs)(C.A,{hover:!0,role:"checkbox",sx:{"&:last-child td, &:last-child th":{border:0}},"aria-checked":a,tabIndex:-1,selected:a,children:[(0,x.jsx)(E.A,{component:"th",id:r,scope:"row",align:"left",children:t.name}),(0,x.jsx)(E.A,{align:"left",children:t.email}),(0,x.jsx)(E.A,{align:"left",children:t.phoneNumber}),(0,x.jsx)(E.A,{align:"left",children:t.country}),(0,x.jsx)(E.A,{align:"left",children:t.city}),(0,x.jsx)(E.A,{align:"left",children:(0,x.jsx)(B.A,{value:t.visitTime})}),(0,x.jsx)(E.A,{align:"left",children:(0,x.jsx)(z,{value:t.category})}),(0,x.jsx)(E.A,{align:"right",children:(0,x.jsx)("a",{href:t.transcriptUrl,target:"_blank",rel:"opener",children:(0,x.jsx)(s.A,{children:"View"})})})]},t._id)}var J=n(25979),H=n(3788),X=n(70006),Z=n(2660),Q=n(23266),$=n(93038),ee=n(83563);const te={PaperProps:{style:{maxHeight:224,width:250}}},ne=[{value:"preSale",label:"Pre-Sale"},{value:"general",label:"General"},{value:"others",label:"Others"}],ae=ne.reduce(((e,t)=>(e[t.value]=t.label,e)),{});const re=function(e){let{value:t=[],onChange:n}=e;return(0,x.jsxs)(J.A,{sx:{m:1,width:300,float:"left"},children:[(0,x.jsx)(H.A,{id:"visitor-type-label",style:{lineHeight:"15px"},children:"Visitor Category"}),(0,x.jsx)(X.A,{labelId:"visitor-type-label",id:"visitor-type",multiple:!0,value:t||[],onChange:e=>{n(e.target.value)},input:(0,x.jsx)(Z.A,{label:"Visitor Category"}),renderValue:e=>e.map((e=>ae[e])).join(", "),MenuProps:te,children:ne.map((e=>{let{value:n,label:a}=e;return(0,x.jsxs)(Q.A,{value:n,children:[(0,x.jsx)($.A,{checked:null===t||void 0===t?void 0:t.includes(n)}),(0,x.jsx)(ee.A,{primary:a})]},n)}))})]})};const oe=function(e){let{customRange:t}=e;const[n,r]=a.useState(),{visitorList:o,visitorProps:c,visitorsListTotal:l}=(0,v.qi)(),{category:d,count:u,page:m,orderBy:p,order:g}=c||{};return a.useEffect((()=>{n&&j(n).catch((e=>console.log("Error loading visitor list:-",e)))}),[n]),(0,x.jsxs)(i.Ay,{item:!0,xs:12,children:[(0,x.jsxs)(i.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(s.A,{variant:"h5",children:"Visitors List"})}),(0,x.jsx)(i.Ay,{item:!0,xs:9,alignItems:"right",children:(0,x.jsxs)(i.Ay,{container:!0,alignItems:"right",justifyContent:"flex-end",children:[(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(re,{value:d,onChange:e=>j({category:e})})}),(0,x.jsx)(P,{showToday:!0,customRange:t,onChange:r})]})})]}),(0,x.jsx)(h.A,{sx:{mt:2},content:!1,children:(0,x.jsx)(G,{data:o,orderBy:p,order:g,category:d,rowsCount:l||0,rowsPerPage:u||10,page:(m||1)-1,dateRange:n})})]})},ie=[{value:"country",text:"Country"},{value:"city",text:"City"},{value:"os",text:"OS Name"},{value:"browser",text:"Browser"},{value:"date",text:"Date"},{value:"landing_page",text:"Landing Page"}],se=ie.reduce(((e,t)=>(e[t.value]=t.text,e)),{});const ce=function(e){let{value:t,onChange:n}=e;return(0,x.jsx)(le,{list:ie,value:t,onChange:n})};function le(e){let{list:t,value:n,onChange:a}=e;return(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsx)(l.A,{direction:"row",alignItems:"center",spacing:0,children:t.map((e=>(0,x.jsx)(_.A,{size:"small",onClick:()=>a(e.value),color:n===e.value?"primary":"secondary",variant:n===e.value?"outlined":"text",children:e.text},e.value)))})})}var de=n(90587);const ue=[{id:"group",label:"Group"},{id:"totalInteractions",disablePadding:!0,label:"Interactions"},{id:"preSale",label:"Pre-Sale"},{id:"general",label:"General"},{id:"others",label:"Others"}];function he(e){let{order:t,orderBy:n}=e;return(0,x.jsx)(w.A,{children:(0,x.jsx)(C.A,{children:ue.map((e=>(0,x.jsx)(E.A,{align:e.align||"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t,children:e.label},e.id)))})})}function me(e){let{data:t}=e;const[n]=(0,a.useState)("asc"),[r]=(0,a.useState)("_id"),[o]=(0,a.useState)([]);return(0,x.jsx)(u.A,{children:(0,x.jsx)(O.A,{sx:{width:"100%",overflowX:"auto",position:"relative",display:"block",maxWidth:"100%","& td, & th":{whiteSpace:"nowrap"}},children:(0,x.jsxs)(I.A,{"aria-labelledby":"VisitorList",sx:{"& .MuiTableCell-root:first-of-type":{pl:2},"& .MuiTableCell-root:last-of-type":{pr:3}},children:[(0,x.jsx)(he,{order:n,orderBy:r}),(0,x.jsxs)(L.A,{children:[!(null!==t&&void 0!==t&&t.length)&&(0,x.jsx)(C.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:(0,x.jsx)(E.A,{colSpan:7,children:"No visitors exists for the selected duration"})}),(null===t||void 0===t?void 0:t.length)>0&&(0,de.q)(t,(0,de.h)(n,r)).map(((e,t)=>{return(0,x.jsx)(pe,{row:e,index:t,isSelected:(n=e._id,-1!==o.indexOf(n))},e.group);var n}))]})]})})})}function pe(e){let{row:t,index:n,isSelected:a}=e;const r="enhanced-table-checkbox-".concat(n);return(0,x.jsxs)(C.A,{hover:!0,role:"checkbox",sx:{"&:last-child td, &:last-child th":{border:0}},"aria-checked":a,tabIndex:-1,selected:a,children:[(0,x.jsx)(E.A,{component:"th",id:r,scope:"row",align:"left",children:t.group}),(0,x.jsx)(E.A,{align:"left",children:t.totalInteractions}),(0,x.jsx)(E.A,{align:"left",children:t.preSale||"-"}),(0,x.jsx)(E.A,{align:"left",children:t.general||"-"}),(0,x.jsx)(E.A,{align:"left",children:t.others||"-"})]})}const xe=function(){const[e,t]=a.useState("country"),n=(0,v.qi)((e=>e.visitorGroupedList)),{fromDate:r,toDate:o}=v.qi.getState();return a.useEffect((()=>{e&&async function(e){const{organizationId:t,selectedBotId:n}=v.nc.getState(),{fromDate:a,toDate:r}=v.qi.getState();v.qi.setState({visitorGroupedList:null});const o=await y.Jt("/analytics/".concat(t,"/").concat(n,"/dashboard/grouped/").concat(e),{fromDate:a,toDate:r});v.qi.setState({visitorGroupedList:o})}(e).catch((e=>console.log("Error loading visitor grouped list:-",e)))}),[e]),(0,x.jsxs)(i.Ay,{item:!0,xs:12,children:[(0,x.jsxs)(i.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,x.jsx)(i.Ay,{item:!0,children:(0,x.jsxs)(s.A,{variant:"h5",children:["Analytics - [",se[e]," Wise] (",(0,x.jsx)(B.A,{value:r,dateOnly:!0})," - ",(0,x.jsx)(B.A,{value:o,dateOnly:!0}),")"]})}),(0,x.jsx)(ce,{value:e,onChange:t})]}),(0,x.jsx)(h.A,{sx:{mt:2},content:!1,children:(0,x.jsx)(me,{data:n})})]})},ge=new Date("2023-10-01"),ve=o()().endOf("day").toDate(),Ae={month:3};const fe=function(){const{fromDate:e,toDate:t}=(0,v.qi)(),n=a.useMemo((()=>({fromDate:e,toDate:t})),[e,t]);return a.useEffect((()=>{b().catch((e=>console.error("Unable to load analytics data",e)))}),[]),(0,x.jsxs)(i.Ay,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,x.jsxs)(i.Ay,{item:!0,xs:12,children:[(0,x.jsx)(s.A,{variant:"h5",style:{display:"inline-block",marginRight:"18px"},children:"Dashboard"}),(0,x.jsx)(c.Ay,{range:!0,value:n,onChange:D,minDate:ge,maxDate:ve,maxSpan:Ae})]}),(0,x.jsx)(i.Ay,{item:!0,md:8,sx:{display:{sm:"none",md:"block",lg:"none"}}}),(0,x.jsx)(A,{}),(0,x.jsx)(xe,{}),(0,x.jsx)(oe,{customRange:n})]})}}}]);