"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[1489],{11489:(e,i,t)=>{t.r(i),t.d(i,{default:()=>q});var n=t(9950),r=t(78317),a=t(60899),s=t(82053),o=t(81616),l=t(3788),d=t(2660),c=t(24516),h=t(16497),x=t(93038),u=t(33092),m=t(59254),p=t(80417),g=t(79046),j=t(12504),A=t(4120),y=t(94540),b=t(29714),f=t(61467),w=t(33340),v=t(70855),S=t(32829),M=t(30334),C=t(93383),D=t(26092),U=t(21788),N=t(57988),I=t(62375),T=t(50704),z=t(53065),k=t(25713),L=t(25333),F=t(25277),B=t(51637),_=t(46278);function P(e,i,t,n){function r(e,i,t){const{botsList:n}=w.nc.getState(),r=n.find(i=>i._id===e);if(r){const n=r.trainingMedia.map(e=>e.url===i?{...e,name:t}:e);((e,i)=>{w.nc.setState(t=>{const n=t.botsList.map(t=>t._id===e?{...t,trainingMedia:i}:t);return{...t,botsList:n}})})(e,n),w.nc.setState(()=>({trainingMediaUpdate:!0}))}else console.error("Bot not found for the given ID.")}r(t,e,"delete"===n?e:i)}var W=t(44414);const O=function(e){let{media:i,botId:t,organizationId:r}=e;const[o,l]=n.useState(!1),{name:h,url:x,type:u,originalName:m}=i;return(0,W.jsxs)(B.A,{contentSX:{p:2.25},children:[(0,W.jsxs)(T.A,{style:{padding:0,minHeight:"65px",maxHeight:"65px"},children:[m&&(0,W.jsxs)(s.A,{variant:"h6",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"300px"},children:[(0,W.jsx)("strong",{children:"File Name :"})," ",(0,W.jsx)(z.A,{style:{cursor:"pointer"},title:m,children:(0,W.jsx)("span",{children:(0,W.jsx)("a",{href:x,target:"_blank",rel:"noreferrer",children:m})})})]}),"single_page"===u&&(0,W.jsxs)(s.A,{variant:"h6",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"300px"},children:[(0,W.jsx)("strong",{children:"URL :"})," ",(0,W.jsx)(z.A,{style:{cursor:"pointer"},title:x,children:(0,W.jsx)("span",{children:(0,W.jsx)("a",{href:x,target:"_blank",rel:"noreferrer",children:x})})})]}),(0,W.jsxs)(s.A,{variant:"h6",children:[(0,W.jsx)("strong",{children:"Type :"})," ","single_page"===u?"Web Page":"Document"]}),(0,W.jsxs)(s.A,{variant:"h6",children:[(0,W.jsx)("strong",{children:"Document Name :"})," ",h===x?"NA":(0,W.jsx)(F.A,{label:h,onDelete:()=>((e,i,t)=>{P(e,i,t,"delete")})(x,h,t)})]})]}),(0,W.jsx)(k.A,{style:{justifyContent:"flex-end",padding:"1px"},children:(0,W.jsxs)(a.Ay,{container:!0,children:[(0,W.jsx)(a.Ay,{item:!0,xs:10,md:10,children:h===x&&(0,W.jsx)(f.l1,{initialValues:{trainingMediaName:"",url:x},validationSchema:b.Ik().shape({trainingMediaName:b.Yj().max(50,"Training Media Name length must be less than 50 characters").min(3,"Training Media Name length must be at least 3 characters").required("Training Media Name is required")}),onSubmit:async(e,i)=>{let{setErrors:n,setStatus:r,setSubmitting:a}=i;const{trainingMediaName:s}=e;try{P(x,s,t,"add"),r({success:!0}),a(!0)}catch(o){r({success:!1}),n({submit:o.message}),a(!1)}},children:e=>{let{errors:i,handleBlur:t,handleChange:n,handleSubmit:r,isSubmitting:s,touched:o,values:l}=e;return(0,W.jsx)("form",{noValidate:!0,onSubmit:r,children:(0,W.jsxs)(a.Ay,{container:!0,spacing:1,children:[(0,W.jsxs)(a.Ay,{item:!0,xs:8,md:8,children:[(0,W.jsx)(d.A,{id:"trainingMediaName",type:"trainingMediaName",name:"trainingMediaName",placeholder:"Document Name",defaultValue:l.trainingMediaName,onBlur:t,onChange:n,fullWidth:!0,autoComplete:"off",error:Boolean(o.trainingMediaName&&i&&i.trainingMediaName)}),o.trainingMediaName&&i.trainingMediaName&&(0,W.jsx)(c.A,{error:!0,id:"helper-text-training-media-name",children:i.trainingMediaName})]}),(0,W.jsx)(a.Ay,{item:!0,xs:1,md:1,children:(0,W.jsx)(S.A,{children:(0,W.jsx)(C.A,{isLoading:s,disabled:s,type:"submit",variant:"contained",color:"primary",children:"Add"})})})]})})}})}),(0,W.jsx)(a.Ay,{item:!0,xs:1,md:1,children:(0,W.jsx)(z.A,{title:"text/plain"===u?"View Document":"View Web Page",children:(0,W.jsx)(L.A,{variant:"text",onClick:()=>{return e=x,void window.open(e);var e},children:(0,W.jsx)(I.A,{style:{color:"#5ad74e"}})})})}),(0,W.jsxs)(a.Ay,{item:!0,xs:1,md:1,children:[(0,W.jsx)(z.A,{title:"Delete",children:(0,W.jsx)(L.A,{variant:"text",onClick:()=>l(!0),children:(0,W.jsx)(N.A,{style:{color:"#ff0000"},fontSize:"small"})})}),(0,W.jsxs)(_.A,{title:"Delete file?",open:o,setOpen:l,onConfirm:()=>(async(e,i,t,n)=>{try{const r={organizationId:n,botId:t,fileName:i,fileUrl:e};await(0,M.qt)(r,t,n),(0,U.i)(!0,"The file deleted successfully!","success")}catch(r){(0,U.i)(!0,"Not able to delete the file. Try after sometime!","error")}})(x,m,t,r),children:["Confirm the deletion of ",m||x,"?"]})]})]})})]})};var V=t(6716),R=t(98415);const $=(0,m.Ay)(p.A)(e=>{let{theme:i}=e;return{position:"fixed","#trainingDocumentsSpeedDial &":{"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{left:"auto",right:i.spacing(2)},"&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{right:"auto",left:i.spacing(2)}}}});function E(e){let{botId:i,organizationId:t}=e;const[r,a]=n.useState(!1),[s,o]=n.useState(!1),l=[{icon:(0,W.jsx)(j.A,{}),name:"File Upload (.csv, .txt, .docx, .pdf)",method:()=>{o(!0)}},{icon:(0,W.jsx)(A.A,{}),name:"Add Web Page url",method:()=>{a(!0)}}];return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)($,{ariaLabel:"Upload Training Documents",hidden:!1,icon:(0,W.jsx)(g.A,{}),direction:"down",sx:{"& .MuiFab-primary":{width:40,height:40}},children:l.map(e=>(0,W.jsx)(u.A,{icon:e.icon,tooltipTitle:e.name,onClick:e.method},e.name))}),(0,W.jsx)(D.A,{openPopUpDialog:r,setPopUpDialog:a,title:"Train from website",children:(0,W.jsx)(H,{botId:i,organizationId:t,setWebPageUrlAddDialogOpen:a})}),(0,W.jsx)(V.A,{isOpen:s,toggleOpen:o})]})}const q=function(){var e;const[i,t]=(0,n.useState)(!1),[o,l]=(0,n.useState)(!1),d=(0,w.nc)(e=>e.botsList),c=(0,w.nc)(e=>e.organizationId),h=(0,w.nc)(e=>e.trainingMediaUpdate),[x]=(0,v.G)(),u=null===(e=d.find(e=>e._id===x))||void 0===e?void 0:e.trainingMedia;return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(r.A,{children:[(0,W.jsxs)(a.Ay,{container:!0,spacing:3,children:[(0,W.jsx)(a.Ay,{item:!0,xs:3,children:(0,W.jsx)(s.A,{variant:"h5",children:"Training Documents"})}),(0,W.jsx)(a.Ay,{item:!0,xs:6,sx:{position:"relative",display:"flex",justifyContent:"flex-end"},children:(0,W.jsx)("div",{style:{position:"fixed",right:75},children:(0,W.jsxs)(a.Ay,{container:!0,spacing:3,children:[(0,W.jsx)(a.Ay,{item:!0,children:h&&(0,W.jsx)(S.A,{children:(0,W.jsx)(C.A,{isLoading:i,disabled:i,variant:"contained",color:"success",size:"large",onClick:async()=>{try{t(!0),await(0,R.yo)(x,{trainingMedia:u}),w.nc.setState(()=>({trainingMediaUpdate:!1})),(0,U.i)(!0,"The document names updated successfully!","success"),t(!1)}catch(e){t(!1),(0,U.i)(!0,"Not able to add document names. Try after sometime!","error")}},children:"Save Changes"})})}),(0,W.jsx)(a.Ay,{item:!0,children:(0,W.jsx)(S.A,{children:(0,W.jsx)(C.A,{isLoading:o,disabled:o,variant:"contained",color:"success",size:"large",onClick:async()=>{l(!0);try{const e=await(0,M.Ei)(x,c),{deleted:i,totalDocs:n,supportedDocsCount:r,processedDocsCount:a,created:s,failedDocs:o}=e,d=o.length,h=d>0?d+" are failed to process":"all supported files processed successfully";l(!1),(0,U.i)(!0,`The bot training completed successfully! In ${n} files ${r} are supported, ${a} files processed, ${i} FAQ's deleted, ${s} FAQ's created and ${h}`,"success"),t(!1)}catch(e){l(!1),(0,U.i)(!0,"Not able to train the bot. Try after sometime!","error")}},children:"Train the bot"})})})]})})}),(0,W.jsx)(a.Ay,{item:!0,xs:1,sx:{position:"relative"},id:"trainingDocumentsSpeedDial",children:(0,W.jsx)(E,{botId:x,organizationId:c})})]}),(0,W.jsx)(r.A,{children:(0,W.jsx)(a.Ay,{container:!0,spacing:3,children:(0,W.jsx)(Y,{trainingMedia:u,botId:x,organizationId:c})})})]})})};function H(e){let{botId:i,organizationId:t,setWebPageUrlAddDialogOpen:n}=e;const[,r]=(0,v.G)();return(0,W.jsx)(a.Ay,{item:!0,xs:12,children:(0,W.jsx)(f.l1,{initialValues:{webpageUrl:""},validationSchema:b.Ik().shape({webpageUrl:b.Yj().url("Enter valid url!").required("Please enter webpage url")}),onSubmit:async(e,a)=>{let{setErrors:s,setStatus:o,setSubmitting:l}=a;try{const{trainingMedia:a}=r;if(a.some(i=>{var t,n;return(null===(t=i.url)||void 0===t?void 0:t.toLowerCase())===(null===(n=e.webpageUrl)||void 0===n?void 0:n.toLowerCase())}))(0,U.i)(!0,"This URL already available in the Training Documents!. Please add another URL","error");else{const r={url:e.webpageUrl,useBrowser:e.useBrowser};l(!0),await(0,M.KM)(r,i,t),o({success:!0}),n(!1),(0,U.i)(!0,"The url added successfully!","success")}}catch(d){console.error("Error adding training documents:-",d),o({success:!1}),s({submit:d.message}),l(!1),n(!1),(0,U.i)(!0,"Not able to add the url. Try after sometime!","error")}},children:e=>{let{errors:i,handleBlur:t,handleChange:n,handleSubmit:r,isSubmitting:s,touched:u,values:m}=e;return(0,W.jsxs)("form",{noValidate:!0,onSubmit:r,children:[(0,W.jsx)(a.Ay,{container:!0,spacing:1,children:(0,W.jsx)(a.Ay,{item:!0,xs:12,md:12,children:(0,W.jsxs)(o.A,{spacing:1,children:[(0,W.jsx)(l.A,{htmlFor:"webpage-url",children:"Webpage Url"}),(0,W.jsx)(d.A,{id:"webpage-url",type:"webpageUrl",defaultValue:m.webpageUrl,name:"webpageUrl",onBlur:t,onChange:n,autoComplete:"off",fullWidth:!0,placeholder:"https://www.yourwebsite.com/product-info",error:Boolean(u.webpageUrl&&i.webpageUrl)}),u.webpageUrl&&i.webpageUrl&&(0,W.jsx)(c.A,{error:!0,id:"helper-text-webpage-url",children:i.webpageUrl})]})})}),(0,W.jsx)("br",{}),(0,W.jsxs)(a.Ay,{container:!0,spacing:1,children:[(0,W.jsx)(a.Ay,{item:!0,xs:10,md:10,children:(0,W.jsxs)(o.A,{spacing:1,children:[(0,W.jsx)(l.A,{htmlFor:"use-browser",children:"More options"}),(0,W.jsx)(h.A,{value:!0,control:(0,W.jsx)(x.A,{checked:m.useBrowser,name:"useBrowser",onChange:n}),label:"My page needs script to generate content / My page has issues with training"})]})}),(0,W.jsx)(a.Ay,{item:!0,xs:2,md:2,children:(0,W.jsxs)(o.A,{spacing:1,children:[(0,W.jsx)(l.A,{children:"\xa0"}),(0,W.jsx)(S.A,{children:(0,W.jsx)(C.A,{style:{float:"right"},isLoading:s,disabled:s,color:"primary",size:"large",type:"submit",variant:"contained",id:"webpageUrlSubmit",children:"Add"})})]})})]})]})}})})}function Y(e){let{trainingMedia:i,botId:t,organizationId:n}=e;return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(a.Ay,{item:!0,xs:12,children:i&&0===i.length&&(0,W.jsx)(s.A,{variant:"caption",color:"#FF0000",children:(0,W.jsxs)(a.Ay,{container:!0,spacing:1,children:[(0,W.jsx)(a.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:(0,W.jsx)(y.A,{style:{fontSize:40}})}),(0,W.jsx)(a.Ay,{item:!0,xs:12,md:12,style:{display:"flex",justifyContent:"center"},children:"Training Documents are not uploaded!"})]})})}),i&&i.map((e,i)=>(0,W.jsx)(a.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,W.jsx)(O,{media:e,botId:t,organizationId:n})},i))]})}},46278:(e,i,t)=>{t.d(i,{A:()=>d});t(9950);var n=t(63464),r=t(40033),a=t(28170),s=t(79739),o=t(10226),l=t(44414);const d=e=>{const{title:i,children:t,open:d,setOpen:c,onConfirm:h}=e;return(0,l.jsxs)(n.A,{open:d,onClose:()=>c(!1),style:{zIndex:1e4},children:[(0,l.jsx)(r.A,{sx:{m:0,p:2},id:"confirm-dialog",children:i}),(0,l.jsx)(a.A,{dividers:!0,children:t}),(0,l.jsxs)(s.A,{children:[(0,l.jsx)(o.A,{size:"large",type:"submit",variant:"contained",color:"secondary",onClick:()=>c(!1),children:"No"}),(0,l.jsx)(o.A,{size:"large",type:"submit",variant:"contained",color:"success",onClick:()=>{c(!1),h()},children:"Yes"})]})]})}},51637:(e,i,t)=>{t.d(i,{A:()=>h});var n=t(9950),r=t(14857),a=t(48089),s=t(45180),o=t(82053),l=t(50704),d=t(44414);const c={p:2.5,"& .MuiCardHeader-action":{m:"0px auto",alignSelf:"center"}},h=(0,n.forwardRef)((e,i)=>{let{border:t=!0,boxShadow:n,children:h,content:x=!0,contentSX:u={},darkTitle:m,elevation:p,secondary:g,shadow:j,sx:A={},title:y,...b}=e;const f=(0,r.A)();return n="dark"===f.palette.mode?n||!0:n,(0,d.jsxs)(a.A,{elevation:p||0,ref:i,...b,sx:{border:t?"1px solid":"none",borderRadius:2,borderColor:"dark"===f.palette.mode?f.palette.divider:f.palette.grey.A800,boxShadow:!n||t&&"dark"!==f.palette.mode?"inherit":j||f.customShadows.z1,":hover":{boxShadow:n?j||f.customShadows.z1:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:f.typography.fontFamily,fontSize:"0.75rem"},...A},children:[!m&&y&&(0,d.jsx)(s.A,{sx:c,titleTypographyProps:{variant:"subtitle1"},title:y,action:g}),m&&y&&(0,d.jsx)(s.A,{sx:c,title:(0,d.jsx)(o.A,{variant:"h3",children:y}),action:g}),x&&(0,d.jsx)(l.A,{sx:u,children:h}),!x&&h]})})}}]);